button_card_templates:
  police:
    styles:
      card:
        - font-family: Avenir
  sidebar:
    entity: weather.ta_ville
    show_entity_picture: false
    show_icon: true
    show_name: false
    show_state: false
    show_label: false
    template:
      - police
    icon: |
      [[[
        if (states['weather.ta_ville'].state == 'sunny' )
          return 'mdi:weather-sunny';
        if (states['weather.ta_ville'].state == 'rainy' )
          return 'mdi:weather-rainy';
        if (states['weather.ta_ville'].state == 'partlycloudy' )
          return 'mdi:weather-partly-cloudy';
        if (states['weather.ta_ville'].state == 'cloudy' )
          return 'mdi:weather-cloudy';
        if (states['weather.ta_ville'].state == 'clear-night' )
          return 'mdi:weather-night';
        if (states['weather.ta_ville'].state == 'fog' )
          return 'mdi:weather-fog';
        if (states['weather.ta_ville'].state == 'hail' )
          return 'mdi:weather-hail';
        if (states['weather.ta_ville'].state == 'lightning-rainy' )
          return 'mdi:weather-lightning-rainy';
        if (states['weather.ta_ville'].state == 'lightning' )
          return 'mdi:weather-lightning';
        if (states['weather.ta_ville'].state == 'pourring' )
          return 'mdi:weather-pouring';
        if (states['weather.ta_ville'].state == 'snowy-rainy' )
          return 'mdi:weather-snowy-rainy';
        if (states['weather.ta_ville'].state == 'snowy' )
          return 'mdi:weather-snowy';
        if (states['weather.ta_ville'].state == 'windy-variant' )
          return 'mdi:weather-windy-variant';
        if (states['weather.ta_ville'].state == 'windy' )
          return 'mdi:weather-windy';
        if (states['weather.ta_ville'].state == 'exceptional' )
          return 'mdi:weather-cloudy-alert';
        return 'mdi:weather-sunny';
      ]]]
    extra_styles: |
      @-webkit-keyframes swing
        {
          15%
          {
              -webkit-transform: translateX(5px);
              transform: translateX(5px);
          }
          30%
          {
              -webkit-transform: translateX(-5px);
              transform: translateX(-5px);
          } 
          50%
          {
              -webkit-transform: translateX(3px);
              transform: translateX(3px);
          }
          65%
          {
              -webkit-transform: translateX(-3px);
              transform: translateX(-3px);
          }
        }
    styles:
      grid:
        - grid-template-areas: |
            "date"
            "conditions_meteo"
            "alerte_meteo"
            "titre_programme"
            "anniv"
            "calendrier"
            "poubelle"
            "titre_avertissement"
            "device_hs"
            "titre_activite"
            "reveil"
            "rappel"
            "mouvement"
            "porte"
            "lumiere"
            "appareil"
            "modes"
            "app_connectes"
            "activite_ras"
            "titre_maj"
            "maj"
        - grid-template-columns: 1fr
        - grid-template-rows: min-content min-content min-content 1fr
        - gap: 0%
        - overflow: hidden
      card:
        - '-webkit-tap-highlight-color': rgba(0,0,0,0)
        - padding: 2% 4% 2% 4%
        - border-color: var(--card_border)
        - border-style: outset
        - border-width: 1px
        - box-shadow: var(--card_box_shadow)
        - line-height: 110%
      img_cell:
        - top: 1%
        - left: 5%
        - position: absolute
        - width: 50px
        - height: 50px
        - border-radius: 50%
      icon:
        - width: 60%
        - animation: |
            [[[
              if (states['weather.ta_ville'].state == 'sunny' )
                return 'rotating 9s infinite'
              if (states['weather.ta_ville'].state == 'lightning' )
                return 'blink 2s ease infinite'
              if (states['weather.ta_ville'].state == 'lightning-rainy' )
                return 'blink 2s ease infinite'
              if (states['weather.ta_ville'].state == 'exceptional' )
                return 'blink 2s ease infinite'
              if (states['weather.ta_ville'].state == 'windy-variant' )
                return 'swing 5s ease infinite'
              if (states['weather.ta_ville'].state == 'windy' )
                return 'swing 5s ease infinite'
              return 'swing 10s ease infinite'
            ]]]
        - color: |
            [[[
              if (states['weather.ta_ville'].state == 'sunny' )
                return 'gold';
              if (states['weather.ta_ville'].state == 'rainy' )
                return 'skyblue';
              if (states['weather.ta_ville'].state == 'partlycloudy' )
                return 'lightgrey';
              if (states['weather.ta_ville'].state == 'cloudy' )
                return 'silver';
              if (states['weather.ta_ville'].state == 'clear-night' )
                return 'lightgrey';
              if (states['weather.ta_ville'].state == 'fog' )
                return 'silver';
              if (states['weather.ta_ville'].state == 'hail' )
                return 'skyblue';
              if (states['weather.ta_ville'].state == 'lightning-rainy' )
                return 'skyblue';
              if (states['weather.ta_ville'].state == 'lightning' )
                return 'silver';
              if (states['weather.ta_ville'].state == 'pourring' )
                return 'silver';
              if (states['weather.ta_ville'].state == 'snowy-rainy' )
                return 'silver';
              if (states['weather.ta_ville'].state == 'snowy' )
                return 'silver';
              if (states['weather.ta_ville'].state == 'windy-variant' )
                return 'silver';
              if (states['weather.ta_ville'].state == 'windy' )
                return 'silver';
              if (states['weather.ta_ville'].state == 'exceptional' )
                return 'firebrick';
              return 'silver';
            ]]]
      custom_fields:
        date:
          - color: var(--text_on)
          - padding: 02px 0px 0px 0px
          - text-transform: null
          - font-weight: bold
          - font-size: 80%
          - align-self: middle
          - line-height: null
          - white-space: normal
        conditions_meteo:
          - padding: 0px 0px 0px 0px
          - padding-left: 8px
          - font-size: 85%
          - font-weight: null
          - line-height: null
          - align-self: middle
          - color: var(--text_on_sidebar)
          - white-space: normal
        alerte_meteo:
          - padding: 0px 0px 0px 0px
          - padding-left: 8px
          - color: |
              [[[
                if (states['sensor.weather_alerte_couleur_v2'].state == 'Vigilance Jaune' )
                  return "gold" ;
                if (states['sensor.weather_alerte_couleur_v2'].state == 'Vigilance Orange' )
                  return "orange" ;
                if (states['sensor.weather_alerte_couleur_v2'].state == 'Vigilance Rouge' )
                  return "red" ;
                return "var(--text_off_sidebar)" ;
              ]]]
          - font-size: 80%
          - align-self: middle
          - white-space: normal
        titre_programme:
          - padding: 10px 0px 0px 0px
          - font-size: 83%
          - font-weight: bold
          - justifiy-self: start
          - text-align: left
          - color: var(--text_on_sidebar)
          - white-space: normal
        anniv:
          - border-left: |
              [[[
                if (states['sensor.anniversaire'].state == 'Aucun')
                  return '';
                return '2px tomato solid';
              ]]]
          - padding: 0px 0px 0px 0px
          - padding-left: 8px
          - font-size: 83%
          - justifiy-self: start
          - text-align: left
          - color: var(--text_on_info_sidebar)
          - white-space: normal
        calendrier:
          - border-left: 2px tomato solid
          - padding: 0px 0px 0px 0px
          - padding-left: 8px
          - color: |
              [[[
                if (states['sensor.calendar_famille'].state == 'Aucun évènement')
                  return 'var(--text_off_sidebar)';
                return 'var(--text_on_info_sidebar)';
              ]]]
          - font-weight: |
              [[[
                if (states['sensor.calendar_famille'].state == 'Aucun évènement')
                  return '';
                return '';
              ]]]
          - font-size: 83%
          - justifiy-self: start
          - text-align: left
          - white-space: normal
        poubelle:
          - border-left: 2px tomato solid
          - padding: 0px 0px 0px 0px
          - padding-left: 8px
          - color: |
              [[[
                if (states['sensor.calendar_poubelles'].state == 'Aucun rappel')
                  return 'var(--text_off_sidebar)';
                return 'var(--text_on_info_sidebar)';
              ]]]
          - font-weight: |
              [[[
                if (states['sensor.calendar_poubelles'].state == 'Aucun rappel')
                  return '';
                return '';
              ]]]
          - font-size: 83%
          - justifiy-self: start
          - text-align: left
          - white-space: normal
        titre_avertissement:
          - padding: |
              [[[
                if (states['sensor.systeme_sidebar'].state == 'Aucun' && states['sensor.batterie_alerte'].state == 'Aucun')
                  return "0px 0px 0px 0px" ;
                return "15px 0px 0px 0px" ;
              ]]]
          - font-size: 83%
          - font-weight: bold
          - justifiy-self: start
          - text-align: left
          - color: red
          - white-space: normal
        device_hs:
          - border-left: 2px red solid
          - padding: 0px 0px 0px 08px
          - font-size: 83%
          - justifiy-self: start
          - color: red
          - white-space: normal
          - text-align: left
        titre_activite:
          - padding: 15px 0px 0px 0px
          - font-size: 83%
          - font-weight: bold
          - justifiy-self: start
          - text-align: left
          - color: var(--text_on_sidebar)
          - white-space: normal
        appareil:
          - border-left: 2px grey solid
          - white-space: normal
          - text-align: left
          - padding: 0px 0px 0px 08px
          - font-size: 83%
          - justifiy-self: start
          - color: |
              [[[
                if (states['sensor.compteur_autre'].state == '0')
                  return 'var(--text_off_sidebar)';
                return 'var(--text_on_info_sidebar)';
              ]]]
        lumiere:
          - border-left: 2px grey solid
          - padding: 0px 0px 0px 08px
          - font-size: 83%
          - justifiy-self: start
          - color: |
              [[[
                if (states['group.lumieres'].state == 'off')
                  return 'var(--text_off_sidebar)';
                return 'var(--text_on_info_sidebar)';
              ]]]
          - white-space: normal
          - text-align: left
        mouvement:
          - border-left: 2px grey solid
          - padding: 0px 0px 0px 08px
          - font-size: 83%
          - justifiy-self: start
          - text-align: left
          - color: |
              [[[
                if (states['group.mouvements'].state == 'off')
                  return 'var(--text_off_sidebar)';
                return 'var(--text_on_info_sidebar)';
              ]]]
          - white-space: normal
        porte:
          - border-left: 2px grey solid
          - padding: 0px 0px 0px 08px
          - font-size: 83%
          - justifiy-self: start
          - text-align: left
          - color: |
              [[[
                if (states['group.portes'].state == 'off')
                  return 'var(--text_off_sidebar)';
                return 'var(--text_on_info_sidebar)';
              ]]]
          - white-space: normal
        rappel:
          - border-left: 2px grey solid
          - padding: 0px 0px 0px 08px
          - font-size: 83%
          - justifiy-self: start
          - text-align: left
          - white-space: normal
          - color: |
              [[[
                if (states['sensor.rappel'].state == 'Aucun')
                  return 'var(--text_off_sidebar)';
                return 'var(--text_on_info_sidebar)';
              ]]]
        reveil:
          - border-left: 2px grey solid
          - padding: 0px 0px 0px 08px
          - font-size: 83%
          - justifiy-self: start
          - text-align: left
          - color: |
              [[[
                if (states['input_boolean.reveils'].state == 'off')
                  return 'var(--text_off_sidebar)';
                return 'var(--text_on_info_sidebar)';
              ]]]
          - white-space: normal
        modes:
          - border-left: 2px grey solid
          - padding: 0px 0px 0px 08px
          - font-size: 83%
          - justifiy-self: start
          - text-align: left
          - color: var(--text_on_info_sidebar)
          - white-space: normal
        app_connectes:
          - border-left: 2px grey solid
          - padding: 0px 0px 0px 08px
          - font-size: 83%
          - justifiy-self: start
          - text-align: left
          - color: var(--text_on_info_sidebar)
          - white-space: normal
        activite_ras:
          - border-left: 2px grey solid
          - padding: 0px 0px 0px 08px
          - font-size: 83%
          - justifiy-self: start
          - text-align: left
          - color: var(--text_on_info_sidebar)
          - white-space: normal
        titre_maj:
          - padding: 15px 0px 0px 0px
          - font-size: 83%
          - font-weight: bold
          - justifiy-self: start
          - text-align: left
          - color: var(--text_on_sidebar)
          - white-space: normal
        maj:
          - border-left: 2px dodgerblue solid
          - padding: 0px 0px 0px 08px
          - font-size: 83%
          - justifiy-self: start
          - text-align: left
          - color: |
              [[[
                if (states['sensor.maj'].state == 'Aucune')
                  return "var(--text_off)" ;
                return "var(--text_on_info_sidebar)" ;
              ]]]
          - white-space: normal
        reglages:
          - position: absolute
          - top: 01%
          - left: 95%
          - width: calc(13% + 1px)
          - transform: translate(-50%, calc(-50% + 10px))
          - z-index: 1
          - '--paper-card-background-color': rgba(0, 0, 0, 0.0)
          - '--ha-card-background': rgba(0, 0, 0, 0.0)"
          - '--ha-card-box-shadow': none
          - opacity: 100%
    custom_fields:
      date: >
        [[[ return states['sensor.date_simple'].state + " " +
        states['sensor.date_annee'].state  ]]]
      conditions_meteo: |
        [[[ return states['sensor.weather_conditions'].state 
        + ", " + states['sensor.weather_temperature'].state
        ]]]
      alerte_meteo: |
        [[[ return  states['sensor.weather_alerte'].state ]]]
      titre_programme: |
        [[[ return "Aujourd’hui" 
        ]]]
      anniv: |
        [[[
          if (states['sensor.anniversaire'].state == 'Aucun')
            return "" ;
          return "🎁 " + states['sensor.anniversaire'].state ;
        ]]]
      calendrier: |
        [[[ return  states['sensor.calendar_famille'].state
        ]]]
      poubelle: |
        [[[ return  states['sensor.calendar_poubelles'].state
        ]]]
      titre_avertissement: |
        [[[
          if (states['sensor.systeme_sidebar'].state == 'Aucun')
            return "" ;
          return "Avertissement" ;
        ]]]
      device_hs: |
        [[[
          if (states['sensor.systeme_sidebar'].state == 'Aucun' && states['sensor.batterie_alerte'].state == 'Aucun')
            return "" ;
          return states['sensor.systeme_sidebar'].state ;
        ]]]
      titre_activite: |
        [[[ return "Activité" 
        ]]]
      appareil: |
        [[[
          if (states['sensor.compteur_autre'].state == 0 || states['input_boolean.sidecar_show_autre'].state == 'off')
            return ""
          return `<ha-icon
            icon="mdi:home"
            style="width: 18px; color: var(--text_on_sidebar); height: 18px; margin-right: 2px;">
            </ha-icon><span> ${states['sensor.autres_appareils'].state}</span>`
        ]]]
      lumiere: |
        [[[
          if (states['sensor.lumiere_etat'].state == 'Aucune' || states['input_boolean.sidecar_show_lumiere'].state == 'off')
            return ""
          return `<ha-icon
            icon="phu:bulb-group-filament-candle"
            style="width: 18px; color: var(--text_on_sidebar); height: 18px; margin-right: 2px;">
            </ha-icon><span> ${states['sensor.lumiere_etat'].state}</span>`
        ]]]
      mouvement: |
        [[[
          if (states['sensor.mouv_on'].state == 'Aucun' || states['input_boolean.sidecar_show_mouvement'].state == 'off')
            return ""
          return `<ha-icon
            icon="mdi:run"
            style="width: 18px; color: var(--text_on_sidebar); height: 18px; margin-right: 2px;">
            </ha-icon><span> ${states['sensor.mouv_on'].state}</span>`
        ]]]
      porte: |
        [[[
          if (states['sensor.porte_on'].state == 'Aucune'|| states['input_boolean.sidecar_show_porte'].state == 'off')
            return ""
          return `<ha-icon
            icon="mdi:door-open"
            style="width: 18px; color: var(--text_on_sidebar); height: 18px; margin-right: 2px;">
            </ha-icon><span> ${states['sensor.porte_on'].state}</span>`
        ]]]
      rappel: |
        [[[
          if (states['sensor.rappel'].state == "Aucun")
            return ""
          return `<ha-icon
            icon="mdi:reminder"
            style="width: 18px; color: var(--text_on_sidebar); height: 18px; margin-right: 2px;">
            </ha-icon><span> ${states['sensor.rappel'].state}</span>`
        ]]]
      reveil: |
        [[[
          if (states['input_boolean.nilemato'].state == 'on')
            return `<ha-icon
              icon="mdi:clock-check-outline"
              style="width: 18px; height: 18px; color: var(--text_off); margin-right: 2px;">
              </ha-icon><span> ${states['sensor.reveil'].state}</span>`
          return ""
        ]]]
      modes: |
        [[[
          if (states['sensor.modes'].state == 'Aucun'|| states['input_boolean.sidecar_show_mode'].state == 'off')
            return ""
          return `<ha-icon
            icon="mdi:checkbox-multiple-marked-outline"
            style="width: 18px; color: var(--text_on_sidebar); height: 18px; margin-right: 2px;">
            </ha-icon><span> ${states['sensor.modes'].state}</span>`
        ]]]
      app_connectes: |
        [[[
          if (states['sensor.app_connectes'].state == 'Aucun' || states['input_boolean.sidecar_show_connecte'].state == 'off')
            return ""
          return `<ha-icon
            icon="mdi:desktop-mac"
            style="width: 18px; color: var(--text_on_sidebar); height: 18px; margin-right: 2px;">
            </ha-icon><span> ${states['sensor.app_connectes'].state}</span>`
        ]]]
      activite_ras: |
        [[[ return states['sensor.sidebar_activite_ras'].state ;
        ]]]
      titre_maj: |
        [[[ return "Mise à jour" 
        ]]]
      maj: |
        [[[ return states['sensor.maj'].state ;
        ]]]
      reglages:
        card:
          type: custom:button-card
          entity: input_boolean.sidecar_show_lumiere
          icon: mdi:cog
          show_name: false
          styles:
            icon:
              - color: var(--icon_off)
          tap_action:
            action: fire-dom-event
            browser_mod:
              command: popup
              title: Réglages
              card:
                type: vertical-stack
                cards:
                  - type: custom:button-card
                    template:
                      - popup_titre
                    label: |
                      [[[ return "Thèmes" ]]]
                  - square: false
                    columns: 3
                    type: grid
                    cards:
                      - type: custom:button-card
                        entity: script.theme_jour
                        name: Bat Day
                        show_state: false
                        template:
                          - base
                          - base_capteur
                          - state_appareil
                        tap_action:
                          action: toggle
                      - type: custom:button-card
                        entity: script.theme_nuit
                        name: Bat Night
                        show_state: false
                        template:
                          - base
                          - base_capteur
                          - state_appareil
                        tap_action:
                          action: toggle
                      - type: custom:button-card
                        entity: script.theme_reload
                        name: Refresh
                        show_state: false
                        template:
                          - base
                          - base_capteur
                          - state_appareil
                        tap_action:
                          action: toggle
                  - type: custom:button-card
                    template:
                      - popup_titre
                    label: |
                      [[[ return "Afficher / masquer dans activité :" ]]]
                  - square: false
                    columns: 3
                    type: grid
                    cards:
                      - type: custom:button-card
                        entity: input_boolean.sidecar_show_mode
                        name: Modes
                        template:
                          - base
                          - base_capteur
                          - state_appareil
                        tap_action:
                          action: toggle
                      - type: custom:button-card
                        entity: input_boolean.sidecar_show_porte
                        name: Portes
                        template:
                          - base
                          - base_capteur
                          - state_appareil
                        tap_action:
                          action: toggle
                      - type: custom:button-card
                        entity: input_boolean.sidecar_show_mouvement
                        name: Mouvements
                        template:
                          - base
                          - base_capteur
                          - state_appareil
                        tap_action:
                          action: toggle
                      - type: custom:button-card
                        entity: input_boolean.sidecar_show_lumiere
                        name: Lumières
                        template:
                          - base
                          - base_capteur
                          - state_appareil
                        tap_action:
                          action: toggle
                      - type: custom:button-card
                        entity: input_boolean.sidecar_show_autre
                        name: Appareils
                        template:
                          - base
                          - base_capteur
                          - state_appareil
                        tap_action:
                          action: toggle
                      - type: custom:button-card
                        entity: input_boolean.sidecar_show_connecte
                        name: Connectés
                        template:
                          - base
                          - base_capteur
                          - state_appareil
                        tap_action:
                          action: toggle
  base:
    show_icon: true
    show_name: true
    show_state: false
    show_label: true
    template:
      - police
    styles:
      grid:
        - grid-template-areas: '"i n" "i s" "i l" "i info1"'
        - grid-template-columns: 1fr 70%
        - grid-template-rows: min-content min-content min-content 1fr
      img_cell:
        - background-color: var(--pastille_off)
        - border-radius: 50%
        - place-self: start
        - text-align: start
        - width: 37px
        - height: 37px
      icon:
        - width: 70%
        - color: var(--icon_off)
      name:
        - color: var(--text_off)
        - font-size: 100%
        - font-weight: null
        - text-align: left
        - place-self: start
        - white-space: normal
      state:
        - color: var(--text_on)
        - font-size: 85%
        - font-weight: null
        - text-align: left
        - place-self: start
        - white-space: normal
      label:
        - color: var(--text_on)
        - font-size: 85%
        - font-weight: null
        - text-align: left
        - place-self: start
        - white-space: normal
      card:
        - padding: 8px 5px 5px 5px
        - font-size: 100%
        - border-color: var(--card_border)
        - border-style: outset
        - border-width: 1px
        - box-shadow: var(--card_box_shadow)
        - animation: ball-scale 0.2s
        - white-space: normal
    tap_action:
      action: more-info
    double_tap_action:
      action: toggle
  bouton_piece:
    show_icon: true
    show_name: true
    show_state: false
    show_label: true
    template:
      - police
    styles:
      card:
        - height: 90px
      custom_fields:
        notification:
          - border-radius: 50%
          - position: absolute
          - left: 18%
          - top: 3%
          - height: 20%
          - width: 10%
          - font-size: 85%
          - line-height: 167%
          - font-weight: null
        lum:
          - position: absolute
          - top: 70%
          - left: 50%
          - width: calc(65% + 1px)
          - transform: translate(-50%, calc(-50% + 10px))
          - z-index: 1
          - '--paper-card-background-color': rgba(0, 0, 0, 0.0)
          - '--ha-card-background': rgba(0, 0, 0, 0.0)"
          - '--ha-card-box-shadow': none
        mouv:
          - position: absolute
          - top: 72%
          - left: 91%
          - width: calc(20% + 1px)
          - transform: translate(-50%, calc(-50% + 10px))
          - z-index: 1
          - '--paper-card-background-color': rgba(0, 0, 0, 0.0)
          - '--ha-card-background': rgba(0, 0, 0, 0.0)"
          - '--ha-card-box-shadow': none
        porte:
          - position: absolute
          - top: 72%
          - left: 10%
          - width: calc(20% + 1px)
          - transform: translate(-50%, calc(-50% + 10px))
          - z-index: 1
          - '--paper-card-background-color': rgba(0, 0, 0, 0.0)
          - '--ha-card-background': rgba(0, 0, 0, 0.0)"
          - '--ha-card-box-shadow': none
        graph:
          - opacity: 60%
          - position: absolute
          - top: 95%
          - left: 50%
          - width: calc(120% + 0px)
          - transform: translate(-50%, calc(-50% + 10px))
          - z-index: 12
          - '--paper-card-background-color': rgba(0, 0, 0, 0)
          - '--ha-card-background': rgba(0, 0, 0, 0)"
          - '--ha-card-box-shadow': none
          - pointer-events: none
        graph_fixe:
          - opacity: 60%
          - position: absolute
          - top: 95%
          - left: 50%
          - width: calc(120% + 0px)
          - transform: translate(-50%, calc(-50% + 10px))
          - z-index: 12
          - '--paper-card-background-color': rgba(0, 0, 0, 0)
          - '--ha-card-background': rgba(0, 0, 0, 0)"
          - '--ha-card-box-shadow': none
          - pointer-events: none
    tap_action:
      action: more-info
    double_tap_action:
      action: toggle
  bouton_piece_graph:
    custom_fields:
      graph:
        card:
          type: conditional
          card:
            type: custom:mini-graph-card
            height: 200
            line_width: 8
            lower_bound: 18
            points_per_hour: 1
            hours_to_show: 24
            show:
              fill: false
              icon: false
              name: false
              state: false
              legend: false
              points: false
              labels: false
  bouton_piece_graph_fixe:
    custom_fields:
      graph_fixe:
        card:
          type: custom:mini-graph-card
          height: 200
          line_width: 8
          lower_bound: 18
          points_per_hour: 1
          hours_to_show: 24
          show:
            fill: false
            icon: false
            name: false
            state: false
            legend: false
            points: false
            labels: false
  bouton_piece_capteur:
    show_name: false
    styles:
      icon:
        - width: 55%
      card:
        - border-radius: 15%
        - background: transparent
        - border-color: transparent
    state:
      - value: 'on'
        styles:
          icon:
            - color: var(--mouv)
      - value: 'off'
        styles:
          icon:
            - color: transparent
    tap_action:
      action: more-info
  bouton_lumiere:
    show_last_changed: true
    styles:
      card:
        - height: 65px
      img_cell:
        - width: 30px
        - height: 30px
      icon:
        - width: 70%
      name:
        - font-size: 90%
      label:
        - font-size: 65%
        - color: |
            [[[
              if (entity.state == 'off')
                return 'var(--text_off)';
              if (entity.state == 'on')
                return 'var(--text_on)';
            ]]]
      custom_fields:
        lum:
          - position: absolute
          - top: 65%
          - left: 50%
          - width: calc(90% + 1px)
          - transform: translate(-50%, calc(-50% + 10px))
          - z-index: 1
          - '--paper-card-background-color': rgba(0, 0, 0, 0.0)
          - '--ha-card-background': rgba(0, 0, 0, 0.0)"
          - '--ha-card-box-shadow': none
    tap_action:
      action: more-info
    double_tap_action:
      action: toggle
  base_capteur:
    show_state: true
    show_label: false
    show_last_changed: false
    template:
      - police
    styles:
      grid:
        - grid-template-columns: 1fr 70%
      img_cell:
        - width: 30px
        - height: 30px
      name:
        - padding-left: 5%
        - font-size: 85%
      state:
        - padding-left: 5%
        - font-size: 85%
        - font-weight: null
        - color: var(--text_on)
      label:
        - padding-left: 5%
        - font-size: 65%
        - color: var(--text_off)
    tap_action:
      action: more-info
    double_tap_action:
      action: toggle
  state_lumiere:
    state:
      - value: 'on'
        styles:
          card:
            - animation: ball-scale 0.2s
            - background-color: var(--button-card-light-color)
          img_cell:
            - background-color: var(--button-card-light-color)
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          name:
            - color: var(--text_on)
          label:
            - font-weight: bold
      - value: 'off'
        color: grey
        styles:
          card:
            - animation: ball-scale2 0.2s
          img_cell:
            - background-color: var(--pastille_off)
          icon:
            - color: var(--icon_off)
            - transition: 1s ease
          name:
            - color: var(--text_off)
  state_porte:
    state:
      - value: 'on'
        styles:
          card:
            - animation: ball-scale 0.2s
            - background-color: var(--porte)
          img_cell:
            - background-color: var(--porte)
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          state:
            - font-weight: bold
      - value: 'off'
        color: grey
        styles:
          card:
            - animation: ball-scale2 0.2s
          img_cell:
            - background-color: var(--pastille_off)
          icon:
            - color: var(--icon_off)
            - transition: 1s ease
  state_mouv:
    state:
      - value: 'on'
        styles:
          card:
            - animation: ball-scale 0.2s
            - background-color: var(--mouv)
          img_cell:
            - background-color: var(--mouv)
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          state:
            - font-weight: bold
      - value: 'off'
        color: grey
        styles:
          card:
            - animation: ball-scale2 0.2s
          img_cell:
            - background-color: var(--pastille_off)
          icon:
            - color: var(--icon_off)
            - transition: 1s ease
  state_person:
    state:
      - value: home
        operator: '!='
        styles:
          label:
            - color: rgba(255,0,0,1)
  state_alarme:
    state:
      - value: disarmed
        color: grey
        styles:
          img_cell:
            - background-color: var(--pastille_off)
          label:
            - color: var(--text_off)
          name:
            - color: var(--text_off)
          icon:
            - color: var(--icon_off)
            - transition: 1s ease
      - value: 'off'
        color: grey
        styles:
          img_cell:
            - background-color: var(--pastille_off)
          label:
            - color: var(--text_off)
          name:
            - color: var(--text_off)
          icon:
            - color: var(--icon_off)
            - transition: 1s ease
      - value: armed_away
        color: red
        styles:
          card:
            - background-color: var(--back_securite)
          img_cell:
            - background-color: var(--back_securite)
          name:
            - color: var(--text_on)
            - font-weight: null
          label:
            - color: var(--text_on)
            - font-weight: null
          state:
            - color: var(--text_on)
            - font-weight: bold
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
      - value: 'on'
        color: red
        styles:
          card:
            - background-color: var(--back_securite)
          img_cell:
            - background-color: var(--back_securite)
          name:
            - color: var(--text_on)
            - font-weight: null
          label:
            - color: var(--text_on)
            - font-weight: null
          state:
            - color: var(--text_on)
            - font-weight: bold
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
      - value: arming
        color: gold
        styles:
          img_cell:
            - background-color: var(--back_securite)
          icon:
            - animation: blink 1s ease infinite
            - color: var(--icon_on)
            - transition: 1s ease
          name:
            - color: var(--text_on)
            - font-weight: null
          label:
            - color: var(--text_on)
            - font-weight: null
          state:
            - color: var(--text_on)
            - font-weight: bold
      - value: triggered
        color: red
        styles:
          img_cell:
            - background-color: var(--back_securite)
          name:
            - color: var(--text_on)
            - font-weight: null
          label:
            - color: var(--text_on)
            - font-weight: null
          state:
            - color: var(--text_on)
            - font-weight: bold
          icon:
            - animation: blink 1s ease infinite
            - color: var(--icon_on)
            - transition: 1s ease
  state_temp:
    state:
      - value: 25
        operator: '>'
        styles:
          card: null
          img_cell:
            - background-color: tomato
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          state:
            - font-weight: bold
      - value: 19
        operator: <
        styles:
          card: null
          img_cell:
            - background-color: dodgerblue
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          state:
            - font-weight: bold
  state_temp_exterieur:
    state:
      - value: 25
        operator: '>'
        styles:
          card: null
          img_cell:
            - background-color: tomato
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          state:
            - font-weight: bold
      - value: 10
        operator: <
        styles:
          card: null
          img_cell:
            - background-color: dodgerblue
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          state:
            - font-weight: bold
  state_humidite:
    state:
      - value: 70
        operator: '>'
        styles:
          card: null
          img_cell:
            - background-color: dodgerblue
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          state:
            - font-weight: bold
      - value: 40
        operator: <
        styles:
          card: null
          img_cell:
            - background-color: tomato
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          state:
            - font-weight: bold
  state_luminosite:
    state:
      - value: 500
        operator: '>'
        styles:
          img_cell:
            - background-color: tomato
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
      - value: 50
        operator: <
        styles:
          card: null
          img_cell:
            - background-color: royalblue
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
  state_imprimante:
    state:
      - value: 0
        operator: '>='
        styles:
          card:
            - animation: ball-scale 0.2s
            - background-color: var(--pastille_imprim)
          img_cell:
            - background-color: var(--pastille_imprim)
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          name:
            - color: var(--text_on)
          label:
            - color: var(--text_on)
            - font-weight: bold
      - value: 'on'
        styles:
          card:
            - animation: ball-scale 0.2s
            - background-color: var(--pastille_imprim)
          img_cell:
            - background-color: var(--pastille_imprim)
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          name:
            - color: var(--text_on)
          label:
            - color: var(--text_on)
            - font-weight: bold
      - value: unavailable
        color: var(--text_off)
        styles:
          card:
            - animation: ball-scale 0.2s
          img_cell:
            - background-color: var(--pastille_off)
          icon:
            - color: var(--icon_off)
            - transition: 1s ease
          name:
            - color: var(--text_off)
          label:
            - color: var(--text_off)
      - value: 'off'
        color: var(--text_off)
        styles:
          card:
            - animation: ball-scale 0.2s
          img_cell:
            - background-color: var(--pastille_off)
          icon:
            - color: var(--icon_off)
            - transition: 1s ease
          name:
            - color: var(--text_off)
          label:
            - color: var(--text_off)
  state_appareil:
    state:
      - value: 'on'
        styles:
          card:
            - background-color: var(--pastille_appareil)
          img_cell:
            - background-color: var(--pastille_appareil)
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          name:
            - color: var(--text_on)
          state:
            - font-weight: bold
      - value: 'off'
        color: var(--text_off)
        styles:
          img_cell:
            - background-color: var(--pastille_off)
          icon:
            - color: var(--icon_off)
            - transition: 1s ease
          name:
            - color: var(--text_off)
  state_musique:
    state:
      - value: 'on'
        styles:
          card:
            - background-color: dimgrey
          img_cell:
            - background-color: dimgrey
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          name:
            - color: var(--text_on)
      - value: playing
        styles:
          card:
            - background-color: dimgrey
          img_cell:
            - background-color: dimgrey
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          name:
            - color: var(--text_on)
          state:
            - font-weight: bold
          label:
            - font-weight: bold
      - value: 'off'
        color: var(--text_off)
        styles:
          img_cell:
            - background-color: var(--pastille_off)
          icon:
            - color: var(--icon_off)
            - transition: 1s ease
          name:
            - color: var(--text_off)
  state_machine:
    state:
      - value: 'on'
        styles:
          card:
            - animation: ball-scale 0.2s
            - background-color: var(--pastille_machine)
          img_cell:
            - background-color: var(--pastille_machine)
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          name:
            - color: var(--text_on)
          label:
            - color: var(--text_on)
            - font-weight: bold
          state:
            - font-weight: bold
      - value: 'off'
        color: var(--text_off)
        styles:
          card:
            - animation: ball-scale 0.2s
          img_cell:
            - background-color: var(--pastille_off)
          icon:
            - color: var(--icon_off)
            - transition: 1s ease
          name:
            - color: var(--text_off)
          label:
            - color: var(--text_off)
  state_aspi:
    state:
      - value: 'on'
        styles:
          icon:
            - animation: rotating 4s ease infinite
            - color: var(--icon_on)
            - transition: 1s ease
          card:
            - animation: ball-scale 0.2s
            - background-color: var(--pastille_aspi)
          img_cell:
            - background-color: var(--pastille_aspi)
          name:
            - color: var(--text_on)
          label:
            - color: var(--text_on)
            - font-weight: bold
          state:
            - color: var(--text_on)
            - font-weight: bold
      - value: cleaning
        styles:
          icon:
            - animation: rotating 4s ease infinite
            - color: var(--icon_on)
            - transition: 1s ease
          card:
            - animation: ball-scale 0.2s
            - background-color: var(--pastille_aspi)
          img_cell:
            - background-color: var(--pastille_aspi)
          name:
            - color: var(--text_on)
          label:
            - color: var(--text_on)
            - font-weight: bold
          state:
            - color: var(--text_on)
            - font-weight: bold
      - value: returning
        styles:
          icon:
            - animation: rotating 4s ease infinite
            - color: var(--icon_on)
            - transition: 1s ease
          card:
            - animation: ball-scale 0.2s
            - background-color: var(--pastille_aspi)
          img_cell:
            - background-color: var(--pastille_aspi)
          name:
            - color: var(--text_on)
          label:
            - color: var(--text_on)
            - font-weight: bold
          state:
            - color: var(--text_on)
            - font-weight: bold
      - value: idle
        styles:
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          card:
            - animation: ball-scale 0.2s
            - background-color: var(--pastille_aspi)
          img_cell:
            - background-color: var(--pastille_aspi)
          name:
            - color: var(--text_on)
          label:
            - color: var(--text_on)
            - font-weight: bold
          state:
            - color: var(--text_on)
            - font-weight: bold
      - value: paused
        styles:
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          card:
            - animation: ball-scale 0.2s
            - background-color: var(--pastille_aspi)
          img_cell:
            - background-color: var(--pastille_aspi)
          name:
            - color: var(--text_on)
          label:
            - color: var(--text_on)
            - font-weight: bold
          state:
            - color: var(--text_on)
            - font-weight: bold
      - value: docked
        color: grey
        styles:
          card:
            - animation: ball-scale 0.2s
          img_cell:
            - background-color: var(--pastille_off)
          icon:
            - color: var(--icon_off)
            - transition: 1s ease
          name:
            - color: var(--text_off)
          label:
            - color: var(--text_on)
          state:
            - color: var(--text_on)
      - value: 'off'
        color: grey
        styles:
          card:
            - animation: ball-scale 0.2s
          img_cell:
            - background-color: var(--pastille_off)
          icon:
            - color: var(--icon_off)
            - transition: 1s ease
          name:
            - color: var(--text_off)
          label:
            - color: var(--text_on)
          state:
            - color: var(--text_on)
      - value: error
        styles:
          icon:
            - animation: blink 1s ease infinite
            - color: firebrick
            - transition: 1s ease
          card:
            - animation: ball-scale 0.2s
          img_cell:
            - background-color: var(--pastille_off)
          name:
            - color: firebrick
          label:
            - color: firebrick
            - font-weight: bold
    tap_action:
      action: more-info
    double_tap_action:
      action: navigate
      navigation_path: /lovelace/1
  state_tv:
    state:
      - value: 'on'
        styles:
          card:
            - animation: ball-scale 0.2s
            - background-color: var(--pastille_multimedia)
          img_cell:
            - background-color: var(--pastille_multimedia)
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          name:
            - color: var(--text_on)
          label:
            - font-weight: bold
      - value: home
        styles:
          card:
            - animation: ball-scale 0.2s
            - background-color: var(--pastille_multimedia)
          img_cell:
            - background-color: var(--pastille_multimedia)
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          name:
            - color: var(--text_on)
          label:
            - font-weight: bold
      - value: 'off'
        color: var(--text_off)
        styles:
          card:
            - animation: ball-scale 0.2s
          img_cell:
            - background-color: var(--pastille_off)
          icon:
            - color: var(--icon_off)
            - transition: 1s ease
          name:
            - color: var(--text_off)
  state_batterie:
    show_state: true
    show_last_changed: true
    units: '%'
    state:
      - value: 50
        operator: '>'
        styles:
          card:
            - animation: ball-scale 0.2s
            - background-color: null
          img_cell:
            - background-color: var(--pastille_appareil)
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          name:
            - color: var(--text_on)
          state:
            - color: var(--text_on)
            - font-weight: bold
          label:
            - color: var(--text_on)
            - font-size: 65%
      - value: 20
        operator: '>'
        styles:
          card:
            - animation: ball-scale 0.2s
            - background-color: null
          img_cell:
            - background-color: tomato
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
          name:
            - color: var(--text_on)
          state:
            - color: var(--text_on)
            - font-weight: bold
          label:
            - color: var(--text_on)
            - font-size: 65%
      - value: 0
        operator: '>'
        styles:
          card:
            - animation: ball-scale 0.2s
            - background-color: null
          img_cell:
            - background-color: firebrick
          icon:
            - color: var(--icon_on)
            - transition: 1s ease
            - animation: blink 1s ease infinite
          name:
            - color: var(--text_on)
          state:
            - color: var(--text_on)
            - font-weight: bold
          label:
            - color: var(--text_on)
            - font-size: 65%
      - value: unavailable
        styles:
          card:
            - border-color: rgba(255, 0, 0, 0.5)
            - opacity: 100%
          img_cell:
            - background-color: black
          icon:
            - color: red
            - transition: 1s ease
          name:
            - color: red
          label:
            - color: red
            - font-size: 65%
          state:
            - color: red
            - font-weight: bold
  state_annonces:
    icon: |
      [[[
      if (states['script.cest_lheure_daller_a_lecole'].state == "on" )
        return "mdi-bus-school";
      if (states['script.1590760144160'].state == "on" )
        return "phu:rooms-mancave";
                if (states['script.gouter'].state == "on" )
                  return "mdi:food-croissant";
                if (states['script.a_table'].state == "on" )
                  return "mdi:silverware-variant";
                if (states['script.annonce_au_lit'].state == "on" )
                  return "mdi:sleep";
                if (states['script.tom_va_se_coucher'].state == "on" )
                  return "mdi:sleep";
                return "mdi:bullhorn";
      ]]]
    label: |
      [[[
                if (states['script.cest_lheure_daller_a_lecole'].state == "on" )
                  return " Enfants";
                if (states['script.1590760144160'].state == "on" )
                  return " Fin des écrans";
                if (states['script.gouter'].state == "on" )
                  return " Goûter ";
                if (states['script.a_table'].state == "on" )
                  return " A table !";
                if (states['script.annonce_au_lit'].state == "on" )
                  return " Filles au lit";
                if (states['script.tom_va_se_coucher'].state == "on" )
                  return " Tom au lit";
                return "Aucune";
      ]]]
    state:
      - value: 'on'
        styles:
          icon:
            - color: var(--icon_on)
          img_cell:
            - background: var(--pastille_appareil)
          card:
            - background-color: var(--pastille_appareil)
          state:
            - font-weight: bold
      - value: 'off'
        styles:
          icon:
            - color: var(--icon_off)
            - opacity: 100%
          card:
            - opacity: 100%
  state_modes:
    icon: |
      [[[
        if (states['input_boolean.nilemato'].state == "on" && states['sensor.compteur_modes'].state == 1)
          return "mdi:human-female-boy";
        if (states['automation.annonce_ecole'].state == "on" && states['sensor.compteur_modes'].state == 2)
          return "mdi:bus-school";
        if (states['input_boolean.belle_saison'].state == "on" && states['sensor.compteur_modes'].state == 1)
          return "mdi:sunglasses";
        if (states['input_boolean.piscine'].state == "on" && states['sensor.compteur_modes'].state == 1)
          return "mdi:swim";
        if (states['input_boolean.vacances'].state == "on" && states['sensor.compteur_modes'].state == 1)
          return "mdi:airplane";
        if (states['input_boolean.noel'].state == "on" && states['sensor.compteur_modes'].state == 1)
          return "phu:christmas-tree-v2";
        if (states['input_boolean.halloween'].state == "on" && states['sensor.compteur_modes'].state == 1)
          return "mdi:halloween";
        if (states['sensor.compteur_modes'].state == 0)
          return "mdi:checkbox-multiple-marked-outline";
        return "mdi:checkbox-multiple-marked-outline" ;
      ]]]
    state:
      - value: 'on'
        styles:
          icon:
            - color: var(--icon_on)
          img_cell:
            - background: var(--pastille_appareil)
          card:
            - background-color: var(--pastille_appareil)
          state:
            - font-weight: bold
  state_ambiances:
    icon: |
      [[[
        if (states['sensor.ambiances_sejour'].state == "TV" )
          return "mdi:television-play";
        if (states['sensor.ambiances_sejour'].state == "Normale + TV" )
          return "mdi:television-play";
        if (states['sensor.ambiances_sejour'].state == "Normale" )
          return "mdi:ceiling-light-multiple";
        if (states['sensor.ambiances_sejour'].state == "Doux" )
          return "mdi:sofa";
        if (states['sensor.ambiances_sejour'].state == "Repas TV" )
          return "mdi:hamburger";
        if (states['sensor.ambiances_sejour'].state == "Repas invités" )
          return "phu:rooms-dining";
        if (states['sensor.ambiances_sejour'].state == "Lecture" )
          return "mdi:book-open-variant";
        if (states['sensor.ambiances_sejour'].state == "Apéro" )
          return "mdi:glass-cocktail";
        if (states['sensor.ambiances_sejour'].state == "Noël" )
          return "phu:christmas-tree";
        if (states['sensor.ambiances_sejour'].state == "Disco" )
          return "mdi:music";
        if (states['sensor.ambiances_sejour'].state == "Travail" )
          return "mdi:pen";
        if (states['sensor.ambiances_sejour'].state == "Anniversaire" )
          return "mdi:party-popper";
        return "mdi:ceiling-light" ;
      ]]]
    state:
      - value: 'on'
        styles:
          icon:
            - color: var(--icon_on)
          img_cell:
            - background: var(--pastille_appareil)
          state:
            - font-weight: bold
    double_tap_action:
      action: more-info
  state_unavailable:
    state:
      - value: unavailable
        styles:
          card:
            - border-color: rgba(255, 0, 0, 0.5)
            - opacity: 100%
          img_cell:
            - background-color: black
          icon:
            - color: red
            - animation: blink 0.8s ease infinite
            - transition: 1s ease
          name:
            - color: red
          label:
            - color: red
          state:
            - color: red
  bouton_appareil:
    template:
      - police
    styles:
      card:
        - height: 90px
      custom_fields:
        batterie:
          - top: 12%
          - left: 80%
          - font-size: 100%
          - position: absolute
          - letter-spacing: 0.03vw
        circle_lav:
          - top: 4%
          - left: 70%
          - width: 24%
          - position: absolute
          - letter-spacing: 0.03vw
          - stroke: |
              [[[
                if (states['sensor.lave_vaisselle_program_progress'].state < 49)
                  return 'lightgrey';
                if (states['sensor.lave_vaisselle_program_progress'].state > 49)
                  return 'lightgrey';
                return '';
              ]]]
        bouton_aspi:
          - position: absolute
          - top: 65%
          - left: 50%
          - width: calc(90% + 1px)
          - transform: translate(-50%, calc(-50% + 10px))
        batterie_aspi:
          - opacity: 90%
          - position: absolute
          - top: 75%
          - left: 0%
          - width: calc(110% + 10px)
          - transform: translate(-50%, calc(-50% + 10px))
          - z-index: 1
        batterie_vaisselle:
          - opacity: 90%
          - position: absolute
          - top: 70%
          - left: 0%
          - width: calc(100% + 0px)
          - transform: translate(-50%, calc(-50% + 10px))
          - z-index: 1
        barre_imprimante_noire:
          - opacity: 90%
          - position: absolute
          - top: 80%
          - left: 30%
          - width: calc(100% + 0px)
          - transform: translate(-50%, calc(-50% + 10px))
          - z-index: 1
        barre_imprimante_couleur:
          - opacity: 90%
          - position: absolute
          - top: 80%
          - left: 60%
          - width: calc(100% + 0px)
          - transform: translate(-50%, calc(-50% + 10px))
          - z-index: 1
  bouton_aspi_commande:
    show_name: false
    styles:
      card:
        - border-radius: 5px
      icon:
        - color: var(--icon_off)
        - width: 70%
    tap_action:
      action: toggle
  bouton_tv:
    tap_action:
      action: more-info
    double_tap_action:
      action: toggle
    styles:
      card:
        - height: 118px
      label:
        - line-height: 90%
      custom_fields:
        barre_volume:
          - position: absolute
          - opacity: 100%
          - top: 50%
          - left: 0%
          - width: calc(100% + 0px)
          - transform: translate(-50%, calc(-50% + 10px))
        volume:
          - position: absolute
          - opacity: 100%
          - top: 75%
          - left: 50%
          - width: calc(90% + 1px)
          - transform: translate(-50%, calc(-50% + 10px))
  bouton_tv_volume:
    show_name: false
    styles:
      card:
        - border-radius: 30%
        - background: rgba(0,0,0,0.2)
      icon:
        - color: var(--icon_off)
        - width: 90%
    tap_action:
      action: toggle
  base_verticale:
    show_icon: true
    show_name: true
    show_state: false
    show_label: true
    template:
      - police
    styles:
      grid:
        - grid-template-areas: i n s l
        - grid-template-columns: 1fr
        - grid-template-rows: min-content min-content min-content 1fr
      img_cell:
        - background-color: rgba(70,70,70,0.5)
        - border-radius: 50%
        - place-self: start
        - text-align: start
        - width: 37px
        - height: 37px
      icon:
        - width: 70%
      name:
        - padding-top: 5px
        - color: var(--text_off)
        - font-size: 100%
        - font-weight: null
        - text-align: left
        - place-self: start
        - white-space: normal
      state:
        - color: var(--text_off)
        - font-size: 90%
        - font-weight: null
        - text-align: left
        - place-self: start
        - white-space: normal
      label:
        - color: var(--text_off)
        - font-size: 90%
        - font-weight: null
        - text-align: left
        - place-self: start
        - white-space: normal
      card:
        - padding: 10px 5px 5px 5px
        - font-size: 100%
        - border-color: var(--card_border)
        - border-style: outset
        - border-width: 1px
        - box-shadow: var(--card_box_shadow)
  carte_securite:
    show_label: false
    show_state: true
    styles:
      name:
        - font-size: 90%
      state:
        - font-size: 90%
        - line-height: 90%
  bouton_multimedia:
    aspect_ratio: 1/1
    double_tap_action:
      action: toggle
    styles:
      custom_fields:
        notification:
          - border-radius: 50%
          - position: absolute
          - left: 21%
          - top: 5%
          - height: 10%
          - width: 10%
          - font-size: 85%
          - line-height: 137%
          - font-weight: null
        cartes:
          - position: absolute
          - top: 44%
          - left: 50%
          - width: calc(99.9% + 0px)
          - transform: translate(-50%, calc(-50% + 10px))
  petite_carte_media:
    template:
      - police
    show_icon: true
    show_name: true
    show_state: true
    show_label: true
    show_last_changed: false
    show_entity_picture: true
    icon: mdi:speaker
    label: |
      [[[
        if (entity.state == "playing")
          return entity.attributes.media_title 
      ]]]
    styles:
      grid:
        - grid-template-areas: '"i n" "i s" "i l"'
        - grid-template-columns: 1fr 70%
        - grid-template-rows: min-content min-content min-content 1fr
      entity_picture:
        - width: 100%
        - padding-left: 10%
      img_cell:
        - background-color: var(--pastille_off)
        - border-radius: 50%
        - place-self: start
        - text-align: start
        - width: 45px
        - height: 45px
      icon:
        - width: 70%
        - color: var(--icon_off)
      name:
        - color: var(--text_off)
        - font-size: 100%
        - padding-left: 6%
        - font-weight: bold
        - text-align: left
        - place-self: start
        - white-space: normal
      state:
        - color: var(--text_on)
        - font-size: 70%
        - padding-left: 6%
        - font-weight: null
        - text-align: left
        - place-self: start
        - white-space: normal
      label:
        - color: var(--text_on)
        - font-size: 80%
        - padding-left: 6%
        - font-weight: null
        - text-align: left
        - place-self: start
        - white-space: normal
      card:
        - padding: 5%
        - font-size: 100%
        - border-color: var(--card_border)
        - border-style: outset
        - border-width: 1px
        - box-shadow: var(--card_box_shadow)
        - animation: ball-scale 0.2s
        - white-space: normal
    tap_action:
      action: more-info
  popup_titre:
    style:
      .: |
        ha-card {
            --ha-card-background: none !important;
            box-shadow: none !important;
    show_icon: false
    show_name: false
    show_state: false
    show_label: true
    template:
      - police
    styles:
      label:
        - padding-left: 8px
        - justify-self: start
        - font-size: 14px
        - font-weight: bold
        - font-style: italic
        - color: var(--text_on)
      card:
        - height: 15px
  bouton_person:
    show_state: false
    show_last_changed: false
    show_label: true
    show_entity_picture: true
    styles:
      entity_picture:
        - border-radius: 50%
        - opacity: 95%
        - width: 100%
      label:
        - font-weight: bold
        - line-height: 90%
      card:
        - height: 90px
      custom_fields:
        info1:
          - color: var(--text_systeme_info)
          - position: absolute
          - top: 78%
          - padding-left: 5%
          - font-size: 85%
          - font-weight: null
          - text-align: left
        info2:
          - color: var(--text_systeme_info)
          - position: absolute
          - top: 60%
          - padding-left: 5%
          - font-size: 85%
          - font-weight: null
          - text-align: left
  bouton_person_herve:
    entity: person.herve
    name: Aurel
    template:
      - police
      - base
      - bouton_person
      - state_person
      - effet
    label: |
      [[[
        return states['sensor.aurel_gps'].state
      ]]]
    custom_fields:
      info1: |
        [[[
          if (states['sensor.iphone_aurel_battery_state'].state == 'Charging')
          return `<ha-icon
            icon="mdi:battery-charging-50"
            style="width: 15px; height: 15px; color: gold;">
            </ha-icon><span> <span style="color: var(--text_on);">${states['sensor.iphone_aurel_battery_level'].state}%</span></span>`
          if (states['sensor.iphone_aurel_battery_state'].state == 'Not Charging')
          return `<ha-icon
            icon="mdi:battery"
            style="width: 15px; height: 15px; color: grey;">
            </ha-icon><span> <span style="color: var(--text_on);">${states['sensor.iphone_aurel_battery_level'].state}%</span></span>`
          if (states['sensor.iphone_aurel_battery_state'].state == 'Full')
          return `<ha-icon
            icon="mdi:battery-high"
            style="width: 15px; height: 15px; color: red;">
            </ha-icon><span> <span style="color: var(--text_on);">${states['sensor.iphone_aurel_battery_level'].state}%</span></span>`
        ]]]
      info2: |
        [[[
          if (states['person.herve'].state == 'home')
          return `<ha-icon
            icon="mdi:home"
            style="width: 15px; height: 15px; color: grey;">
            </ha-icon><span> <span style="color: var(--text_on);">${states['sensor.aurel_duree'].state}</span></span>`
          if (states['person.herve'].state != 'home')
          return `<ha-icon
            icon="mdi:home-export-outline"
            style="width: 15px; height: 15px; color: red;">
            </ha-icon><span> <span style="color: var(--text_on);">${states['sensor.aurel_duree'].state}</span></span>`
        ]]]
    tap_action:
      action: fire-dom-event
      browser_mod:
        command: popup
        title: Aurel
        card:
          type: vertical-stack
          cards:
            - square: false
              columns: 2
              type: grid
              cards:
                - type: custom:button-card
                  entity: person.herve
                  show_last_changed: true
                  show_entity_picture: true
                  show_state: true
                  template:
                    - base
                  styles:
                    entity_picture:
                      - width: 100%
                - type: custom:button-card
                  entity: sensor.iphone_aurel_battery_level
                  name: iPhone
                  show_last_changed: true
                  show_state: true
                  template:
                    - base
                    - state_batterie
            - type: map
              entities:
                - entity: person.herve
              aspect_ratio: 2/1
              dark_mode: false
              hours_to_show: 24
            - type: logbook
              entities:
                - person.herve
              hours_to_show: 24
  bouton_person_alex:
    entity: person.alex
    name: Alex
    template:
      - base
      - bouton_person
      - state_person
      - effet
    label: |
      [[[
        return states['sensor.alex_gps'].state
      ]]]
    custom_fields:
      info1: |
        [[[
          if (states['sensor.alex_iphone_battery_state_ha'].state == 'Charging')
          return `<ha-icon
            icon="mdi:battery-charging-50"
            style="width: 15px; height: 15px; color: gold;">
            </ha-icon><span> <span style="color: var(--text_on);">${states['sensor.alex_iphone_battery_level_ha'].state}%</span></span>`
          if (states['sensor.alex_iphone_battery_state_ha'].state == 'Not Charging')
          return `<ha-icon
            icon="mdi:battery"
            style="width: 15px; height: 15px; color: grey;">
            </ha-icon><span> <span style="color: var(--text_on);">${states['sensor.alex_iphone_battery_level_ha'].state}%</span></span>`
          if (states['sensor.alex_iphone_battery_state_ha'].state == 'Full')
          return `<ha-icon
            icon="mdi:battery-high"
            style="width: 15px; height: 15px; color: red;">
            </ha-icon><span> <span style="color: var(--text_on);">${states['sensor.alex_iphone_battery_level_ha'].state}%</span></span>`
        ]]]
      info2: |
        [[[
          if (states['person.alex'].state == 'home')
          return `<ha-icon
            icon="mdi:home"
            style="width: 15px; height: 15px; color: grey;">
            </ha-icon><span> <span style="color: var(--text_on);">${states['sensor.alex_duree'].state}</span></span>`
          if (states['person.alex'].state != 'home')
          return `<ha-icon
            icon="mdi:home-export-outline"
            style="width: 15px; height: 15px; color: red;">
            </ha-icon><span> <span style="color: var(--text_on);">${states['sensor.alex_duree'].state}</span></span>`
        ]]]
    tap_action:
      action: fire-dom-event
      browser_mod:
        command: popup
        title: Alex
        card:
          type: vertical-stack
          cards:
            - square: false
              columns: 2
              type: grid
              cards:
                - type: custom:button-card
                  entity: person.alex
                  show_last_changed: true
                  show_entity_picture: true
                  show_state: true
                  template:
                    - base
                  styles:
                    entity_picture:
                      - width: 100%
                - type: custom:button-card
                  entity: sensor.alex_iphone_battery_level_ha
                  name: iPhone
                  show_last_changed: true
                  show_state: true
                  template:
                    - base
                    - state_batterie
            - type: map
              entities:
                - entity: person.alex
              aspect_ratio: 2/1
              dark_mode: false
              hours_to_show: 24
            - type: logbook
              entities:
                - person.alex
              hours_to_show: 24
  bouton_person_tom:
    entity: person.tom
    name: Tom
    template:
      - base
      - bouton_person
      - state_person
      - effet
    label: |
      [[[
        return states['sensor.tom_gps'].state
      ]]]
    styles:
      card:
        - opacity: |
            [[[
              if (states['input_boolean.nilemato'].state == "off")
                return '100%';
              return '100%';
            ]]]
    custom_fields:
      info1: |
        [[[
          if (states['device_tracker.tom_mac_ping'].state == 'home')
          return `<ha-icon
            icon="mdi:desktop-mac"
            style="width: 15px; height: 15px; color: lightgrey;">
            </ha-icon><span> <span style="color: var(--text_on);">Allumé</span></span>`
          if (states['device_tracker.tom_mac_ping'].state == 'not_home')
          return `<ha-icon
            icon="mdi:desktop-mac"
            style="width: 15px; height: 15px; color: var(--text_off);">
            </ha-icon><span>  <span style="color: var(--text_off);">Éteint</span></span>`
        ]]]
      info2: |
        [[[
          if (states['person.tom'].state == 'home')
          return `<ha-icon
            icon="mdi:home"
            style="width: 15px; height: 15px; color: var(--text_off);">
            </ha-icon><span>  <span style="color: var(--text_on);">${states['sensor.tom_duree'].state}</span></span>`
          if (states['person.tom'].state != 'home')
          return `<ha-icon
            icon="mdi:home-export-outline"
            style="width: 15px; height: 15px; color: red;">
            </ha-icon><span>  <span style="color: var(--text_on);">${states['sensor.tom_duree'].state}</span></span>`
        ]]]
    tap_action:
      action: fire-dom-event
      browser_mod:
        command: popup
        title: Tom
        card:
          type: vertical-stack
          cards:
            - square: false
              columns: 2
              type: grid
              cards:
                - type: custom:button-card
                  entity: person.tom
                  show_last_changed: true
                  show_entity_picture: true
                  show_state: true
                  template:
                    - base
                - type: custom:button-card
                  entity: device_tracker.tom_mac_ping
                  name: MacBook
                  icon: mdi:desktop-mac
                  show_last_changed: true
                  show_state: true
                  template:
                    - base
            - type: logbook
              entities:
                - device_tracker.tom_mac_ping
              title: Journal MacBook
              hours_to_show: 72
  bouton_person_manon:
    entity: person.manon
    name: Manon
    template:
      - base
      - bouton_person
      - effet
    label: |
      [[[
        if (states['input_boolean.nilemato'].state == "off")
          return 'Absent';
        return 'Maison';
      ]]]
    styles:
      card:
        - opacity: |
            [[[
              if (states['input_boolean.nilemato'].state == "off")
                return '100%';
              return '100%';
            ]]]
      label:
        - color: |
            [[[
              if (states['input_boolean.nilemato'].state == "on")
                return 'var(--text_on)';
              return 'red';
            ]]]
    custom_fields:
      info1: |
        [[[
          if (states['device_tracker.tablette_manon'].state == 'home')
          return `<ha-icon
            icon="mdi:timer-sand-full"
            style="width: 15px; height: 15px; color: lightgrey;">
            </ha-icon><span> <span style="color: var(--text_on);">${states['sensor.manon_duree'].state}</span></span>`
          if (states['device_tracker.tablette_manon'].state == 'not_home')
          return `<ha-icon
            icon="mdi:timer-sand-full"
            style="width: 15px; height: 15px; color: grey;">
            </ha-icon><span>  <span style="color: var(--text_off);">${states['sensor.manon_duree'].state}</span></span>`
        ]]]
      info2: |
        [[[
          if (states['device_tracker.tablette_manon'].state == 'home')
          return `<ha-icon
            icon="mdi:tablet-android"
            style="width: 15px; height: 15px; color: lightgrey;">
            </ha-icon><span> <span style="color: var(--text_on);">Allumée</span></span>`
          if (states['device_tracker.tablette_manon'].state == 'not_home')
          return `<ha-icon
            icon="mdi:tablet-android"
            style="width: 15px; height: 15px; color: grey;">
            </ha-icon><span><span style="color: var(--text_off);">Éteint</span></span>`
        ]]]
    tap_action:
      action: fire-dom-event
      browser_mod:
        command: popup
        title: Manon
        card:
          type: vertical-stack
          cards:
            - square: false
              columns: 2
              type: grid
              cards:
                - type: custom:button-card
                  entity: device_tracker.tablette_manon
                  name: Tablette
                  icon: mdi:tablet-android
                  show_last_changed: true
                  show_state: true
                  template:
                    - base
            - type: logbook
              entities:
                - device_tracker.tablette_manon
              title: Journal
              hours_to_show: 72
  bouton_person_leane:
    entity: person.leane
    name: Léane
    template:
      - base
      - bouton_person
      - effet
    label: |
      [[[
        if (states['input_boolean.nilemato'].state == "off")
          return 'Absent';
        return 'Maison';
      ]]]
    styles:
      card:
        - opacity: |
            [[[
              if (states['input_boolean.nilemato'].state == "off")
                return '100%';
              return '100%';
            ]]]
      label:
        - color: |
            [[[
              if (states['input_boolean.nilemato'].state == "on")
                return 'var(--text_on)';
              return 'red';
            ]]]
    custom_fields:
      info1: |
        [[[
          if (states['device_tracker.leane_tab_ping'].state == 'home')
          return `<ha-icon
            icon="mdi:timer-sand-full"
            style="width: 15px; height: 15px; color: lightgrey;">
            </ha-icon><span> <span style="color: var(--text_on);">${states['sensor.leane_duree'].state}</span></span>`
          if (states['device_tracker.leane_tab_ping'].state == 'not_home')
          return `<ha-icon
            icon="mdi:timer-sand-full"
            style="width: 15px; height: 15px; color: grey;">
            </ha-icon><span>  <span style="color: var(--text_off);">${states['sensor.leane_duree'].state}</span></span>`
        ]]]
      info2: |
        [[[
          if (states['device_tracker.leane_tab_ping'].state == 'home')
          return `<ha-icon
            icon="mdi:tablet-android"
            style="width: 15px; height: 15px; color: lightgrey;">
            </ha-icon><span> <span style="color: var(--text_on);">Allumée</span></span>`
          if (states['device_tracker.leane_tab_ping'].state == 'not_home')
          return `<ha-icon
            icon="mdi:tablet-android"
            style="width: 15px; height: 15px; color: grey;">
            </ha-icon><span><span style="color: var(--text_off);">Éteint</span></span>`
        ]]]
    tap_action:
      action: fire-dom-event
      browser_mod:
        command: popup
        title: Léane
        card:
          type: vertical-stack
          cards:
            - square: false
              columns: 2
              type: grid
              cards:
                - type: custom:button-card
                  entity: device_tracker.leane_tab_ping
                  name: Tablette
                  icon: mdi:tablet-android
                  show_last_changed: true
                  show_state: true
                  template:
                    - base
            - type: logbook
              entities:
                - device_tracker.leane_tab_ping
              title: Journal
              hours_to_show: 72
  bouton_person_nina:
    entity: person.nina
    name: Nina
    template:
      - base
      - bouton_person
      - effet
    label: |
      [[[
        if (states['input_boolean.nilemato'].state == "off")
          return 'Absent';
        return 'Maison';
      ]]]
    styles:
      card:
        - opacity: |
            [[[
              if (states['input_boolean.nilemato'].state == "off")
                return '100%';
              return '100%';
            ]]]
      label:
        - color: |
            [[[
              if (states['input_boolean.nilemato'].state == "on")
                return 'var(--text_on)';
              return 'red';
            ]]]
  carte_ronde:
    show_icon: true
    show_name: true
    show_state: false
    show_label: true
    styles:
      img_cell:
        - background-color: var(--pastille_off)
        - border-radius: 50%
        - width: 35px
        - height: 35px
      icon:
        - width: 75%
        - color: var(--icon_off)
      name:
        - font-size: 60%
        - color: var(--text_on)
        - text-align: center
        - white-space: normal
      label:
        - font-size: 60%
        - color: |
            [[[
              if (entity.state == "on")
                return 'var(--text_on)';
              return 'rgba(0,0,0,0)';
            ]]]
      state:
        - font-size: 60%
        - color: var(--text_on)
      card:
        - border-radius: 40px
        - width: 50px
        - height: 75px
        - border-color: var(--card_border)
        - border-style: outset
        - border-width: 1px
        - box-shadow: var(--card_box_shadow)
    double_tap_action:
      action: toggle
  carte_ronde_no_label:
    show_icon: true
    show_name: true
    show_state: false
    show_label: false
    styles:
      img_cell:
        - background-color: var(--pastille_off)
        - border-radius: 50%
        - width: 35px
        - height: 35px
      icon:
        - width: 75%
        - color: var(--icon_off)
      name:
        - font-size: 60%
        - color: var(--text_on)
        - text-align: center
        - white-space: normal
        - line-height: 90%
      card:
        - border-radius: 40px
        - width: 50px
        - height: 75px
        - padding-bottom: 30%
        - border-color: var(--card_border)
        - border-style: outset
        - border-width: 1px
        - box-shadow: var(--card_box_shadow)
    double_tap_action:
      action: toggle
  base_verticale_centree:
    show_icon: true
    show_name: true
    show_state: false
    show_label: false
    show_last_changed: false
    template:
      - police
    styles:
      img_cell:
        - background-color: var(--pastille_off)
        - border-radius: 50%
        - width: 33px
        - height: 33px
      icon:
        - width: 70%
        - color: var(--icon_off)
      name:
        - padding-top: 1px
        - padding-bottom: 1px
        - color: var(--text_on)
        - font-size: 80%
        - font-weight: null
        - text-align: left
        - white-space: normal
      state:
        - color: var(--text_on)
        - font-size: 80%
        - font-weight: null
        - text-align: left
        - white-space: normal
      label:
        - color: var(--text_on)
        - font-size: 70%
        - font-weight: null
        - text-align: center
      card:
        - padding-left: 1px
        - padding-right: 1px
        - font-size: 100%
        - height: 70px
        - border-color: var(--card_border)
        - border-style: outset
        - border-width: 1px
        - box-shadow: var(--card_box_shadow)
        - animation: ball-scale 0.2s
  bouton_titre_piece:
    show_icon: false
    show_name: true
    show_state: false
    show_label: true
    template:
      - police
    styles:
      name:
        - font-size: 88%
        - font-weight: null
        - color: var(--text_on)
        - justify-self: start
      label:
        - font-size: 83%
        - color: var(--text_off)
        - justify-self: start
      card:
        - height: 38px
        - background: transparent
        - box-shadow: none
        - padding: 02%
        - border-radius: 0%
        - line-height: 120%
    double_tap_action:
      action: toggle
    tap_action:
      action: more-info
    style:
      .: |
        ha-card {
            --ha-card-background: none !important;
            box-shadow: none !important;
            font-family: Avenir
  bouton_minuteur:
    show_icon: true
    show_name: true
    show_state: true
    show_label: false
    show_last_changed: false
    icon: mdi:timer
    template:
      - police
    styles:
      icon:
        - width: 70%
        - color: var(--icon_off)
      name:
        - font-size: 100%
        - font-weight: null
      label:
        - font-weight: bold
        - font-size: 90%
      state:
        - font-weight: bold
        - font-size: 90%
      card:
        - height: auto
        - width: null
        - padding: 5px
        - font-size: 100%
        - border-color: var(--card_border)
        - border-style: outset
        - border-width: 1px
        - box-shadow: var(--card_box_shadow)
    double_tap_action:
      action: more-info
  bouton_badge:
    show_icon: false
    show_name: false
    show_state: false
    show_label: true
    template:
      - police
    styles:
      label:
        - justify-self: center
        - padding: 1px
        - font-weight: null
        - font-size: 80%
        - font-weight: null
        - color: var(--text_on)
      grid:
        - grid-template-areas: '"l"'
      card:
        - border-radius: 18px
        - height: 25px
        - width: auto
        - padding-left: 4px
        - padding-right: 6px
        - border-color: var(--card_border)
        - border-style: outset
        - border-width: 1px
        - box-shadow: var(--card_box_shadow)
    double_tap_action:
      action: more-info
  bouton_systeme:
    show_icon: true
    show_name: true
    show_state: false
    show_label: true
    template:
      - police
    styles:
      grid:
        - grid-template-areas: |
            "i"
            "info1"
            "info2"
            "info3"
            "info4"
        - grid-template-columns: 1fr
        - grid-template-rows: 1fr
      img_cell:
        - border-radius: 50%
        - width: 37px
        - height: 37px
        - color: var(--text_systeme_info)
        - justifiy-self: start
        - place-self: start
      icon:
        - color: var(--icon_off)
        - width: 70%
      name:
        - padding: 0px 0px 0px 0px
        - color: var(--text_off)
        - top: 8%
        - left: 32%
        - position: absolute
        - font-size: 100%
        - font-weight: null
        - text-align: left
        - place-self: start
      label:
        - padding-top: 2%
        - color: var(--text_on)
        - top: 18%
        - left: 32%
        - position: absolute
        - font-size: 100%
        - font-weight: null
        - text-align: left
        - place-self: start
        - font-weight: bold
      card:
        - height: 140px
        - font-size: 100%
        - padding: 5%
        - border-color: var(--card_border)
        - border-style: outset
        - border-width: 1px
        - box-shadow: var(--card_box_shadow)
        - line-height: 120%
      custom_fields:
        ic:
          - position: absolute
          - top: 2%
          - left: 113%
          - width: calc(55% + 1px)
          - transform: translate(-50%, calc(-50% + 10px))
          - z-index: 1
          - '--paper-card-background-color': rgba(0, 0, 0, 0.0)
          - '--ha-card-background': rgba(0, 0, 0, 0.0)"
          - '--ha-card-box-shadow': none
          - opacity: 100%
        graph:
          - position: absolute
          - top: 70%
          - left: 50%
          - width: calc(100% + 15px)
          - transform: translate(-50%, calc(-50% + 10px))
          - z-index: 12
          - '--paper-card-background-color': rgba(0, 0, 0, 0.0)
          - '--ha-card-background': rgba(0, 0, 0, 0.0)"
          - '--ha-card-box-shadow': none
        info1:
          - color: var(--text_systeme_info)
          - padding-left: 2%
          - justifiy-self: start
          - font-size: 90%
          - font-weight: null
          - text-align: left
        info2:
          - color: var(--text_systeme_info)
          - padding-left: 2%
          - justifiy-self: start
          - font-size: 90%
          - font-weight: null
          - text-align: left
        info3:
          - color: var(--text_systeme_info)
          - padding-left: 2%
          - justifiy-self: start
          - font-size: 90%
          - font-weight: null
          - text-align: left
        info4:
          - color: var(--text_systeme_info)
          - padding-left: 2%
          - justifiy-self: start
          - font-size: 90%
          - font-weight: null
          - text-align: left
  effet:
    extra_styles: |
      @keyframes ball-scale {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(0.90);
        }
      }
      @keyframes ball-scale2 {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(0.90);
        }
      }

      @keyframes ball-scale2 {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(0.90);
        }
      }
      @keyframes ball-scale2 {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(0.90);
        }
      }
title: Chez On
views:
  - theme: Backend-selected
    icon: mdi:home
    visible:
      - user: 76afcf1927a948b19530bcbf1074ac59
      - user: 2f0040afe95a4514ade3c049a0b5d479
      - user: d8316597eafd4333b737464a5b4c62d0
    layout:
      width: 350
      max_cols: 4
    type: custom:horizontal-layout
    badges: []
    cards:
      - type: custom:layout-card
        layout_type: masonry
        cards:
          - cards:
              - type: vertical-stack
                cards:
                  - type: custom:button-card
                    template:
                      - bouton_titre_piece
                    label: |
                      [[[ return states['sensor.bonjour'].state ]]]
                    name: |
                      [[[ return "Il est " +states['sensor.time'].state ]]]
                  - type: horizontal-stack
                    cards:
                      - type: custom:button-card
                        entity: sensor.compteur_home
                        name: Personnes
                        template:
                          - bouton_badge
                        label: |
                          [[[
                            if (entity.state == 'unavailable')
                              return "🏠 HS" ;
                            return "🏠 " + (entity.state ) ;
                          ]]]
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Personnes
                            card:
                              type: vertical-stack
                              cards:
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      template:
                                        - bouton_person_herve
                                    - type: custom:button-card
                                      template:
                                        - bouton_person_alex
                                    - type: custom:button-card
                                      template:
                                        - bouton_person_tom
                                  square: false
                                  columns: 3
                                - aspect_ratio: '2:1'
                                  dark_mode: false
                                  default_zoom: 17
                                  entities:
                                    - entity: person.herve
                                    - entity: person.alex
                                    - entity: person.tom
                                  hours_to_show: 12
                                  type: map
                      - type: custom:button-card
                        entity: sensor.temp_moyenne_rdc
                        triggers_update:
                          - sensor.temp_moyenne_etage
                        name: temp rdc
                        template:
                          - bouton_badge
                          - state_temp
                        label: |
                          [[[
                            if (entity.state == 'unavailable')
                              return "🌡 HS" ;
                            return "🌡 " + (entity.state ) +"° / "+states['sensor.temp_moyenne_etage'].state+"°";
                          ]]]
                        styles:
                          card:
                            - opacity: |
                                [[[
                                  if (entity.state == 'unavailable')
                                    return "50%" ;
                                  if (entity.state == '° / °')
                                    return "50%" ;
                                  return "100%";
                                ]]]
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Température / Humidité
                            card:
                              type: vertical-stack
                              cards:
                                - type: custom:button-card
                                  template:
                                    - popup_titre
                                  label: |
                                    [[[ return "Extérieur" ]]]
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: sensor.weather_temperature_v2
                                      name: >
                                        [[[ return
                                        states['sensor.weather_conditions_simplifiees'].state]]]
                                      units: °C
                                      icon: |
                                        [[[
                                          if (states['weather.ta_ville'].state == 'sunny' )
                                            return 'mdi:weather-sunny';
                                          if (states['weather.ta_ville'].state == 'rainy' )
                                            return 'mdi:weather-rainy';
                                          if (states['weather.ta_ville'].state == 'partlycloudy' )
                                            return 'mdi:weather-partly-cloudy';
                                          if (states['weather.ta_ville'].state == 'cloudy' )
                                            return 'mdi:weather-cloudy';
                                          if (states['weather.ta_ville'].state == 'clear-night' )
                                            return 'mdi:weather-night';
                                          if (states['weather.ta_ville'].state == 'fog' )
                                            return 'mdi:weather-fog';
                                          if (states['weather.ta_ville'].state == 'hail' )
                                            return 'mdi:weather-hail';
                                          if (states['weather.ta_ville'].state == 'lightning-rainy' )
                                            return 'mdi:weather-lightning-rainy';
                                          if (states['weather.ta_ville'].state == 'lightning' )
                                            return 'mdi:weather-lightning';
                                          if (states['weather.ta_ville'].state == 'pourring' )
                                            return 'mdi:weather-pouring';
                                          if (states['weather.ta_ville'].state == 'snowy-rainy' )
                                            return 'mdi:weather-snowy-rainy';
                                          if (states['weather.ta_ville'].state == 'snowy' )
                                            return 'mdi:weather-snowy';
                                          if (states['weather.ta_ville'].state == 'windy-variant' )
                                            return 'mdi:weather-windy-variant';
                                          if (states['weather.ta_ville'].state == 'windy' )
                                            return 'mdi:weather-windy';
                                          if (states['weather.ta_ville'].state == 'exceptional' )
                                            return 'mdi:weather-cloudy-alert';
                                          return 'mdi:weather-sunny';
                                        ]]]
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp_exterieur
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: sensor.plante_citro_temp
                                      name: Véranda
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp_exterieur
                                        - state_unavailable
                                  columns: 3
                                  square: false
                                - type: custom:button-card
                                  template:
                                    - popup_titre
                                  label: |
                                    [[[ return "Maison" ]]]
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: sensor.temp_sejour
                                      name: null
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: sensor.temp_couloir_rdc
                                      name: Couloir
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: sensor.temp_cuisine
                                      name: Cuisine
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: sensor.temp_parents
                                      name: null
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: sensor.temp_tom
                                      name: null
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: sensor.temp_manon
                                      name: Manon Lélé
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: sensor.temp_nina
                                      name: null
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: sensor.temp_salle_de_bain
                                      name: SdB
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp
                                        - state_unavailable
                                  columns: 3
                                  square: false
                                - type: vertical-stack
                                  cards:
                                    - header:
                                        title: 🛋 RDC température
                                        show: true
                                        show_states: true
                                        colorize_states: true
                                      experimental:
                                        brush: true
                                      graph_span: 72h
                                      brush:
                                        selection_span: 12h
                                      apex_config:
                                        grid:
                                          show: false
                                        legend:
                                          fontSize: 12px
                                          height: 40
                                        dataLabels:
                                          enabled: false
                                        stroke:
                                          width: 3
                                          curve: smooth
                                        fill:
                                          type: gradient
                                          gradient:
                                            type: vertical
                                            shadeIntensity: 0.8
                                            inverseColors: false
                                            opacityFrom: 0.5
                                            opacityTo: 0
                                            stops:
                                              - - 0
                                                - 50
                                                - 100
                                        tooltip:
                                          enabled: true
                                        xaxis:
                                          axisBorder:
                                            show: false
                                          labels:
                                            style:
                                              fontSize: 14px
                                      series:
                                        - entity: sensor.temp_sejour
                                          name: Séjour
                                          show:
                                            extremas: false
                                          type: area
                                          color: grey
                                          fill_raw: last
                                          float_precision: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                        - entity: sensor.temp_couloir_rdc
                                          name: Couloir
                                          show:
                                            extremas: false
                                          type: area
                                          color: violet
                                          fill_raw: last
                                          float_precision: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                        - entity: sensor.temp_cuisine
                                          name: Cuisine
                                          show:
                                            extremas: false
                                          type: area
                                          color: red
                                          fill_raw: last
                                          float_precision: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                        - entity: sensor.temp_moyenne_rdc
                                          name: Moyenne
                                          color: dodgerblue
                                          fill_raw: last
                                          type: area
                                          stroke_width: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                          show:
                                            in_brush: true
                                            in_chart: false
                                      card_mod:
                                        style: |
                                          ha-card {
                                          background-color: black;
                                          }
                                      type: custom:apexcharts-card
                                    - header:
                                        title: 🛋 RDC humidité
                                        show: true
                                        show_states: true
                                        colorize_states: true
                                      experimental:
                                        brush: true
                                      graph_span: 72h
                                      brush:
                                        selection_span: 12h
                                      apex_config:
                                        grid:
                                          show: false
                                        legend:
                                          fontSize: 12px
                                          height: 40
                                        dataLabels:
                                          enabled: false
                                        stroke:
                                          width: 3
                                          curve: smooth
                                        fill:
                                          type: gradient
                                          gradient:
                                            type: vertical
                                            shadeIntensity: 0.8
                                            inverseColors: false
                                            opacityFrom: 0.5
                                            opacityTo: 0
                                            stops:
                                              - - 0
                                                - 50
                                                - 100
                                        tooltip:
                                          enabled: true
                                        xaxis:
                                          axisBorder:
                                            show: false
                                          labels:
                                            style:
                                              fontSize: 14px
                                      series:
                                        - entity: sensor.hum_sejour
                                          name: Séjour
                                          show:
                                            extremas: false
                                          type: area
                                          color: grey
                                          fill_raw: last
                                          float_precision: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                        - entity: sensor.hum_couloir_rdc
                                          name: Couloir
                                          show:
                                            extremas: false
                                          type: area
                                          color: violet
                                          fill_raw: last
                                          float_precision: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                        - entity: sensor.hum_cuisine
                                          name: Cuisine
                                          show:
                                            extremas: false
                                          type: area
                                          color: red
                                          fill_raw: last
                                          float_precision: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                      card_mod:
                                        style: |
                                          ha-card {
                                          background-color: black;
                                          }
                                      type: custom:apexcharts-card
                                - type: vertical-stack
                                  cards:
                                    - header:
                                        title: 🛏Chambres température
                                        show: true
                                        show_states: true
                                        colorize_states: true
                                      experimental:
                                        brush: true
                                      graph_span: 72h
                                      brush:
                                        selection_span: 12h
                                      apex_config:
                                        grid:
                                          show: false
                                        legend:
                                          fontSize: 12px
                                          height: 40
                                        dataLabels:
                                          enabled: false
                                        stroke:
                                          width: 3
                                          curve: smooth
                                        fill:
                                          type: gradient
                                          gradient:
                                            type: vertical
                                            shadeIntensity: 0.8
                                            inverseColors: false
                                            opacityFrom: 0.5
                                            opacityTo: 0
                                            stops:
                                              - - 0
                                                - 50
                                                - 100
                                        tooltip:
                                          enabled: true
                                        xaxis:
                                          axisBorder:
                                            show: false
                                          labels:
                                            style:
                                              fontSize: 14px
                                      series:
                                        - entity: sensor.temp_parents
                                          name: Parents
                                          show:
                                            extremas: false
                                          type: area
                                          color: grey
                                          fill_raw: last
                                          float_precision: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                        - entity: sensor.temp_tom
                                          name: Tom
                                          show:
                                            extremas: false
                                          type: area
                                          color: dodgerblue
                                          fill_raw: last
                                          float_precision: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                        - entity: sensor.temp_manon
                                          name: Manon
                                          show:
                                            extremas: false
                                          type: area
                                          color: red
                                          fill_raw: last
                                          float_precision: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                        - entity: sensor.temp_nina
                                          name: Nina
                                          show:
                                            extremas: false
                                          type: area
                                          color: salmon
                                          fill_raw: last
                                          float_precision: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                        - entity: sensor.temp_parents
                                          name: Parents
                                          color: grey
                                          fill_raw: last
                                          type: area
                                          stroke_width: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                          show:
                                            in_brush: true
                                            in_chart: false
                                      card_mod:
                                        style: |
                                          ha-card {
                                          background-color: black;
                                          }
                                      type: custom:apexcharts-card
                                    - header:
                                        title: 🛏Chambres humidité
                                        show: true
                                        show_states: true
                                        colorize_states: true
                                      experimental:
                                        brush: true
                                      graph_span: 72h
                                      brush:
                                        selection_span: 12h
                                      apex_config:
                                        grid:
                                          show: false
                                        legend:
                                          fontSize: 12px
                                          height: 40
                                        dataLabels:
                                          enabled: false
                                        stroke:
                                          width: 3
                                          curve: smooth
                                        fill:
                                          type: gradient
                                          gradient:
                                            type: vertical
                                            shadeIntensity: 0.8
                                            inverseColors: false
                                            opacityFrom: 0.5
                                            opacityTo: 0
                                            stops:
                                              - - 0
                                                - 50
                                                - 100
                                        tooltip:
                                          enabled: true
                                        xaxis:
                                          axisBorder:
                                            show: false
                                          labels:
                                            style:
                                              fontSize: 14px
                                      series:
                                        - entity: sensor.hum_parents
                                          name: Parents
                                          show:
                                            extremas: false
                                          type: area
                                          color: grey
                                          fill_raw: last
                                          float_precision: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                        - entity: sensor.hum_tom
                                          name: Tom
                                          show:
                                            extremas: false
                                          type: area
                                          color: dodgerblue
                                          fill_raw: last
                                          float_precision: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                        - entity: sensor.hum_manon
                                          name: Manon
                                          show:
                                            extremas: false
                                          type: area
                                          color: red
                                          fill_raw: last
                                          float_precision: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                        - entity: sensor.hum_nina
                                          name: Nina
                                          show:
                                            extremas: false
                                          type: area
                                          color: salmon
                                          fill_raw: last
                                          float_precision: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                        - entity: sensor.temp_parents
                                          name: Parents
                                          color: grey
                                          fill_raw: last
                                          type: area
                                          stroke_width: 1
                                          group_by:
                                            duration: 10min
                                            func: avg
                                          show:
                                            in_brush: true
                                            in_chart: false
                                      card_mod:
                                        style: |
                                          ha-card {
                                          background-color: black;
                                          }
                                      type: custom:apexcharts-card
                      - type: custom:button-card
                        entity: sensor.myenedis_cost_yesterday_09397539765420
                        name: meteo
                        template:
                          - bouton_badge
                          - state_unavailable
                        label: |
                          [[[

                            if (entity.state == '-1.0')
                              return "⚡️ HS" ;
                            if (entity.state == 'unavailable')
                              return "⚡️ HS" ;
                            return "⚡️ " + " " + (entity.state ) + " €";
                          ]]]
                        styles:
                          card:
                            - opacity: |
                                [[[
                                  if (entity.state == '-1.0')
                                    return "50%" ;
                                  if (entity.state == 'unavailable')
                                    return "50%" ;
                                  return "100%";
                                ]]]
                            - box-shadow: |
                                [[[
                                  if (entity.state < 2.50) return 'var(--card_box_shadow)';
                                  if (entity.state >= 2.50 && entity.state < 3) return '';
                                  else return '';
                                ]]]
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Consommation électrique
                            card:
                              type: vertical-stack
                              cards:
                                - type: custom:content-card-linky
                                  entity: sensor.myenedis_09397539765420
                                  showInTableUnit: false
                                  showPeakOffPeak: false
                                  showHistory: true
                                  showDayPrice: true
                                  showDayPriceHCHP: false
                                  showDayHCHP: false
                                  showIcon: false
                                  kWhPrice: false
                                  showtitle: true
                                  style: |
                                    ha-card {
                                      color: lightgrey ;
                                      font-size: 95%;
                                      font-family: Avenir;
                                    }
                                  nbJoursAffichage: '7'
                                  showDayName: short
                                  showTitle: true
                                  showPrice: true
                                  showCurrentMonthRatio: true
                                  showTitreLigne: true
                                  showError: true
                                  showYesterdayRatio: true
                                - type: markdown
                                  content: >-

                                    <font color='lightgrey'><b>Coût :
                                    </b></font><font
                                    color='red'><b>`0.1557€`</b></font><font
                                    color='grey'>

                                    - Hier : <font color='lightgrey'>**{{
                                    (((states('sensor.myenedis_09397539765420')
                                    | float) * (0.1557) | float)) | round(2)
                                    }}€**<font color='grey'>

                                    - Cette semaine :  <font
                                    color='lightgrey'>**{{
                                    states('sensor.myenedis_conso_semaine_en_cours_v2')
                                    }}€**<font color='grey'>

                                    - Semaine dernière :  <font
                                    color='lightgrey'>**{{
                                    (((states('sensor.myenedis_conso_semaine_derniere')
                                    | float) * (0.0001557) | float)) | round(2)
                                    }}€**


                                    <font color='lightgrey'><b>Abo mensuel
                                    inclus :</b></font> <font
                                    color='red'><b>`10.66€/mois`</b></font><font
                                    color='grey'>

                                    - Mois en cours : <font
                                    color='lightgrey'>**{{
                                    states('sensor.myenedis_cout_mois_en_cours_abo')
                                    }}€**<font color='grey'>

                                    - Mois dernier : <font
                                    color='lightgrey'>**{{
                                    states('sensor.myenedis_conso_mois_dernier')
                                    }}€**<font color='grey'> 

                                    - Année en cours :  <font
                                    color='lightgrey'>**{{
                                    states('sensor.myenedis_cout_annee_en_cours_abo')
                                    }}€**
                                  style: |
                                    ha-card {
                                      font-size: 110%;
                                      font-family: Avenir;
                                    }
                                - align_header: center
                                  align_icon: center
                                  align_state: center
                                  animate: true
                                  color_thresholds:
                                    - color: dodgerblue
                                      value: 0
                                    - color: dodgerblue
                                      value: 0.2
                                    - color: dodgerblue
                                      value: 0.4
                                    - color: dodgerblue
                                      value: 0.6
                                    - color: dodgerblue
                                      value: 0.8
                                    - color: dodgerblue
                                      value: 1
                                    - color: blue
                                      value: 1.2
                                    - color: blue
                                      value: 1.4
                                    - color: blue
                                      value: 1.6
                                    - color: gold
                                      value: 1.8
                                    - color: orange
                                      value: 2
                                    - color: orange
                                      value: 2.2
                                    - color: orange
                                      value: 2.4
                                    - color: orange
                                      value: 2.6
                                    - color: orange
                                      value: 2.8
                                    - color: red
                                      value: 3
                                    - color: red
                                      value: 3.5
                                    - color: red
                                      value: 4
                                    - color: red
                                      value: 4.5
                                    - color: red
                                      value: 5
                                    - color: red
                                      value: 5.5
                                    - color: red
                                      value: 6
                                    - color: firebrick
                                      value: 7
                                    - color: firebrick
                                      value: 8
                                    - color: firebrick
                                      value: 9
                                    - color: firebrick
                                      value: 10
                                  entities:
                                    - entity: sensor.myenedis_cout_j7
                                    - entity: sensor.myenedis_cout_j6
                                    - entity: sensor.myenedis_cout_j5
                                    - entity: sensor.myenedis_cout_j4
                                    - entity: sensor.myenedis_cout_j3
                                    - entity: sensor.myenedis_cout_j2
                                    - entity: sensor.myenedis_cout_j1
                                  font_size: 80
                                  font_size_header: 13
                                  hour24: true
                                  hours_to_show: 24
                                  icon: mdi:currency-eur
                                  line_width: 2
                                  name: Coût sur 7 jours
                                  point_per_hour: 1
                                  group_by: date
                                  show:
                                    graph: bar
                                    name: true
                                    state: false
                                    extrema: false
                                    fill: false
                                    icon: true
                                    icon_adaptive_color: false
                                    labels: true
                                    labels_secondary: false
                                    legend: false
                                    line: false
                                    indicator: false
                                    name_adaptive_color: false
                                  style: |
                                    ha-card {
                                      color: dodgerblue;
                                      font-family: Avenir;
                                    }
                                    :host {
                                      --paper-item-icon-color: dodgerblue;
                                    }
                                  type: custom:mini-graph-card
                  - square: false
                    columns: 2
                    type: grid
                    cards:
                      - type: custom:button-card
                        entity: alarm_control_panel.alarme
                        name: Alarme
                        icon: |
                          [[[
                            if (entity.state == "disarmed" )
                              return "mdi:shield-off";
                            if (entity.state == "armed_away" )
                              return "mdi:shield-lock";
                            if (entity.state == "arming" )
                              return "mdi:shield-half-full";
                            if (entity.state == "triggered" )
                              return "mdi:shield-alert";
                            return "mdi:shield-off";
                          ]]]
                        template:
                          - base
                          - carte_securite
                          - state_alarme
                        double_tap_action:
                          action: call-service
                          service: script.alarme_on_off
                          service_data: null
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Système de sécurité
                            card:
                              type: vertical-stack
                              cards:
                                - type: alarm-panel
                                  states:
                                    - arm_away
                                  entity: alarm_control_panel.alarme
                                - type: custom:button-card
                                  template:
                                    - popup_titre
                                  label: |
                                    [[[ return "Caméras " ]]]
                                - type: grid
                                  square: false
                                  columns: 3
                                  cards:
                                    - type: custom:button-card
                                      entity: switch.cam_sejour
                                      name: Séjour
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: switch.camera_garage
                                      name: Garage
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                - type: custom:button-card
                                  template:
                                    - popup_titre
                                  label: |
                                    [[[ return "Sirène" ]]]
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: script.alarme_sirene_off
                                      name: 'OFF'
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.alarme_sirene
                                      name: Sirène
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: siren.alarme_sirene
                                      name: Sirène
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                  square: false
                                  columns: 3
                                - type: custom:button-card
                                  template:
                                    - popup_titre
                                  label: |
                                    [[[ return "Portes et fenêtres" ]]]
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: binary_sensor.porte_entree
                                      name: Entrée
                                      template:
                                        - base
                                        - base_capteur
                                        - state_porte
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.porte_salle_a_manger
                                      name: SaM
                                      template:
                                        - base
                                        - base_capteur
                                        - state_porte
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.porte_cuisine
                                      name: null
                                      template:
                                        - base
                                        - base_capteur
                                        - state_porte
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.porte_chambre_parents
                                      name: null
                                      template:
                                        - base
                                        - base_capteur
                                        - state_porte
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.porte_cagibi
                                      name: null
                                      template:
                                        - base
                                        - base_capteur
                                        - state_porte
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.porte_garage
                                      name: null
                                      template:
                                        - base
                                        - base_capteur
                                        - state_porte
                                        - state_unavailable
                                  square: false
                                  columns: 3
                                - type: custom:button-card
                                  template:
                                    - popup_titre
                                  label: |
                                    [[[ return "Mouvements" ]]]
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_salon
                                      name: Salon
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_salle_a_manger
                                      name: SaM
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_couloir
                                      name: Couloir
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_salle_d_eau
                                      name: Lavabo
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                        - state_unavailable
                                      tap_action:
                                        action: more-info
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_garage
                                      name: Garage
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_escalier
                                      name: Escaliers
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                        - state_unavailable
                                  square: false
                                  columns: 3
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_tom
                                      name: Tom
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_manon
                                      name: Manon
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_leane
                                      name: Léane
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_nina
                                      name: Nina
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_palier
                                      name: Palier
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                        - state_unavailable
                                  square: false
                                  columns: 3
                      - type: custom:button-card
                        entity: alarm_control_panel.aarlo_sonnette
                        template:
                          - base
                          - carte_securite
                          - state_alarme
                        name: >
                          [[[ return "Sonnette " +
                          states['sensor.aarlo_battery_level_sonnette'].state
                          +"%"]]]
                        icon: phu:arlo-video-doorbell
                        double_tap_action:
                          action: call-service
                          service: script.alarme_sonnette_on_off
                          service_data: null
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Sonnette Arlo
                            card:
                              type: vertical-stack
                              cards:
                                - entity: camera.aarlo_sonnette
                                  hide:
                                    - title
                                    - date
                                  image_click: play
                                  show:
                                    - motion
                                    - sound
                                    - image_date
                                    - signal_strength
                                    - captured_today
                                    - image_date
                                    - on_off
                                    - snapshot
                                    - battery_level
                                  top_date: true
                                  top_status: false
                                  top_title: false
                                  type: custom:aarlo-glance
                                - type: alarm-panel
                                  states:
                                    - arm_away
                                  entity: alarm_control_panel.aarlo_sonnette
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: sensor.aarlo_battery_level_sonnette
                                      name: Batterie
                                      show_last_changed: false
                                      template:
                                        - base
                                        - base_capteur
                                        - state_batterie
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.aarlo_motion_sonnette
                                      name: Mouvement
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: sensor.aarlo_last_sonnette
                                      name: Dernier
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.aarlo_ding_sonnette
                                      name: Ding !
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: switch.aarlo_snapshot_sonnette
                                      name: Capture
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: sensor.aarlo_captured_today_sonnette
                                      name: Nbre ce jour
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: binary_sensor.aarlo_connected_sonnette
                                      name: Statut
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: sensor.aarlo_signal_strength_sonnette
                                      name: Signal
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: camera.aarlo_sonnette
                                      name: Caméra
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: switch.aarlo_siren_sonnette
                                      name: Sirène
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                  square: false
                                  columns: 3
                                - header:
                                    title: 🚪Sonnette Arlo
                                    show: true
                                    show_states: true
                                    colorize_states: true
                                  experimental:
                                    brush: true
                                  graph_span: 336h
                                  brush:
                                    selection_span: 72h
                                  apex_config:
                                    grid:
                                      show: false
                                    legend:
                                      fontSize: 12px
                                      height: 40
                                    dataLabels:
                                      enabled: false
                                    stroke:
                                      width: 3
                                      curve: smooth
                                    fill:
                                      type: gradient
                                      gradient:
                                        type: vertical
                                        shadeIntensity: 0.8
                                        inverseColors: false
                                        opacityFrom: 0.5
                                        opacityTo: 0
                                        stops:
                                          - - 0
                                            - 50
                                            - 100
                                    tooltip:
                                      enabled: true
                                    yaxis:
                                      - show: true
                                        decimalsInFloat: 0
                                        labels:
                                          style:
                                            colors: '#FFB62E'
                                            fontSize: 12px
                                        forceNiceScale: true
                                      - show: true
                                        decimalsInFloat: 0
                                        opposite: true
                                        labels:
                                          style:
                                            colors: '#2eb9ff'
                                            fontSize: 12px
                                        forceNiceScale: true
                                    xaxis:
                                      axisBorder:
                                        show: false
                                      labels:
                                        style:
                                          fontSize: 14px
                                  series:
                                    - entity: sensor.aarlo_battery_level_sonnette
                                      name: Batterie
                                      show:
                                        extremas: true
                                      type: area
                                      color: grey
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.aarlo_battery_level_sonnette
                                      name: Batterie
                                      color: dodgerblue
                                      fill_raw: last
                                      type: area
                                      stroke_width: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                      show:
                                        in_brush: true
                                        in_chart: false
                                  card_mod:
                                    style: |
                                      ha-card {
                                      }
                                  type: custom:apexcharts-card
                  - square: false
                    columns: 6
                    type: grid
                    cards:
                      - type: custom:button-card
                        entity: group.mode
                        name: Modes
                        label: |
                          [[[
                            return states['sensor.compteur_modes'].state
                          ]]]
                        template:
                          - carte_ronde
                          - state_modes
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Modes
                            card:
                              square: false
                              columns: 2
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: input_boolean.nilemato
                                  name: null
                                  show_state: true
                                  template:
                                    - base
                                    - state_appareil
                                  tap_action:
                                    action: toggle
                                - type: custom:button-card
                                  entity: automation.annonce_ecole
                                  name: Annonce école
                                  show_state: true
                                  template:
                                    - base
                                    - state_appareil
                                  tap_action:
                                    action: toggle
                                - type: custom:button-card
                                  entity: input_boolean.belle_saison
                                  name: null
                                  show_state: true
                                  template:
                                    - base
                                    - state_appareil
                                  tap_action:
                                    action: toggle
                                - type: custom:button-card
                                  entity: input_boolean.piscine
                                  name: null
                                  show_state: true
                                  template:
                                    - base
                                    - state_appareil
                                  tap_action:
                                    action: toggle
                                - type: custom:button-card
                                  entity: input_boolean.vacances
                                  name: null
                                  show_state: true
                                  template:
                                    - base
                                    - state_appareil
                                  tap_action:
                                    action: toggle
                                - type: custom:button-card
                                  entity: input_boolean.noel
                                  name: null
                                  show_state: true
                                  template:
                                    - base
                                    - state_appareil
                                  tap_action:
                                    action: toggle
                                - type: custom:button-card
                                  entity: input_boolean.halloween
                                  name: null
                                  show_state: true
                                  template:
                                    - base
                                    - state_appareil
                                  tap_action:
                                    action: toggle
                      - type: custom:button-card
                        entity: group.portes
                        name: Portes
                        label: |
                          [[[
                            return states['sensor.compteur_portes'].state
                          ]]]
                        template:
                          - carte_ronde
                          - state_porte
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Portes et fenêtres
                            card:
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: binary_sensor.porte_entree
                                  name: Entrée
                                  show_last_changed: true
                                  template:
                                    - base
                                    - base_capteur
                                    - state_porte
                                - type: custom:button-card
                                  entity: binary_sensor.porte_salle_a_manger
                                  name: SaM
                                  show_last_changed: true
                                  template:
                                    - base
                                    - base_capteur
                                    - state_porte
                                - type: custom:button-card
                                  entity: binary_sensor.porte_cuisine
                                  name: null
                                  show_last_changed: true
                                  template:
                                    - base
                                    - base_capteur
                                    - state_porte
                                - type: custom:button-card
                                  entity: binary_sensor.porte_chambre_parents
                                  name: null
                                  show_last_changed: true
                                  template:
                                    - base
                                    - base_capteur
                                    - state_porte
                                - type: custom:button-card
                                  entity: binary_sensor.porte_cagibi
                                  name: null
                                  show_last_changed: true
                                  template:
                                    - base
                                    - base_capteur
                                    - state_porte
                                - type: custom:button-card
                                  entity: binary_sensor.porte_garage
                                  name: null
                                  show_last_changed: true
                                  template:
                                    - base
                                    - base_capteur
                                    - state_porte
                              square: false
                              columns: 3
                      - type: custom:button-card
                        entity: group.mouvements
                        name: Mouv
                        label: |
                          [[[
                            return states['sensor.compteur_mouvement'].state
                          ]]]
                        template:
                          - carte_ronde
                          - state_mouv
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Mouvements
                            card:
                              type: vertical-stack
                              cards:
                                - type: custom:button-card
                                  template:
                                    - popup_titre
                                  label: |
                                    [[[ return "Rez-de-chaussée" ]]]
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_salon
                                      name: Salon
                                      show_last_changed: true
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_salle_a_manger
                                      name: SaM
                                      show_last_changed: true
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_couloir
                                      name: Couloir
                                      show_last_changed: true
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_salle_d_eau
                                      name: Lavabo
                                      show_last_changed: true
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_garage
                                      name: Garage
                                      show_last_changed: true
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_escalier
                                      name: Escaliers
                                      show_last_changed: true
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                  square: false
                                  columns: 3
                                - type: custom:button-card
                                  template:
                                    - popup_titre
                                  label: |
                                    [[[ return "Etage" ]]]
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_tom
                                      name: Tom
                                      show_last_changed: true
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_manon
                                      name: Manon
                                      show_last_changed: true
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_leane
                                      name: Léane
                                      show_last_changed: true
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_nina
                                      name: Nina
                                      show_last_changed: true
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_palier
                                      name: Palier
                                      show_last_changed: true
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                  square: false
                                  columns: 3
                      - type: custom:button-card
                        entity: light.tout
                        icon: phu:bulb-group-filament-candle
                        name: Lumières
                        label: |
                          [[[
                            return states['sensor.compteur_lumiere'].state
                          ]]]
                        template:
                          - carte_ronde
                          - state_lumiere
                        double_tap_action:
                          action: more-info
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Lumières
                            card:
                              type: vertical-stack
                              cards:
                                - type: custom:button-card
                                  template:
                                    - bouton_titre_piece
                                  name: |
                                    [[[ return "Ambiances séjour" ]]]
                                  label: |
                                    [[[
                                      return ""]]]
                                - type: grid
                                  square: false
                                  columns: 7
                                  cards:
                                    - type: custom:button-card
                                      entity: light.ambiance_normale
                                      name: Normal
                                      template:
                                        - carte_ronde_no_label
                                      state:
                                        - value: 'on'
                                          styles:
                                            card:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Normale" )
                                                      return "rgba(255,255,0,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            img_cell:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Normale" )
                                                      return "rgba(255,255,0,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            icon:
                                              - color: var(--icon_on)
                                              - color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Normale" )
                                                      return "var(--icon_on)";
                                                    return "var(--icon_off)" ;
                                                  ]]]
                                      tap_action:
                                        action: call-service
                                        service: scene.turn_on
                                        service_data:
                                          entity_id: scene.ambiance_normale
                                    - type: custom:button-card
                                      entity: light.ambiance_normale
                                      name: Doux
                                      icon: mdi:sofa
                                      template:
                                        - carte_ronde_no_label
                                      state:
                                        - value: 'on'
                                          styles:
                                            card:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Doux" )
                                                      return "rgba(186,85,211,0.5)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            img_cell:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Doux" )
                                                      return "rgba(186,85,211,0.5)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            icon:
                                              - color: var(--icon_on)
                                              - color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Doux" )
                                                      return "var(--icon_on)";
                                                    return "var(--icon_off)" ;
                                                  ]]]
                                      tap_action:
                                        action: call-service
                                        service: scene.turn_on
                                        service_data:
                                          entity_id: scene.zen
                                    - type: custom:button-card
                                      entity: light.ambiance_normale
                                      name: Repas
                                      icon: mdi:hamburger
                                      template:
                                        - carte_ronde_no_label
                                      state:
                                        - value: 'on'
                                          styles:
                                            card:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Repas TV" )
                                                      return "rgba(255,0,0,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            img_cell:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Repas TV" )
                                                      return "rgba(255,0,0,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            icon:
                                              - color: var(--icon_on)
                                              - color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Repas TV" )
                                                      return "var(--icon_on)";
                                                    return "var(--icon_off)" ;
                                                  ]]] 
                                      tap_action:
                                        action: call-service
                                        service: script.turn_on
                                        service_data:
                                          entity_id: script.ambiance_repas
                                    - type: custom:button-card
                                      entity: light.ambiance_normale
                                      name: TV
                                      icon: mdi:television-play
                                      template:
                                        - carte_ronde_no_label
                                      state:
                                        - value: 'on'
                                          styles:
                                            card:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "TV" )
                                                      return "rgba(255,0,0,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            img_cell:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "TV" )
                                                      return "rgba(255,0,0,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            icon:
                                              - color: var(--icon_on)
                                              - color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "TV" )
                                                      return "var(--icon_on)";
                                                    return "var(--icon_off)" ;
                                                  ]]]
                                      tap_action:
                                        action: call-service
                                        service: scene.turn_on
                                        service_data:
                                          entity_id: scene.tv
                                    - type: custom:button-card
                                      entity: light.ambiance_normale
                                      name: Apero
                                      icon: mdi:glass-cocktail
                                      template:
                                        - carte_ronde_no_label
                                      state:
                                        - value: 'on'
                                          styles:
                                            card:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Apéro" )
                                                      return "rgba(255,120,120,0.5)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            img_cell:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Apéro" )
                                                      return "rgba(255,120,120,0.5)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            icon:
                                              - color: var(--icon_on)
                                              - color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Apéro" )
                                                      return "var(--icon_on)";
                                                    return "var(--icon_off)" ;
                                                  ]]]
                                      tap_action:
                                        action: call-service
                                        service: script.turn_on
                                        service_data:
                                          entity_id: script.apero_lum
                                    - type: custom:button-card
                                      entity: light.ambiance_normale
                                      name: Anniv
                                      icon: mdi:party-popper
                                      template:
                                        - carte_ronde_no_label
                                      state:
                                        - value: 'on'
                                          styles:
                                            card:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Disco" )
                                                      return "rgba(238,130,238,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            img_cell:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Disco" )
                                                      return "rgba(238,130,238,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            icon:
                                              - color: var(--icon_on)
                                              - color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Disco" )
                                                      return "var(--icon_on)";
                                                    return "var(--icon_off)" ;
                                                  ]]]
                                      tap_action:
                                        action: call-service
                                        service: scene.turn_on
                                        service_data:
                                          entity_id: scene.anniversaire
                                    - type: custom:button-card
                                      entity: light.ambiance_normale
                                      name: Invités
                                      icon: phu:rooms-dining
                                      template:
                                        - carte_ronde_no_label
                                      state:
                                        - value: 'on'
                                          styles:
                                            card:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Repas invités" )
                                                      return "rgba(238,130,238,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            img_cell:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Repas invités" )
                                                      return "rgba(238,130,238,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            icon:
                                              - color: var(--icon_on)
                                              - color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Repas invités" )
                                                      return "var(--icon_on)";
                                                    return "var(--icon_off)" ;
                                                  ]]]
                                      tap_action:
                                        action: call-service
                                        service: script.turn_on
                                        service_data:
                                          entity_id: script.ambiance_repas_invites
                                - type: custom:button-card
                                  template:
                                    - bouton_titre_piece
                                  name: |
                                    [[[ return "Rez-de-chaussée" ]]]
                                  label: |
                                    [[[
                                      if (states['sensor.compteur_pieces_rdc'].state == 0)
                                        return "Tout est éteint" ;
                                      if (states['sensor.compteur_pieces_rdc'].state == 1)
                                        return "💡 " +(states['sensor.compteur_pieces_rdc'].state ) + " pièce" ;
                                      return "💡 " +(states['sensor.compteur_pieces_rdc'].state ) + " pièces";
                                    ]]]
                                - square: false
                                  columns: 3
                                  type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: light.sejour2
                                      template:
                                        - base
                                        - base_capteur
                                        - state_lumiere
                                        - effet
                                      show_last_changed: true
                                      show_label: false
                                      show_state: false
                                      name: Séjour
                                      icon: |
                                        [[[
                                          if (states['sensor.compteur_sejour2'].state == 1 && states['light.lampe_de_bureau'].state == 'on' )
                                            return 'mdi:desk-lamp';
                                            if (states['sensor.compteur_sejour2'].state == 1 && states['light.bandeau_led'].state == 'on' )
                                            return 'phu:light-strip';
                                            if (states['sensor.compteur_sejour2'].state == 1 && states['light.lustre_salon'].state == 'on' )
                                            return 'phu:pendant-round';
                                            if (states['sensor.compteur_sejour2'].state == 1 && states['light.lustre_salle_a_manger'].state == 'on' )
                                            return 'phu:pendant-round';
                                          return 'phu:rooms-living';
                                        ]]]
                                      tap_action:
                                        action: fire-dom-event
                                        browser_mod:
                                          command: popup
                                          title: Séjour
                                          card:
                                            type: vertical-stack
                                            cards:
                                              - type: grid
                                                square: false
                                                columns: 3
                                                cards:
                                                  - type: custom:button-card
                                                    entity: sensor.temp_sejour
                                                    name: Séjour
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_temp
                                                  - type: custom:button-card
                                                    entity: sensor.plante_lum_dracaena
                                                    name: Dracaena
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_luminosite
                                                  - type: custom:button-card
                                                    entity: sensor.plante_lum_pied_elephant
                                                    name: Pied Elephant
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_luminosite
                                                  - type: custom:button-card
                                                    entity: binary_sensor.porte_salle_a_manger
                                                    name: SàM
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_porte
                                                  - type: custom:button-card
                                                    entity: binary_sensor.mouv_salle_a_manger
                                                    name: SàM
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_mouv
                                                  - type: custom:button-card
                                                    entity: binary_sensor.mouv_salon
                                                    name: Salon
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_mouv
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                columns: 3
                                                square: false
                                                cards:
                                                  - type: custom:button-card
                                                    entity: media_player.tv_salon
                                                    name: TV
                                                    icon: mdi:youtube-tv
                                                    show_state: false
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_tv
                                                      - state_unavailable
                                                    label: |
                                                      [[[
                                                        if (states['media_player.tv_salon'].state == "on")
                                                          return (states['sensor.tv_salon_source'].state );
                                                        return "";
                                                      ]]]
                                                    styles:
                                                      label:
                                                        - color: |
                                                            [[[
                                                                if (states['sensor.tv_salon_source'].state == "Netflix")
                                                                  return "red";
                                                                return "var(--text_on)";
                                                              ]]]
                                                    double_tap_action:
                                                      action: call-service
                                                      service: script.tv_salon_on_off
                                                  - type: custom:button-card
                                                    entity: light.lampe_de_bureau
                                                    name: Bureau
                                                    show_state: false
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.lampe_de_bureau
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.lampe_de_bureau
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.lampe_tele_salon
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    name: Lampe TV
                                                    icon: null
                                                  - type: custom:button-card
                                                    entity: light.bandeau_led
                                                    name: Bandeau TV
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.bandeau_led
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.bandeau_led
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.trilampe
                                                    name: null
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.trilampe
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.trilampe
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.lustre_salon
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    name: Lustre salon
                                                    icon: null
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.lustre_salon
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.lustre_salon
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.lustre_salle_a_manger
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    name: Lustre SàM
                                                    icon: null
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.lustre_salle_a_manger
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.lustre_salle_a_manger
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.buffet
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    name: null
                                                    icon: null
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.buffet
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.buffet
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.lampadaire
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    name: null
                                                    icon: null
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.lampadaire
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.lampadaire
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                    - type: custom:button-card
                                      entity: light.entree_2
                                      template:
                                        - base
                                        - base_capteur
                                        - state_lumiere
                                        - effet
                                      show_last_changed: true
                                      show_label: false
                                      show_state: false
                                      name: Entrée
                                      icon: |
                                        [[[
                                            if (states['sensor.compteur_entree'].state == 1 && states['light.aqara_hub_54e1'].state == 'on' )
                                            return 'mdi:alarm-light';
                                          return 'phu:wall-spot';
                                        ]]]
                                      double_tap_action:
                                        action: toggle
                                      tap_action:
                                        action: fire-dom-event
                                        browser_mod:
                                          command: popup
                                          title: Entrée, veilleuse et couloir
                                          card:
                                            type: vertical-stack
                                            cards:
                                              - type: grid
                                                square: false
                                                columns: 3
                                                cards:
                                                  - type: custom:button-card
                                                    entity: sensor.temp_couloir_rdc
                                                    name: null
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_temp
                                                  - type: custom:button-card
                                                    entity: binary_sensor.porte_entree
                                                    name: null
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_porte
                                                  - type: custom:button-card
                                                    entity: binary_sensor.mouv_couloir
                                                    name: Couloir
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_mouv
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                cards:
                                                  - type: custom:button-card
                                                    entity: light.entree
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    name: null
                                                    icon: null
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.entree
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.entree
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.couloir
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    name: null
                                                    icon: null
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.couloir
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.couloir
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.aqara_hub_54e1
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    name: null
                                                    icon: null
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.aqara_hub_54e1
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.aqara_hub_54e1
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                square: false
                                                columns: 3
                                    - type: custom:button-card
                                      entity: light.wc
                                      template:
                                        - base
                                        - base_capteur
                                        - state_lumiere
                                        - effet
                                      show_last_changed: true
                                      show_label: false
                                      show_state: false
                                      name: Lavabo
                                      icon: phu:rooms-toilet
                                      tap_action:
                                        action: fire-dom-event
                                        browser_mod:
                                          command: popup
                                          title: Lavabo WC
                                          card:
                                            type: vertical-stack
                                            cards:
                                              - type: grid
                                                square: false
                                                columns: 3
                                                cards:
                                                  - type: custom:button-card
                                                    entity: binary_sensor.mouv_salle_d_eau
                                                    name: Lavabo
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_mouv
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                square: false
                                                columns: 2
                                                cards:
                                                  - type: custom:button-card
                                                    entity: light.wc_gauche
                                                    name: null
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                  - type: custom:button-card
                                                    entity: light.wc_droit
                                                    name: null
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                    - type: custom:button-card
                                      entity: light.parents
                                      name: Parents
                                      icon: phu:rooms-bedroom
                                      template:
                                        - base
                                        - base_capteur
                                        - state_lumiere
                                        - effet
                                      show_last_changed: true
                                      show_label: false
                                      show_state: false
                                      double_tap_action:
                                        action: toggle
                                      tap_action:
                                        action: fire-dom-event
                                        browser_mod:
                                          command: popup
                                          title: Chambre parentale
                                          card:
                                            type: vertical-stack
                                            cards:
                                              - type: grid
                                                square: false
                                                columns: 6
                                                cards:
                                                  - type: custom:button-card
                                                    entity: scene.chambre_parents_ambiance_normale
                                                    name: Jour
                                                    template:
                                                      - carte_ronde_no_label
                                                    tap_action:
                                                      action: call-service
                                                      service: scene.turn_on
                                                      service_data:
                                                        entity_id: scene.chambre_parents_ambiance_normale
                                                  - type: custom:button-card
                                                    entity: script.ambiance_cine_chevet_parents
                                                    name: TV
                                                    template:
                                                      - carte_ronde_no_label
                                                    tap_action:
                                                      action: call-service
                                                      service: script.turn_on
                                                      service_data:
                                                        entity_id: script.ambiance_cine_chevet_parents
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                cards:
                                                  - type: custom:button-card
                                                    entity: sensor.temp_parents
                                                    name: null
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_temp
                                                  - type: custom:button-card
                                                    entity: binary_sensor.porte_chambre_parents
                                                    name: Fenêtre
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_porte
                                                square: false
                                                columns: 3
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                cards:
                                                  - type: custom:button-card
                                                    entity: switch.tele_des_parents
                                                    icon: mdi:youtube-tv
                                                    name: TV
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_tv
                                                      - state_unavailable
                                                  - type: custom:button-card
                                                    entity: light.lustre_parents
                                                    name: Lustre
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.lustre_parents
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.lustre_parents
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.chevet
                                                    name: Chevet
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.chevet
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.chevet
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                square: false
                                                columns: 3
                                    - type: custom:button-card
                                      entity: light.cagibi
                                      template:
                                        - base
                                        - base_capteur
                                        - state_lumiere
                                        - effet
                                      show_last_changed: true
                                      show_label: false
                                      show_state: false
                                      name: Garage
                                      icon: |
                                        [[[
                                          if (states['binary_sensor.porte_garage'].state == "on")
                                            return "mdi:garage-open-variant";
                                          return "mdi:garage-variant";
                                        ]]]
                                      tap_action:
                                        action: fire-dom-event
                                        browser_mod:
                                          command: popup
                                          title: Garage
                                          card:
                                            type: vertical-stack
                                            cards:
                                              - type: grid
                                                square: false
                                                columns: 3
                                                cards:
                                                  - type: custom:button-card
                                                    entity: binary_sensor.porte_cagibi
                                                    name: null
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_porte
                                                  - type: custom:button-card
                                                    entity: binary_sensor.porte_garage
                                                    name: null
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_porte
                                                  - type: custom:button-card
                                                    entity: binary_sensor.mouv_garage
                                                    name: Mouvements
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_mouv
                                                  - type: custom:button-card
                                                    entity: automation.cagibi_eclairage_off
                                                    name: OFF auto
                                                    icon: mdi:lightbulb-off-outline
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_appareil
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                square: false
                                                columns: 3
                                                cards:
                                                  - type: custom:button-card
                                                    entity: light.cagibi
                                                    name: null
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                    - type: custom:button-card
                                      entity: light.escalier
                                      name: Escalier
                                      icon: mdi:stairs
                                      template:
                                        - base
                                        - base_capteur
                                        - state_lumiere
                                        - effet
                                      show_last_changed: true
                                      show_label: false
                                      show_state: false
                                      double_tap_action:
                                        action: toggle
                                      tap_action:
                                        action: fire-dom-event
                                        browser_mod:
                                          command: popup
                                          title: Escaliers et palier
                                          card:
                                            type: vertical-stack
                                            cards:
                                              - type: grid
                                                cards:
                                                  - type: custom:button-card
                                                    entity: binary_sensor.mouv_escalier
                                                    name: Escalier
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_mouv
                                                  - type: custom:button-card
                                                    entity: binary_sensor.mouv_palier
                                                    name: Palier
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_mouv
                                                  - type: custom:button-card
                                                    entity: sensor.mouv_palier_lum
                                                    name: Luminosité
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_luminosite
                                                  - type: custom:button-card
                                                    entity: automation.palier_allume_sur_mouvement
                                                    name: ON auto
                                                    icon: mdi:lightbulb-on-outline
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_appareil
                                                square: false
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                cards:
                                                  - type: custom:button-card
                                                    entity: light.escaliers
                                                    name: Tout
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.escaliers
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.escaliers
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.escalier
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.escalier
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.escalier
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.palier
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.palier
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.palier
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                square: false
                                                columns: 3
                                    - type: custom:button-card
                                      entity: group.noel
                                      show_last_changed: true
                                      show_label: false
                                      show_state: false
                                      template:
                                        - base
                                        - base_capteur
                                        - state_lumiere
                                        - state_unavailable
                                      name: Noël
                                - type: custom:button-card
                                  template:
                                    - bouton_titre_piece
                                  name: |
                                    [[[ return "Etage" ]]]
                                  label: |
                                    [[[
                                      if (states['sensor.compteur_pieces_etage'].state == 0)
                                        return "Tout est éteint" ;
                                      if (states['sensor.compteur_pieces_etage'].state == 1)
                                        return "💡 " +(states['sensor.compteur_pieces_etage'].state ) + " pièce" ;
                                      return "💡 " +(states['sensor.compteur_pieces_etage'].state ) + " pièces";
                                    ]]]
                                - square: false
                                  columns: 3
                                  type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: light.palier
                                      name: Palier
                                      icon: phu:rooms-attic
                                      template:
                                        - base
                                        - base_capteur
                                        - state_lumiere
                                        - effet
                                      show_last_changed: true
                                      show_label: false
                                      show_state: false
                                      double_tap_action:
                                        action: toggle
                                      tap_action:
                                        action: fire-dom-event
                                        browser_mod:
                                          command: popup
                                          title: Escaliers et palier
                                          card:
                                            type: vertical-stack
                                            cards:
                                              - type: grid
                                                cards:
                                                  - type: custom:button-card
                                                    entity: binary_sensor.mouv_escalier
                                                    name: Escalier
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_mouv
                                                  - type: custom:button-card
                                                    entity: binary_sensor.mouv_palier
                                                    name: Palier
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_mouv
                                                  - type: custom:button-card
                                                    entity: sensor.mouv_palier_lum
                                                    name: Luminosité
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_luminosite
                                                  - type: custom:button-card
                                                    entity: automation.palier_allume_sur_mouvement
                                                    name: ON auto
                                                    icon: mdi:lightbulb-on-outline
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_appareil
                                                square: false
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                cards:
                                                  - type: custom:button-card
                                                    entity: light.escaliers
                                                    name: Tout
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.escaliers
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.escaliers
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.escalier
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.escalier
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.escalier
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.palier
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.palier
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.palier
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                square: false
                                                columns: 3
                                    - type: custom:button-card
                                      entity: light.tom
                                      name: Tom
                                      icon: mdi:bat
                                      template:
                                        - base
                                        - base_capteur
                                        - state_lumiere
                                        - effet
                                      show_last_changed: true
                                      show_label: false
                                      show_state: false
                                      tap_action:
                                        action: fire-dom-event
                                        browser_mod:
                                          command: popup
                                          title: Chambre de Tom
                                          card:
                                            type: vertical-stack
                                            cards:
                                              - type: grid
                                                square: false
                                                columns: 6
                                                cards:
                                                  - type: custom:button-card
                                                    entity: scene.tom_ambiance_normale
                                                    name: Jour
                                                    template:
                                                      - carte_ronde_no_label
                                                    tap_action:
                                                      action: call-service
                                                      service: scene.turn_on
                                                      service_data:
                                                        entity_id: scene.tom_ambiance_normale
                                                  - type: custom:button-card
                                                    entity: scene.tom_ambiance_nuit
                                                    name: Nuit
                                                    template:
                                                      - carte_ronde_no_label
                                                    tap_action:
                                                      action: call-service
                                                      service: scene.turn_on
                                                      service_data:
                                                        entity_id: scene.tom_ambiance_nuit
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                cards:
                                                  - type: custom:button-card
                                                    entity: sensor.temp_tom
                                                    name: null
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_temp
                                                  - type: custom:button-card
                                                    entity: sensor.mouv_tom_luminosite
                                                    name: Luminosité
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_luminosite
                                                  - type: custom:button-card
                                                    entity: binary_sensor.mouv_tom
                                                    name: Mouv
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_mouv
                                                square: false
                                                columns: 3
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                cards:
                                                  - type: custom:button-card
                                                    entity: light.lustre_tom
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    name: null
                                                    icon: null
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.lustre_tom
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.lustre_tom
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.chevet_tom
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    name: null
                                                    icon: null
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.chevet_tom
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.chevet_tom
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.lampe_de_bureau_tom
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    name: null
                                                    icon: null
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.lampe_de_bureau_tom
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.lampe_de_bureau_tom
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: switch.moustique_tom
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_appareil
                                                      - state_unavailable
                                                square: false
                                                columns: 3
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                square: false
                                                columns: 3
                                                cards:
                                                  - type: custom:button-card
                                                    entity: automation.tom_allumage_auto
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_appareil
                                                      - state_unavailable
                                                    name: ON auto
                                                    icon: mdi:lightbulb-on-outline
                                    - type: custom:button-card
                                      entity: light.manon_et_leane
                                      name: Manon Léane
                                      icon: mdi:death-star-variant
                                      template:
                                        - base
                                        - base_capteur
                                        - state_lumiere
                                        - effet
                                      show_last_changed: true
                                      show_label: false
                                      show_state: false
                                      tap_action:
                                        action: fire-dom-event
                                        browser_mod:
                                          command: popup
                                          title: Chambre Manon et Léane
                                          card:
                                            type: vertical-stack
                                            cards:
                                              - type: grid
                                                square: false
                                                columns: 6
                                                cards:
                                                  - type: custom:button-card
                                                    entity: scene.grande_chambre_ambiance_normale
                                                    name: Jour
                                                    template:
                                                      - carte_ronde_no_label
                                                    tap_action:
                                                      action: call-service
                                                      service: scene.turn_on
                                                      service_data:
                                                        entity_id: scene.grande_chambre_ambiance_normale
                                                  - type: custom:button-card
                                                    entity: scene.grande_chambre_ambiance_nuit
                                                    name: Nuit
                                                    template:
                                                      - carte_ronde_no_label
                                                    tap_action:
                                                      action: call-service
                                                      service: scene.turn_on
                                                      service_data:
                                                        entity_id: scene.grande_chambre_ambiance_nuit
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                cards:
                                                  - type: custom:button-card
                                                    entity: sensor.temp_manon
                                                    name: Temp
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_temp
                                                  - type: custom:button-card
                                                    entity: sensor.mouv_manon_luminosite
                                                    name: Luminosité
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_luminosite
                                                  - type: custom:button-card
                                                    entity: binary_sensor.mouv_manon
                                                    name: Manon
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_mouv
                                                  - type: custom:button-card
                                                    entity: binary_sensor.mouv_leane
                                                    name: Léane
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_mouv
                                                square: false
                                                columns: null
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                cards:
                                                  - type: custom:button-card
                                                    entity: light.lustre_manon_et_leane
                                                    name: Lustre
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    icon: null
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.lustre_manon_et_leane
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.lustre_manon_et_leane
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.chevet_manon
                                                    name: Chevet Manon
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.chevet_manon
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.chevet_manon
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: switch.arbre_lumineux
                                                    name: Arbre
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                  - type: custom:button-card
                                                    entity: light.lampe_manon_et_leane
                                                    name: Lampe
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.lampe_manon_et_leane
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.lampe_manon_et_leane
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.chevet_leane
                                                    name: Chevet Lélé
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.chevet_leane
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.chevet_leane
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: switch.moustique_manon
                                                    name: Prise
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_appareil
                                                      - state_unavailable
                                                square: false
                                                columns: 3
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                square: false
                                                columns: 3
                                                cards:
                                                  - type: custom:button-card
                                                    entity: >-
                                                      automation.manon_leane_chambre_allumage_auto
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_appareil
                                                      - state_unavailable
                                                    name: ON auto
                                                    icon: mdi:lightbulb-on-outline
                                    - type: custom:button-card
                                      entity: light.nina
                                      name: Nina
                                      icon: mdi:owl
                                      template:
                                        - base
                                        - base_capteur
                                        - state_lumiere
                                        - effet
                                      show_last_changed: true
                                      show_label: false
                                      show_state: false
                                      tap_action:
                                        action: fire-dom-event
                                        browser_mod:
                                          command: popup
                                          title: Chambre de Nina
                                          card:
                                            type: vertical-stack
                                            cards:
                                              - type: grid
                                                square: false
                                                columns: 6
                                                cards:
                                                  - type: custom:button-card
                                                    entity: scene.nina_ambiance_normale
                                                    name: Jour
                                                    template:
                                                      - carte_ronde_no_label
                                                    tap_action:
                                                      action: call-service
                                                      service: scene.turn_on
                                                      service_data:
                                                        entity_id: scene.nina_ambiance_normale
                                                  - type: custom:button-card
                                                    entity: scene.nina_ambiance_nuit
                                                    name: Nuit
                                                    template:
                                                      - carte_ronde_no_label
                                                    tap_action:
                                                      action: call-service
                                                      service: scene.turn_on
                                                      service_data:
                                                        entity_id: scene.nina_ambiance_nuit
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                cards:
                                                  - type: custom:button-card
                                                    entity: sensor.temp_nina
                                                    name: null
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_temp
                                                  - type: custom:button-card
                                                    entity: sensor.mouv_nina_luminosite
                                                    name: Luminosité
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_luminosite
                                                  - type: custom:button-card
                                                    entity: binary_sensor.mouv_nina
                                                    name: Mouv
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_mouv
                                                square: false
                                                columns: 3
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                cards:
                                                  - type: custom:button-card
                                                    entity: light.lampe_de_bureau_nina
                                                    name: Bureau
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.lampe_de_bureau_nina
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.lampe_de_bureau_nina
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.lustre_nina
                                                    name: Lustre
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.lustre_nina
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.lustre_nina
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: light.chevet_nina
                                                    name: Chevet
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.chevet_nina
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.chevet_nina
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: switch.guirlande_nina
                                                    name: Guirlande
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                  - type: custom:button-card
                                                    entity: light.lampadaire_nina
                                                    name: Lampadaire
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_lumiere
                                                      - state_unavailable
                                                    custom_fields:
                                                      lum:
                                                        card:
                                                          type: conditional
                                                          conditions:
                                                            - entity: light.lampadaire_nina
                                                              state: 'on'
                                                          card:
                                                            type: custom:my-slider
                                                            entity: light.lampadaire_nina
                                                            radius: 5px
                                                            height: 15px
                                                            mainSliderColor: >-
                                                              var(--button-card-light-color-no-temperature)
                                                            thumbHorizontalPadding: 0px
                                                            thumbVerticalPadding: 0px
                                                            thumbWidth: 2px
                                                            minSet: 1
                                                  - type: custom:button-card
                                                    entity: switch.moustique_nina
                                                    name: Moustique
                                                    template:
                                                      - base
                                                      - bouton_lumiere
                                                      - state_appareil
                                                      - state_unavailable
                                                square: false
                                                columns: 3
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: custom:button-card
                                                color_type: blank-card
                                              - type: grid
                                                square: false
                                                columns: 3
                                                cards:
                                                  - type: custom:button-card
                                                    entity: automation.nina_allumage_auto
                                                    template:
                                                      - base
                                                      - base_capteur
                                                      - state_appareil
                                                      - state_unavailable
                                                    name: ON auto
                                                    icon: mdi:lightbulb-on-outline
                      - type: custom:button-card
                        entity: group.autre
                        name: Appareils
                        icon: mdi:home
                        label: |
                          [[[
                            return states['sensor.compteur_autre'].state
                          ]]]
                        template:
                          - carte_ronde
                          - state_appareil
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Autres appareils
                            card:
                              type: vertical-stack
                              cards:
                                - square: false
                                  columns: 7
                                  type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: script.cest_lheure_daller_a_lecole
                                      name: Ecole
                                      template:
                                        - carte_ronde_no_label
                                        - state_appareil
                                      tap_action:
                                        action: toggle
                                    - type: custom:button-card
                                      entity: script.a_table
                                      name: A table
                                      template:
                                        - carte_ronde_no_label
                                        - state_appareil
                                      tap_action:
                                        action: toggle
                                    - type: custom:button-card
                                      entity: script.gouter
                                      name: Goûter
                                      template:
                                        - carte_ronde_no_label
                                        - state_appareil
                                      tap_action:
                                        action: toggle
                                    - type: custom:button-card
                                      entity: script.1590760144160
                                      name: Fin écran
                                      template:
                                        - carte_ronde_no_label
                                        - state_appareil
                                      tap_action:
                                        action: toggle
                                    - type: custom:button-card
                                      entity: script.annonce_au_lit
                                      name: Coucher filles
                                      template:
                                        - carte_ronde_no_label
                                        - state_appareil
                                      tap_action:
                                        action: toggle
                                    - type: custom:button-card
                                      entity: script.tom_va_se_coucher
                                      name: Coucher Tom
                                      template:
                                        - carte_ronde_no_label
                                        - state_appareil
                                      tap_action:
                                        action: toggle
                                    - type: custom:button-card
                                      entity: script.reveille_tom_annonce_alexa
                                      name: Réveiller Tom
                                      template:
                                        - carte_ronde_no_label
                                        - state_appareil
                                      tap_action:
                                        action: toggle
                                - square: false
                                  columns: 2
                                  type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: media_player.tv_salon
                                      triggers_update:
                                        - device_tracker.lgwebostv
                                      name: Salon
                                      show_state: false
                                      icon: |
                                        [[[
                                          if (states['sensor.tv_salon_source'].state == "Netflix")
                                            return "phu:netflix";
                                          if (states['sensor.tv_salon_source'].state == "Prime Video")
                                            return "phu:amazon-logo";
                                          if (states['sensor.tv_salon_source'].state == "DD Externe")
                                            return "mdi:movie-open";
                                          if (states['sensor.tv_salon_source'].state == "YouTube")
                                            return "mdi:youtube";
                                          return "mdi:television";
                                        ]]]
                                      template:
                                        - base
                                        - state_tv
                                        - state_unavailable
                                      label: |
                                        [[[
                                          if (states['media_player.tv_salon'].state == "on")
                                            return (states['sensor.tv_salon_source'].state );
                                          return "";
                                        ]]]
                                      styles:
                                        label:
                                          - color: |
                                              [[[
                                                  if (states['sensor.tv_salon_source'].state == "Netflix")
                                                    return "red";
                                                  if (states['sensor.tv_salon_source'].state == "YouTube")
                                                    return "red";
                                                  return "var(--text_on)";
                                                ]]]
                                      double_tap_action:
                                        action: call-service
                                        service: script.tv_salon_on_off
                                        service_data: null
                                    - type: custom:button-card
                                      entity: switch.tele_des_parents
                                      name: Parents
                                      show_state: false
                                      icon: |
                                        [[[
                                          if (states['sensor.tv_parents_source'].state == "Netflix")
                                            return "phu:netflix";
                                          if (states['sensor.tv_parents_source'].state == "YouTube (FireTV)")
                                            return "mdi:youtube";
                                          if (states['sensor.tv_parents_source'].state == "DD Externe")
                                            return "mdi:movie-open";
                                          return "mdi:television";
                                        ]]]
                                      template:
                                        - base
                                        - state_tv
                                        - state_unavailable
                                      label: |
                                        [[[
                                          if ( entity.state  == 'on')
                                            return (states['sensor.tv_parents_source'].state );
                                          if ( entity.state  == 'off')
                                            return '';
                                          return '';
                                        ]]]
                                      styles:
                                        label:
                                          - color: |
                                              [[[
                                                  if (states['sensor.tv_parents_source'].state == "Netflix")
                                                    return "red";
                                                  return "var(--text_on)";
                                                ]]]
                                      double_tap_action:
                                        action: toggle
                                      tap_action:
                                        action: more-info
                                    - type: custom:button-card
                                      entity: vacuum.wall_e
                                      name: Wall-E
                                      icon: phu:roborock
                                      show_state: false
                                      template:
                                        - base
                                        - state_aspi
                                        - state_unavailable
                                      label: >
                                        [[[ return
                                        states['sensor.walle_state'].state;  ]]]
                                      styles:
                                        label:
                                          - color: |
                                              [[[
                                                if (states['sensor.walle_state'].state == "Nettoyage")
                                                  return 'var(--text_on)';
                                                if (states['sensor.walle_state'].state == "Retour")
                                                  return 'firebrick';
                                                if (states['sensor.walle_state'].state == "️ERREUR")
                                                  return "firebrick";
                                                if (states['sensor.walle_state'].state == "En pause")
                                                  return 'firebrick';
                                                if (states['sensor.walle_state'].state == "En charge")
                                                  return 'grey';
                                              ]]]
                                    - type: custom:button-card
                                      entity: vacuum.r2d2
                                      name: R2D2
                                      icon: phu:roborock
                                      show_state: false
                                      template:
                                        - base
                                        - state_aspi
                                        - state_unavailable
                                      label: >
                                        [[[ return
                                        states['sensor.r2d2_state'].state;  ]]]
                                      styles:
                                        label:
                                          - color: |
                                              [[[
                                                if (states['sensor.r2d2_state'].state == "Nettoyage")
                                                  return 'black';
                                                if (states['sensor.r2d2_state'].state == "Retour")
                                                  return 'firebrick';
                                                if (states['sensor.r2d2_state'].state == "️ERREUR")
                                                  return "firebrick";
                                                if (states['sensor.r2d2_state'].state == "En pause")
                                                  return 'firebrick';
                                                if (states['sensor.r2d2_state'].state == "Charge")
                                                  return 'grey';
                                              ]]]
                                    - type: custom:button-card
                                      entity: switch.lave_vaisselle_power
                                      name: Vaisselle
                                      icon: mdi:dishwasher
                                      show_state: false
                                      template:
                                        - base
                                        - state_machine
                                        - state_unavailable
                                      label: |
                                        [[[
                                          if (states['switch.lave_vaisselle_power'].state == "on")
                                            return states['sensor.lave_vaisselle2'].state +  " (" + states['sensor.lave_vaisselle_program_progress'].state + "%)";
                                          if (states['switch.lave_vaisselle_power'].state == "off")
                                            return "";
                                          return "" ;
                                        ]]]
                                      tap_action:
                                        action: more-info
                                      double_tap_action:
                                        action: toggle
                                    - type: custom:button-card
                                      entity: input_boolean.lave_linge
                                      name: Linge
                                      icon: mdi:tshirt-crew
                                      show_state: false
                                      template:
                                        - base
                                        - state_machine
                                        - state_unavailable
                                      label: |
                                        [[[
                                          if (states['input_boolean.lave_linge'].state == "off")
                                            return "";
                                          if (states['input_boolean.lave_linge'].state == "on")
                                            return states['sensor.lave_linge2'].state;

                                        ]]]
                                      styles:
                                        - color: |
                                            [[[
                                              if (states['input_boolean.lave_linge'].state == "on")
                                                return "var(--text_on)";
                                              if (states['input_boolean.lave_linge'].state == "unavailable")
                                                return "red";
                                              return "grey" ;
                                            ]]]
                                      tap_action:
                                        action: more-info
                                      double_tap_action:
                                        action: toggle
                                    - type: custom:button-card
                                      entity: switch.radiateur
                                      name: Chauffage SDB
                                      icon: null
                                      show_state: false
                                      template:
                                        - base
                                        - state_lumiere
                                        - state_unavailable
                                      label: >
                                        [[[ return
                                        states['sensor.temp_salle_de_bain'].state; 
                                        ]]]
                                    - type: custom:button-card
                                      entity: group.moustique_prises
                                      name: Moustique
                                      icon: null
                                      show_state: false
                                      template:
                                        - base
                                        - state_appareil
                                        - state_unavailable
                                      label: >
                                        [[[ return
                                        states['sensor.compteur_moustique'].state; 
                                        ]]]
                                    - type: custom:button-card
                                      entity: input_boolean.imprimante
                                      name: null
                                      icon: null
                                      show_state: false
                                      template:
                                        - base
                                        - state_imprimante
                                        - state_unavailable
                                      label: |
                                        [[[
                                          if ( states['input_boolean.imprimante'].state  == 'on')
                                            return (states['sensor.canon_mg4100_series_black'].state+"% / "+states['sensor.canon_mg4100_series_color'].state+"%" );
                                          if ( entity.state  == 'off')
                                            return '';
                                          return '';
                                        ]]]
                                    - type: custom:button-card
                                      entity: sensor.musique3
                                      name: Musique
                                      icon: mdi:speaker
                                      show_state: false
                                      template:
                                        - base
                                        - state_musique
                                        - state_unavailable
                                      tap_action:
                                        action: fire-dom-event
                                        browser_mod:
                                          command: popup
                                          title: Musique
                                          card:
                                            type: grid
                                            square: false
                                            columns: 2
                                            cards:
                                              - type: custom:button-card
                                                entity: media_player.partout
                                                name: null
                                                template:
                                                  - petite_carte_media
                                                  - state_musique
                                                  - state_unavailable
                                              - type: custom:button-card
                                                entity: media_player.sejour
                                                template:
                                                  - petite_carte_media
                                                  - state_musique
                                                  - state_unavailable
                                              - type: custom:button-card
                                                entity: media_player.la_cuisine
                                                name: Cuisine
                                                template:
                                                  - petite_carte_media
                                                  - state_musique
                                                  - state_unavailable
                                              - type: custom:button-card
                                                entity: media_player.la_salle_de_bain
                                                name: S. de bain
                                                template:
                                                  - petite_carte_media
                                                  - state_musique
                                                  - state_unavailable
                                              - type: custom:button-card
                                                entity: media_player.tom
                                                name: null
                                                template:
                                                  - petite_carte_media
                                                  - state_musique
                                                  - state_unavailable
                                              - type: custom:button-card
                                                entity: media_player.chambre_de_manon_et_leane
                                                name: Manon & Lélé
                                                template:
                                                  - petite_carte_media
                                                  - state_musique
                                                  - state_unavailable
                                              - type: custom:button-card
                                                entity: media_player.nina
                                                name: null
                                                template:
                                                  - petite_carte_media
                                                  - state_musique
                                                  - state_unavailable
                                              - type: custom:button-card
                                                entity: media_player.chambre_parents
                                                name: Parents
                                                template:
                                                  - petite_carte_media
                                                  - state_musique
                                                  - state_unavailable
                                              - type: custom:button-card
                                                entity: media_player.en_bas
                                                name: RDC
                                                template:
                                                  - petite_carte_media
                                                  - state_musique
                                                  - state_unavailable
                                              - type: custom:button-card
                                                entity: media_player.etage
                                                name: null
                                                template:
                                                  - petite_carte_media
                                                  - state_musique
                                                  - state_unavailable
                                - type: conditional
                                  conditions:
                                    - entity: sensor.musique3
                                      state: playing
                                  card:
                                    type: grid
                                    cards:
                                      - type: conditional
                                        conditions:
                                          - entity: media_player.partout
                                            state: playing
                                        card:
                                          info: scroll
                                          artwork: material
                                          hide:
                                            volume: false
                                            source: true
                                            power: false
                                            name: false
                                            icon: true
                                            controls: false
                                          type: custom:mini-media-player
                                          entity: media_player.partout
                                      - type: conditional
                                        conditions:
                                          - entity: media_player.sejour
                                            state: playing
                                        card:
                                          info: scroll
                                          artwork: material
                                          hide:
                                            volume: false
                                            source: true
                                            power: false
                                            name: false
                                            icon: true
                                            controls: false
                                          type: custom:mini-media-player
                                          entity: media_player.sejour
                                      - type: conditional
                                        conditions:
                                          - entity: media_player.la_cuisine
                                            state: playing
                                        card:
                                          info: scroll
                                          artwork: material
                                          hide:
                                            volume: false
                                            source: true
                                            power: false
                                            name: false
                                            icon: true
                                            controls: false
                                          type: custom:mini-media-player
                                          entity: media_player.la_cuisine
                                      - type: conditional
                                        conditions:
                                          - entity: media_player.en_bas
                                            state: playing
                                        card:
                                          info: scroll
                                          artwork: material
                                          hide:
                                            volume: false
                                            source: true
                                            power: false
                                            name: false
                                            icon: true
                                            controls: false
                                          type: custom:mini-media-player
                                          entity: media_player.en_bas
                                      - type: conditional
                                        conditions:
                                          - entity: media_player.la_salle_de_bain
                                            state: playing
                                          - entity: media_player.partout
                                            state_not: playing
                                          - entity: media_player.etage
                                            state_not: playing
                                        card:
                                          info: scroll
                                          artwork: material
                                          hide:
                                            volume: false
                                            source: true
                                            power: false
                                            name: false
                                            icon: true
                                            controls: false
                                          type: custom:mini-media-player
                                          entity: media_player.la_salle_de_bain
                                      - type: conditional
                                        conditions:
                                          - entity: media_player.leane
                                            state: playing
                                          - entity: media_player.partout
                                            state_not: playing
                                          - entity: media_player.etage
                                            state_not: playing
                                          - entity: media_player.chambre_de_manon_et_leane
                                            state_not: playing
                                        card:
                                          info: scroll
                                          artwork: material
                                          hide:
                                            volume: false
                                            source: true
                                            power: false
                                            name: false
                                            icon: true
                                            controls: false
                                          type: custom:mini-media-player
                                          entity: media_player.leane
                                      - type: conditional
                                        conditions:
                                          - entity: media_player.tom
                                            state: playing
                                          - entity: media_player.partout
                                            state_not: playing
                                          - entity: media_player.etage
                                            state_not: playing
                                        card:
                                          info: scroll
                                          artwork: material
                                          hide:
                                            volume: false
                                            source: true
                                            power: false
                                            name: false
                                            icon: true
                                            controls: false
                                          type: custom:mini-media-player
                                          entity: media_player.tom
                                      - type: conditional
                                        conditions:
                                          - entity: media_player.nina
                                            state: playing
                                          - entity: media_player.partout
                                            state_not: playing
                                          - entity: media_player.etage
                                            state_not: playing
                                        card:
                                          info: scroll
                                          artwork: material
                                          hide:
                                            volume: false
                                            source: true
                                            power: false
                                            name: false
                                            icon: true
                                            controls: false
                                          type: custom:mini-media-player
                                          entity: media_player.nina
                                      - type: conditional
                                        conditions:
                                          - entity: media_player.manon
                                            state: playing
                                          - entity: media_player.partout
                                            state_not: playing
                                          - entity: media_player.etage
                                            state_not: playing
                                          - entity: media_player.chambre_de_manon_et_leane
                                            state_not: playing
                                        card:
                                          info: scroll
                                          artwork: material
                                          hide:
                                            volume: false
                                            source: true
                                            power: false
                                            name: false
                                            icon: true
                                            controls: false
                                          type: custom:mini-media-player
                                          entity: media_player.manon
                                      - type: conditional
                                        conditions:
                                          - entity: media_player.etage
                                            state: playing
                                          - entity: media_player.partout
                                            state_not: playing
                                        card:
                                          info: scroll
                                          artwork: material
                                          hide:
                                            volume: false
                                            source: true
                                            power: false
                                            name: false
                                            icon: true
                                            controls: false
                                          type: custom:mini-media-player
                                          entity: media_player.etage
                                      - type: conditional
                                        conditions:
                                          - entity: media_player.chambre_de_manon_et_leane
                                            state: playing
                                          - entity: media_player.partout
                                            state_not: playing
                                        card:
                                          info: scroll
                                          artwork: material
                                          hide:
                                            volume: false
                                            source: true
                                            power: false
                                            name: false
                                            icon: true
                                            controls: false
                                          type: custom:mini-media-player
                                          entity: media_player.chambre_de_manon_et_leane
                                    columns: 1
                                    square: false
                      - type: custom:button-card
                        entity: switch.adguard_protection
                        name: AdGuard
                        icon: |
                          [[[
                            if (entity.state == "off" )
                              return "mdi:shield-off";
                            if (entity.state == "on" )
                              return "mdi:shield-lock";
                          ]]]
                        template:
                          - carte_ronde_no_label
                          - state_alarme
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: AdGuard
                            card:
                              square: false
                              columns: 3
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: switch.adguard_protection
                                  name: Protection
                                  template:
                                    - base
                                    - base_capteur
                                    - state_alarme
                                  tap_action:
                                    action: toggle
                                - type: custom:button-card
                                  entity: switch.adguard_parental_control
                                  name: Ctl parental
                                  template:
                                    - base
                                    - base_capteur
                                    - state_alarme
                                  tap_action:
                                    action: toggle
                                - type: custom:button-card
                                  entity: switch.adguard_filtering
                                  name: Filtres
                                  template:
                                    - base
                                    - base_capteur
                                    - state_alarme
                                  tap_action:
                                    action: toggle
                                - type: custom:button-card
                                  entity: switch.adguard_safe_browsing
                                  name: Navigation sécurisée
                                  template:
                                    - base
                                    - base_capteur
                                    - state_alarme
                                  tap_action:
                                    action: toggle
                                - type: custom:button-card
                                  entity: switch.adguard_safe_search
                                  name: Recherche sécurisée
                                  template:
                                    - base
                                    - base_capteur
                                    - state_alarme
                                  tap_action:
                                    action: toggle
                                - type: custom:button-card
                                  entity: update.adguard_home_update
                                  name: Mise à jour disponible
                                  template:
                                    - base
                                    - base_capteur
                                    - state_appareil
                  - type: horizontal-stack
                    cards:
                      - type: conditional
                        conditions:
                          - entity: sensor.le_bureau_next_timer
                            state_not: unavailable
                        card:
                          type: custom:button-card
                          entity: sensor.minuteur_bureau
                          name: ⏳ Bureau
                          template:
                            - bouton_minuteur
                          label: >
                            [[[ return 
                            (states['sensor.minuteur_bureau_info'].state ) ]]]
                      - type: conditional
                        conditions:
                          - entity: sensor.la_cuisine_next_timer
                            state_not: unavailable
                        card:
                          type: custom:button-card
                          entity: sensor.minuteur_cuisine
                          name: ⏳ Cuisine
                          template:
                            - bouton_minuteur
                      - type: conditional
                        conditions:
                          - entity: sensor.le_salon_next_timer
                            state_not: unavailable
                        card:
                          type: custom:button-card
                          entity: sensor.minuteur_salon
                          name: ⏳ Salon
                          template:
                            - bouton_minuteur
                      - type: conditional
                        conditions:
                          - entity: sensor.aurel_s_fire_tv_cube_next_timer
                            state_not: unavailable
                        card:
                          type: custom:button-card
                          entity: sensor.minuteur_fire_tv
                          name: ⏳ Fire TV
                          template:
                            - bouton_minuteur
                      - type: conditional
                        conditions:
                          - entity: sensor.la_salle_de_bain_next_timer
                            state_not: unavailable
                        card:
                          type: custom:button-card
                          entity: sensor.minuteur_sdb
                          name: ⏳ SDB
                          template:
                            - bouton_minuteur
                      - type: conditional
                        conditions:
                          - entity: sensor.papa_next_timer
                            state_not: unavailable
                        card:
                          type: custom:button-card
                          entity: sensor.minuteur_aurel
                          name: ⏳ Aurel
                          template:
                            - bouton_minuteur
                      - type: conditional
                        conditions:
                          - entity: sensor.maman_next_timer
                            state_not: unavailable
                        card:
                          type: custom:button-card
                          entity: sensor.minuteur_alex
                          name: ⏳ Alex
                          template:
                            - bouton_minuteur
                      - type: conditional
                        conditions:
                          - entity: sensor.tom_next_timer
                            state_not: unavailable
                        card:
                          type: custom:button-card
                          entity: sensor.minuteur_tom
                          name: ⏳ Tom
                          template:
                            - bouton_minuteur
                      - type: conditional
                        conditions:
                          - entity: sensor.nina_next_timer
                            state_not: unavailable
                        card:
                          type: custom:button-card
                          entity: sensor.minuteur_nina
                          name: ⏳ Nina
                          template:
                            - bouton_minuteur
                      - type: conditional
                        conditions:
                          - entity: sensor.leane_next_timer
                            state_not: unavailable
                        card:
                          type: custom:button-card
                          entity: sensor.minuteur_leane
                          name: ⏳ Léane
                          template:
                            - bouton_minuteur
                      - type: conditional
                        conditions:
                          - entity: sensor.manon_next_timer
                            state_not: unavailable
                        card:
                          type: custom:button-card
                          entity: sensor.minuteur_manon
                          name: ⏳ Manon
                          template:
                            - bouton_minuteur
                  - type: conditional
                    conditions:
                      - entity: alarm_control_panel.aarlo_sonnette
                        state: armed_away
                    card:
                      entity: camera.aarlo_sonnette
                      aspect_ratio: square
                      card_size: 3
                      hide:
                        - title
                        - date
                      image_click: play
                      show:
                        - motion
                        - sound
                        - image_date
                        - signal_strength
                        - captured_today
                        - image_date
                        - on_off
                        - snapshot
                        - battery_level
                      top_date: true
                      top_status: false
                      top_title: false
                      type: custom:aarlo-glance
                  - type: conditional
                    conditions:
                      - entity: binary_sensor.aarlo_ding_sonnette
                        state: 'on'
                    card:
                      entity: camera.aarlo_sonnette
                      hide:
                        - title
                        - date
                      image_click: play
                      show:
                        - motion
                        - sound
                        - image_date
                        - signal_strength
                        - captured_today
                        - image_date
                      top_date: true
                      top_status: false
                      top_title: false
                      type: custom:aarlo-glance
                  - type: custom:button-card
                    template:
                      - sidebar
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        command: popup
                        title: Météo
                        card:
                          type: vertical-stack
                          cards:
                            - type: custom:meteofrance-weather-card
                              entity: weather.ta_ville
                              number_of_forecasts: '5'
                              cloudCoverEntity: sensor.ta_ville_cloud_cover
                              rainChanceEntity: sensor.ta_ville_rain_chance_2
                              uvEntity: sensor.ta_ville_uv_2
                              freezeChanceEntity: sensor.ta_ville_freeze_chance_2
                              snowChanceEntity: sensor.ta_ville_snow_chance_2
                              alertEntity: sensor.49_weather_alert
                              rainForecastEntity: sensor.ta_ville_next_rain_2
                              style: |
                                ha-card {
                                  font-size: 80%;
                                  background: var(--my_color2);
                                  --ha-card-background: none !important;
                                  font-family: Avenir;
                                  border-color: rgba(152, 167, 185, 0.2) ;
                                  border-style: outset ;
                                  border-width: 1px ;
                                  box-shadow: 1px 1px 5px 0px rgb(12, 12, 14)

                                }
                              name: null
                              alert_forecast: false
                              details: false
                              one_hour_forecast: true
                              forecast: false
                            - square: false
                              columns: 2
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: sensor.weather_leve_soleil
                                  name: Levé du soleil
                                  icon: mdi:weather-sunset-up
                                  show_state: true
                                  template:
                                    - base
                                - type: custom:button-card
                                  entity: sensor.weather_couche_soleil
                                  name: Couché du soleil
                                  icon: mdi:weather-sunset-down
                                  show_state: true
                                  template:
                                    - base
                            - square: false
                              columns: 6
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: sensor.weather_conditions_ciel
                                  name: Nuages
                                  units: '%'
                                  show_state: true
                                  icon: mdi:weather-cloudy
                                  template:
                                    - carte_ronde
                                  state:
                                    - value: 40
                                      operator: '>'
                                      styles:
                                        img_cell:
                                          - background-color: tomato
                                        icon:
                                          - color: var(--icon_on)
                                          - transition: 1s ease
                                        state:
                                          - font-weight: bold
                                - type: custom:button-card
                                  entity: sensor.weather_vent
                                  name: Vent
                                  show_state: true
                                  icon: mdi:weather-windy
                                  template:
                                    - carte_ronde
                                  state:
                                    - value: 40
                                      operator: '>'
                                      styles:
                                        img_cell:
                                          - background-color: tomato
                                        icon:
                                          - color: var(--icon_on)
                                          - transition: 1s ease
                                        state:
                                          - font-weight: bold
                                - type: custom:button-card
                                  entity: sensor.weather_conditions_pluie
                                  name: Pluie
                                  units: '%'
                                  show_state: true
                                  icon: mdi:weather-rainy
                                  template:
                                    - carte_ronde
                                  state:
                                    - value: 40
                                      operator: '>'
                                      styles:
                                        img_cell:
                                          - background-color: tomato
                                        icon:
                                          - color: var(--icon_on)
                                          - transition: 1s ease
                                        state:
                                          - font-weight: bold
                                - type: custom:button-card
                                  entity: sensor.weather_conditions_uv
                                  name: UV
                                  show_state: true
                                  icon: mdi:weather-sunny
                                  template:
                                    - carte_ronde
                                  state:
                                    - value: 6
                                      operator: '>'
                                      styles:
                                        img_cell:
                                          - background-color: tomato
                                        icon:
                                          - color: var(--icon_on)
                                          - transition: 1s ease
                                        state:
                                          - font-weight: bold
                                - type: custom:button-card
                                  entity: sensor.weather_conditions_neige
                                  name: Neige
                                  units: '%'
                                  show_state: true
                                  icon: mdi:weather-snowy-heavy
                                  template:
                                    - carte_ronde
                                  state:
                                    - value: 40
                                      operator: '>'
                                      styles:
                                        img_cell:
                                          - background-color: tomato
                                        icon:
                                          - color: var(--icon_on)
                                          - transition: 1s ease
                                        state:
                                          - font-weight: bold
                                - type: custom:button-card
                                  entity: sensor.weather_alerte_couleur_v2
                                  name: Alerte
                                  units: '%'
                                  show_name: true
                                  show_state: false
                                  icon: mdi:alert
                                  template:
                                    - carte_ronde_no_label
                                  state:
                                    - value: Vigilance Jaune
                                      styles:
                                        img_cell:
                                          - background-color: yellow
                                        icon:
                                          - color: var(--icon_on)
                                          - transition: 1s ease
                                        state:
                                          - font-weight: bold
                                    - value: Vigilance Orange
                                      styles:
                                        img_cell:
                                          - background-color: orange
                                        icon:
                                          - color: var(--icon_on)
                                          - transition: 1s ease
                                        state:
                                          - font-weight: bold
                                    - value: Vigilance Rouge
                                      styles:
                                        img_cell:
                                          - background-color: red
                                        icon:
                                          - color: var(--icon_on)
                                          - transition: 1s ease
                                        state:
                                          - font-weight: bold
                            - type: conditional
                              conditions:
                                - entity: sensor.49_weather_alert
                                  state_not: Vert
                              card:
                                type: custom:mushroom-entity-card
                                entity: sensor.weather_alerte
                                fill_container: false
                                layout: vertical
                                secondary_info: last-updated
                                primary_info: state
                                hide_icon: true
                            - type: custom:meteofrance-weather-card
                              entity: weather.ta_ville
                              number_of_forecasts: '5'
                              cloudCoverEntity: sensor.ta_ville_cloud_cover
                              rainChanceEntity: sensor.ta_ville_rain_chance_2
                              uvEntity: sensor.ta_ville_uv_2
                              freezeChanceEntity: sensor.ta_ville_freeze_chance_2
                              snowChanceEntity: sensor.ta_ville_snow_chance_2
                              alertEntity: sensor.49_weather_alert
                              rainForecastEntity: sensor.ta_ville_next_rain_2
                              style: |
                                ha-card {
                                  font-size: 80%;
                                  background: var(--my_color2);
                                  --ha-card-background: none !important;
                                  font-family: Avenir;
                                  border-color: rgba(152, 167, 185, 0.2) ;
                                  border-style: outset ;
                                  border-width: 1px ;
                                  box-shadow: 1px 1px 5px 0px rgb(12, 12, 14)

                                }
                              name: null
                              alert_forecast: false
                              details: false
                              current: false
                              one_hour_forecast: false
            type: vertical-stack
        layout:
          width: 280
      - type: custom:layout-card
        layout_type: masonry
        cards:
          - type: vertical-stack
            cards:
              - cards:
                  - type: custom:button-card
                    template:
                      - bouton_titre_piece
                    name: |
                      [[[ return "Rez-de-chaussée" ]]]
                    label: |
                      [[[
                        if (states['sensor.compteur_pieces_rdc'].state == 0)
                          return "Tout est éteint" ;
                        if (states['sensor.compteur_pieces_rdc'].state == 1)
                          return "💡 " +(states['sensor.compteur_pieces_rdc'].state ) + " pièce" ;
                        return "💡 " +(states['sensor.compteur_pieces_rdc'].state ) + " pièces";
                      ]]]
                  - type: grid
                    cards:
                      - type: custom:button-card
                        entity: light.sejour2
                        template:
                          - base
                          - bouton_piece
                          - bouton_piece_graph
                          - state_lumiere
                          - effet
                        name: Séjour
                        icon: |
                          [[[
                            if (states['sensor.compteur_sejour2'].state == 1 && states['light.lampe_de_bureau'].state == 'on' )
                              return 'mdi:desk-lamp';
                              if (states['sensor.compteur_sejour2'].state == 1 && states['light.bandeau_led'].state == 'on' )
                              return 'phu:light-strip';
                              if (states['sensor.compteur_sejour2'].state == 1 && states['light.lustre_salon'].state == 'on' )
                              return 'phu:pendant-round';
                              if (states['sensor.compteur_sejour2'].state == 1 && states['light.lustre_salle_a_manger'].state == 'on' )
                              return 'phu:pendant-round';
                            return 'phu:rooms-living';
                          ]]]
                        label: |
                          [[[
                            if (entity.state == 'on' )
                              return (states['sensor.temp_sejour'].state )+"°"  + " / " + Math.round(entity.attributes.brightness / 2.54) + "%";
                            return (states['sensor.temp_sejour'].state ) + "° / "+(states['sensor.hum_sejour'].state ) + "%";
                          ]]]
                        styles:
                          label:
                            - color: |
                                [[[
                                  if (states['sensor.temp_sejour'].state < 19)
                                    return 'dodgerblue';
                                  if (states['sensor.temp_sejour'].state > 25)
                                    return 'red';
                                    return 'var(--text_on)';
                                ]]]
                          custom_fields:
                            notification:
                              - background-color: |
                                  [[[
                                    if (states['sensor.compteur_sejour2'].state == 0)
                                      return 'rgba(0,191,205,0)';
                                   return 'rgba(0,0,0,0.4)';
                                  ]]]
                              - color: |
                                  [[[
                                    if (states['sensor.compteur_sejour2'].state == 0)
                                      return 'rgba(0,191,205,0)';
                                   return 'var(--text_on)';
                                  ]]]
                        custom_fields:
                          notification: >
                            [[[ return
                            Math.floor(states['sensor.compteur_sejour2'].state )
                            ]]]
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.sejour2
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.sejour2
                                radius: 5px
                                height: 25px
                                width: 100%
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                secondarySliderColor: darkslategrey
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                minSet: 1
                                thumbWidth: 1px
                                thumbColor: var(--text_on)
                          graph:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.sejour2
                                  state: 'off'
                              card:
                                type: custom:mini-graph-card
                                entities:
                                  - color: var(--graph_line)
                                    entity: sensor.temp_sejour
                          mouv:
                            card:
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: group.mouvements_sejour
                                  template:
                                    - bouton_piece_capteur
                              columns: 1
                              square: false
                          porte:
                            card:
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: binary_sensor.porte_salle_a_manger
                                  template:
                                    - bouton_piece_capteur
                              columns: 1
                              square: false
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Séjour
                            card:
                              type: vertical-stack
                              cards:
                                - type: grid
                                  square: false
                                  columns: 6
                                  cards:
                                    - type: custom:button-card
                                      entity: light.ambiance_normale
                                      name: Normal
                                      template:
                                        - carte_ronde_no_label
                                      state:
                                        - value: 'on'
                                          styles:
                                            card:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Normale" )
                                                      return "rgba(255,255,0,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            img_cell:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Normale" )
                                                      return "rgba(255,255,0,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            icon:
                                              - color: var(--icon_on)
                                              - color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Normale" )
                                                      return "var(--icon_on)";
                                                    return "var(--icon_off)" ;
                                                  ]]]
                                      tap_action:
                                        action: call-service
                                        service: scene.turn_on
                                        service_data:
                                          entity_id: scene.ambiance_normale
                                    - type: custom:button-card
                                      entity: light.ambiance_normale
                                      name: Doux
                                      icon: mdi:sofa
                                      template:
                                        - carte_ronde_no_label
                                      state:
                                        - value: 'on'
                                          styles:
                                            card:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Doux" )
                                                      return "rgba(186,85,211,0.5)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            img_cell:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Doux" )
                                                      return "rgba(186,85,211,0.5)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            icon:
                                              - color: var(--icon_on)
                                              - color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Doux" )
                                                      return "var(--icon_on)";
                                                    return "var(--icon_off)" ;
                                                  ]]]
                                      tap_action:
                                        action: call-service
                                        service: scene.turn_on
                                        service_data:
                                          entity_id: scene.zen
                                    - type: custom:button-card
                                      entity: light.ambiance_normale
                                      name: Repas
                                      icon: mdi:hamburger
                                      template:
                                        - carte_ronde_no_label
                                      state:
                                        - value: 'on'
                                          styles:
                                            card:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Repas TV" )
                                                      return "rgba(255,0,0,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            img_cell:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Repas TV" )
                                                      return "rgba(255,0,0,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            icon:
                                              - color: var(--icon_on)
                                              - color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Repas TV" )
                                                      return "var(--icon_on)";
                                                    return "var(--icon_off)" ;
                                                  ]]] 
                                      tap_action:
                                        action: call-service
                                        service: script.turn_on
                                        service_data:
                                          entity_id: script.ambiance_repas
                                    - type: custom:button-card
                                      entity: light.ambiance_normale
                                      name: TV
                                      icon: mdi:television-play
                                      template:
                                        - carte_ronde_no_label
                                      state:
                                        - value: 'on'
                                          styles:
                                            card:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "TV" )
                                                      return "rgba(255,0,0,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            img_cell:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "TV" )
                                                      return "rgba(255,0,0,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            icon:
                                              - color: var(--icon_on)
                                              - color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "TV" )
                                                      return "var(--icon_on)";
                                                    return "var(--icon_off)" ;
                                                  ]]]
                                      tap_action:
                                        action: call-service
                                        service: scene.turn_on
                                        service_data:
                                          entity_id: scene.tv
                                    - type: custom:button-card
                                      entity: light.ambiance_normale
                                      name: Apero
                                      icon: mdi:glass-cocktail
                                      template:
                                        - carte_ronde_no_label
                                      state:
                                        - value: 'on'
                                          styles:
                                            card:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Apéro" )
                                                      return "rgba(255,120,120,0.5)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            img_cell:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Apéro" )
                                                      return "rgba(255,120,120,0.5)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            icon:
                                              - color: var(--icon_on)
                                              - color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Apéro" )
                                                      return "var(--icon_on)";
                                                    return "var(--icon_off)" ;
                                                  ]]]
                                      tap_action:
                                        action: call-service
                                        service: script.turn_on
                                        service_data:
                                          entity_id: script.apero_lum
                                    - type: custom:button-card
                                      entity: light.ambiance_normale
                                      name: Anniv
                                      icon: mdi:party-popper
                                      template:
                                        - carte_ronde_no_label
                                      state:
                                        - value: 'on'
                                          styles:
                                            card:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Disco" )
                                                      return "rgba(238,130,238,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            img_cell:
                                              - background-color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Disco" )
                                                      return "rgba(238,130,238,0.7)";
                                                    return "var(--pastille_off)" ;
                                                  ]]]
                                            icon:
                                              - color: var(--icon_on)
                                              - color: |
                                                  [[[
                                                    if (states['sensor.ambiances_sejour'].state == "Disco" )
                                                      return "var(--icon_on)";
                                                    return "var(--icon_off)" ;
                                                  ]]]
                                      tap_action:
                                        action: call-service
                                        service: scene.turn_on
                                        service_data:
                                          entity_id: scene.anniversaire
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  square: false
                                  columns: 3
                                  cards:
                                    - type: custom:button-card
                                      entity: sensor.temp_sejour
                                      name: Séjour
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp
                                    - type: custom:button-card
                                      entity: sensor.plante_lum_dracaena
                                      name: Dracaena
                                      template:
                                        - base
                                        - base_capteur
                                        - state_luminosite
                                    - type: custom:button-card
                                      entity: sensor.plante_lum_pied_elephant
                                      name: Pied Elephant
                                      template:
                                        - base
                                        - base_capteur
                                        - state_luminosite
                                    - type: custom:button-card
                                      entity: binary_sensor.porte_salle_a_manger
                                      name: SàM
                                      template:
                                        - base
                                        - base_capteur
                                        - state_porte
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_salle_a_manger
                                      name: SàM
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_salon
                                      name: Salon
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  columns: 3
                                  square: false
                                  cards:
                                    - type: custom:button-card
                                      entity: media_player.tv_salon
                                      name: TV
                                      icon: mdi:youtube-tv
                                      show_state: false
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_tv
                                        - state_unavailable
                                      label: |
                                        [[[
                                          if (states['media_player.tv_salon'].state == "on")
                                            return (states['sensor.tv_salon_source'].state );
                                          return "";
                                        ]]]
                                      styles:
                                        label:
                                          - color: |
                                              [[[
                                                  if (states['sensor.tv_salon_source'].state == "Netflix")
                                                    return "red";
                                                  return "var(--text_on)";
                                                ]]]
                                      double_tap_action:
                                        action: call-service
                                        service: script.tv_salon_on_off
                                    - type: custom:button-card
                                      entity: light.lampe_de_bureau
                                      name: Bureau
                                      show_state: false
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.lampe_de_bureau
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.lampe_de_bureau
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.lampe_tele_salon
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      name: Lampe TV
                                      icon: null
                                    - type: custom:button-card
                                      entity: light.bandeau_led
                                      name: Bandeau TV
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.bandeau_led
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.bandeau_led
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.trilampe
                                      name: null
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.trilampe
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.trilampe
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.lustre_salon
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      name: Lustre salon
                                      icon: null
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.lustre_salon
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.lustre_salon
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.lustre_salle_a_manger
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      name: Lustre SàM
                                      icon: null
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.lustre_salle_a_manger
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.lustre_salle_a_manger
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.buffet
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      name: null
                                      icon: null
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.buffet
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.buffet
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.lampadaire
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      name: null
                                      icon: null
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.lampadaire
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.lampadaire
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - entity: media_player.sejour
                                  info: scroll
                                  artwork: material
                                  hide:
                                    volume: false
                                    source: true
                                    power: false
                                    name: false
                                    icon: true
                                    controls: false
                                  type: custom:mini-media-player
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - header:
                                    title: 🛋 Séjour ️
                                    show: true
                                    show_states: true
                                    colorize_states: true
                                  experimental:
                                    brush: true
                                  graph_span: 72h
                                  brush:
                                    selection_span: 12h
                                  apex_config:
                                    grid:
                                      show: false
                                    legend:
                                      fontSize: 12px
                                      height: 40
                                    dataLabels:
                                      enabled: false
                                    stroke:
                                      width: 3
                                      curve: smooth
                                    fill:
                                      type: gradient
                                      gradient:
                                        type: vertical
                                        shadeIntensity: 0.8
                                        inverseColors: false
                                        opacityFrom: 0.5
                                        opacityTo: 0
                                        stops:
                                          - - 0
                                            - 50
                                            - 100
                                    tooltip:
                                      enabled: true
                                    yaxis:
                                      - show: true
                                        decimalsInFloat: 0
                                        labels:
                                          style:
                                            colors: '#FFB62E'
                                            fontSize: 12px
                                        forceNiceScale: true
                                      - show: true
                                        decimalsInFloat: 0
                                        opposite: true
                                        labels:
                                          style:
                                            colors: '#2eb9ff'
                                            fontSize: 12px
                                        forceNiceScale: true
                                    xaxis:
                                      axisBorder:
                                        show: false
                                      labels:
                                        style:
                                          fontSize: 14px
                                  series:
                                    - entity: sensor.temp_sejour
                                      name: température
                                      show:
                                        extremas: false
                                      type: area
                                      color: tomato
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.hum_sejour
                                      name: humidité
                                      show:
                                        extremas: false
                                      type: area
                                      color: dodgerblue
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.temp_sejour
                                      name: SdB
                                      color: tomato
                                      fill_raw: last
                                      type: area
                                      stroke_width: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                      show:
                                        in_brush: true
                                        in_chart: false
                                  type: custom:apexcharts-card
                      - type: custom:button-card
                        entity: light.entree_2
                        template:
                          - base
                          - bouton_piece
                          - bouton_piece_graph
                          - state_lumiere
                          - effet
                        name: Entrée
                        icon: |
                          [[[
                              if (states['sensor.compteur_entree'].state == 1 && states['light.aqara_hub_54e1'].state == 'on' )
                              return 'mdi:alarm-light';
                            return 'phu:wall-spot';
                          ]]]
                        label: |
                          [[[
                            if (entity.state == 'on' )
                              return (states['sensor.temp_couloir_rdc'].state ) + "°" + " / " + Math.round(entity.attributes.brightness / 2.54) + "%";
                            return (states['sensor.temp_couloir_rdc'].state )  + "° / "+(states['sensor.hum_couloir_rdc'].state ) + "%";
                          ]]]
                        styles:
                          label:
                            - color: |
                                [[[
                                  if (states['sensor.temp_couloir_rdc'].state < 19)
                                    return 'dodgerblue';
                                  if (states['sensor.temp_couloir_rdc'].state > 25)
                                    return 'red';
                                    return 'var(--text_on)';
                                ]]]
                          custom_fields:
                            notification:
                              - background-color: |
                                  [[[
                                    if (states['sensor.compteur_entree'].state == 0)
                                      return 'rgba(0,191,205,0)';
                                   return 'rgba(0,0,0,0.4)';
                                  ]]]
                              - color: |
                                  [[[
                                    if (states['sensor.compteur_entree'].state == 0)
                                      return 'rgba(0,191,205,0)';
                                   return 'var(--text_on)';
                                  ]]]
                        custom_fields:
                          notification: >
                            [[[ return
                            Math.floor(states['sensor.compteur_entree'].state )
                            ]]]
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.entree_2
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.entree_2
                                radius: 5px
                                height: 25px
                                width: 100%
                                secondarySliderColor: darkslategrey
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                minSet: 1
                                thumbWidth: 1px
                                thumbColor: var(--text_on)
                          mouv:
                            card:
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: binary_sensor.mouv_couloir
                                  template:
                                    - bouton_piece_capteur
                              columns: 1
                              square: false
                          porte:
                            card:
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: binary_sensor.porte_entree
                                  template:
                                    - bouton_piece_capteur
                              columns: 1
                              square: false
                          graph:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.entree_2
                                  state: 'off'
                              card:
                                type: custom:mini-graph-card
                                entities:
                                  - color: var(--graph_line)
                                    entity: sensor.temp_couloir_rdc
                        double_tap_action:
                          action: toggle
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Entrée, veilleuse et couloir
                            card:
                              type: vertical-stack
                              cards:
                                - type: grid
                                  square: false
                                  columns: 3
                                  cards:
                                    - type: custom:button-card
                                      entity: sensor.temp_couloir_rdc
                                      name: null
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp
                                    - type: custom:button-card
                                      entity: binary_sensor.porte_entree
                                      name: null
                                      template:
                                        - base
                                        - base_capteur
                                        - state_porte
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_couloir
                                      name: Couloir
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: light.entree
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      name: null
                                      icon: null
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.entree
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.entree
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.couloir
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      name: null
                                      icon: null
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.couloir
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.couloir
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.aqara_hub_54e1
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      name: null
                                      icon: null
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.aqara_hub_54e1
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.aqara_hub_54e1
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                  square: false
                                  columns: 3
                                - header:
                                    title: 🏠 Entrée / couloir ️
                                    show: true
                                    show_states: true
                                    colorize_states: true
                                  experimental:
                                    brush: true
                                  graph_span: 72h
                                  brush:
                                    selection_span: 12h
                                  apex_config:
                                    grid:
                                      show: false
                                    legend:
                                      fontSize: 12px
                                      height: 40
                                    dataLabels:
                                      enabled: false
                                    stroke:
                                      width: 3
                                      curve: smooth
                                    fill:
                                      type: gradient
                                      gradient:
                                        type: vertical
                                        shadeIntensity: 0.8
                                        inverseColors: false
                                        opacityFrom: 0.5
                                        opacityTo: 0
                                        stops:
                                          - - 0
                                            - 50
                                            - 100
                                    tooltip:
                                      enabled: true
                                    yaxis:
                                      - show: true
                                        decimalsInFloat: 0
                                        labels:
                                          style:
                                            colors: '#FFB62E'
                                            fontSize: 12px
                                        forceNiceScale: true
                                      - show: true
                                        decimalsInFloat: 0
                                        opposite: true
                                        labels:
                                          style:
                                            colors: '#2eb9ff'
                                            fontSize: 12px
                                        forceNiceScale: true
                                    xaxis:
                                      axisBorder:
                                        show: false
                                      labels:
                                        style:
                                          fontSize: 14px
                                  series:
                                    - entity: sensor.temp_couloir_rdc
                                      name: température
                                      show:
                                        extremas: false
                                      type: area
                                      color: tomato
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.hum_couloir_rdc
                                      name: humidité
                                      show:
                                        extremas: false
                                      type: area
                                      color: dodgerblue
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.temp_couloir_rdc
                                      name: SdB
                                      color: tomato
                                      fill_raw: last
                                      type: area
                                      stroke_width: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                      show:
                                        in_brush: true
                                        in_chart: false
                                  type: custom:apexcharts-card
                      - type: custom:button-card
                        entity: binary_sensor.porte_cuisine
                        template:
                          - base
                          - bouton_piece
                          - bouton_piece_graph
                          - state_lumiere
                          - effet
                        icon: mdi:food-fork-drink
                        name: Cuisine
                        label: >
                          [[[ return (states['sensor.temp_cuisine'].state )  +
                          "° / "+(states['sensor.hum_cuisine'].state ) + "%";

                          ]]]
                        styles:
                          label:
                            - color: |
                                [[[
                                  if (states['sensor.temp_cuisine'].state < 19)
                                    return 'dodgerblue';
                                  if (states['sensor.temp_cuisine'].state > 25)
                                    return 'red';

                                    return 'var(--text_on)';
                                ]]]
                        tap_action:
                          action: more-info
                        custom_fields:
                          porte:
                            card:
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: binary_sensor.porte_cuisine
                                  template:
                                    - bouton_piece_capteur
                              columns: 1
                              square: false
                          graph:
                            card:
                              type: conditional
                              conditions:
                                - entity: binary_sensor.porte_cuisine
                                  state: 'off'
                              card:
                                type: custom:mini-graph-card
                                entities:
                                  - color: var(--graph_line)
                                    entity: sensor.temp_cuisine
                      - type: custom:button-card
                        entity: light.wc
                        template:
                          - base
                          - bouton_piece
                          - state_lumiere
                          - effet
                        name: Lavabo
                        icon: phu:rooms-toilet
                        label: |
                          [[[
                            if (entity.state == 'on' )
                              return  Math.round(entity.attributes.brightness / 2.54) + "%";
                            return "";
                          ]]]
                        styles:
                          custom_fields:
                            notification:
                              - background-color: |
                                  [[[
                                    if (states['sensor.compteur_wc'].state == 0)
                                      return 'rgba(0,191,205,0)';
                                   return 'rgba(0,0,0,0.4)';
                                  ]]]
                              - color: |
                                  [[[
                                    if (states['sensor.compteur_wc'].state == 0)
                                      return 'rgba(0,191,205,0)';
                                   return 'var(--text_on)';
                                  ]]]
                        custom_fields:
                          notification: >
                            [[[ return
                            Math.floor(states['sensor.compteur_wc'].state ) ]]]
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.wc
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.wc
                                radius: 5px
                                height: 25px
                                width: 100%
                                secondarySliderColor: darkslategrey
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                minSet: 1
                                thumbWidth: 1px
                                thumbColor: var(--text_on)
                          mouv:
                            card:
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: binary_sensor.mouv_salle_d_eau
                                  template:
                                    - bouton_piece_capteur
                              columns: 1
                              square: false
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Lavabo WC
                            card:
                              type: vertical-stack
                              cards:
                                - type: grid
                                  square: false
                                  columns: 3
                                  cards:
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_salle_d_eau
                                      name: Lavabo
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  square: false
                                  columns: 2
                                  cards:
                                    - type: custom:button-card
                                      entity: light.wc_gauche
                                      name: null
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: light.wc_droit
                                      name: null
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                      - type: custom:button-card
                        entity: light.parents
                        name: Parents
                        icon: phu:rooms-bedroom
                        template:
                          - base
                          - bouton_piece
                          - bouton_piece_graph
                          - state_lumiere
                          - effet
                        label: |
                          [[[
                            if (entity.state == 'on' )
                              return (states['sensor.temp_parents'].state ) + "°" + " / " + Math.round(entity.attributes.brightness / 2.54) + "%";
                            return (states['sensor.temp_parents'].state )  + "° / "+(states['sensor.hum_parents'].state ) + "%";
                          ]]]
                        styles:
                          label:
                            - color: |
                                [[[
                                  if (states['sensor.temp_parents'].state < 19)
                                    return 'dodgerblue';
                                  if (states['sensor.temp_parents'].state > 25)
                                    return 'red';
                                    return 'var(--text_on)';
                                ]]]
                          card:
                            - border_color: |
                                [[[
                                  if (states['sensor.temp_parents'].state < 19)
                                    return 'dodgerblue';
                                  if (states['sensor.temp_parents'].state > 24)
                                    return 'red';
                                ]]]
                          custom_fields:
                            notification:
                              - background-color: |
                                  [[[
                                    if (states['sensor.compteur_parents'].state == 0)
                                      return 'rgba(0,191,205,0)';
                                   return 'rgba(0,0,0,0.4)';
                                  ]]]
                              - color: |
                                  [[[
                                    if (states['sensor.compteur_parents'].state == 0)
                                      return 'rgba(0,191,205,0)';
                                   return 'var(--text_on)';
                                  ]]]
                        custom_fields:
                          notification: >
                            [[[ return
                            Math.floor(states['sensor.compteur_parents'].state )
                            ]]]
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.parents
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.parents
                                radius: 5px
                                height: 25px
                                width: 100%
                                secondarySliderColor: darkslategrey
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                minSet: 1
                                thumbWidth: 1px
                                thumbColor: var(--text_on)
                          porte:
                            card:
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: binary_sensor.porte_chambre_parents
                                  template:
                                    - bouton_piece_capteur
                              columns: 1
                              square: false
                          graph:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.parents
                                  state: 'off'
                              card:
                                type: custom:mini-graph-card
                                entities:
                                  - color: var(--graph_line)
                                    entity: sensor.temp_parents
                        double_tap_action:
                          action: toggle
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Chambre parentale
                            card:
                              type: vertical-stack
                              cards:
                                - type: grid
                                  square: false
                                  columns: 6
                                  cards:
                                    - type: custom:button-card
                                      entity: scene.chambre_parents_ambiance_normale
                                      name: Jour
                                      template:
                                        - carte_ronde_no_label
                                      tap_action:
                                        action: call-service
                                        service: scene.turn_on
                                        service_data:
                                          entity_id: scene.chambre_parents_ambiance_normale
                                    - type: custom:button-card
                                      entity: script.ambiance_cine_chevet_parents
                                      name: TV
                                      template:
                                        - carte_ronde_no_label
                                      tap_action:
                                        action: call-service
                                        service: script.turn_on
                                        service_data:
                                          entity_id: script.ambiance_cine_chevet_parents
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: sensor.temp_parents
                                      name: null
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp
                                    - type: custom:button-card
                                      entity: binary_sensor.porte_chambre_parents
                                      name: Fenêtre
                                      template:
                                        - base
                                        - base_capteur
                                        - state_porte
                                  square: false
                                  columns: 3
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: switch.tele_des_parents
                                      icon: mdi:youtube-tv
                                      name: TV
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_tv
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: light.lustre_parents
                                      name: Lustre
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.lustre_parents
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.lustre_parents
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.chevet
                                      name: Chevet
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.chevet
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.chevet
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                  square: false
                                  columns: 3
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - entity: media_player.chambre_des_parents
                                  info: scroll
                                  artwork: material
                                  hide:
                                    volume: false
                                    source: true
                                    power: false
                                    name: false
                                    icon: true
                                    controls: false
                                  type: custom:mini-media-player
                                - entity: media_player.cube_tv
                                  info: scroll
                                  artwork: material
                                  hide:
                                    volume: false
                                    source: true
                                    power: false
                                    name: false
                                    icon: true
                                    controls: false
                                  type: custom:mini-media-player
                      - type: custom:button-card
                        entity: light.cagibi
                        template:
                          - base
                          - bouton_piece
                          - state_lumiere
                          - effet
                        name: Garage
                        icon: |
                          [[[
                            if (states['binary_sensor.porte_garage'].state == "on")
                              return "mdi:garage-open-variant";
                            return "mdi:garage-variant";
                          ]]]
                        label: |
                          [[[
                            if (entity.state == 'on' )
                              return  Math.round(entity.attributes.brightness / 2.54) + "%" ;
                            return "";
                          ]]]
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Garage
                            card:
                              type: vertical-stack
                              cards:
                                - type: grid
                                  square: false
                                  columns: 3
                                  cards:
                                    - type: custom:button-card
                                      entity: binary_sensor.porte_cagibi
                                      name: null
                                      template:
                                        - base
                                        - base_capteur
                                        - state_porte
                                    - type: custom:button-card
                                      entity: binary_sensor.porte_garage
                                      name: null
                                      template:
                                        - base
                                        - base_capteur
                                        - state_porte
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_garage
                                      name: Mouvements
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: automation.cagibi_eclairage_off
                                      name: OFF auto
                                      icon: mdi:lightbulb-off-outline
                                      template:
                                        - base
                                        - base_capteur
                                        - state_appareil
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  square: false
                                  columns: 3
                                  cards:
                                    - type: custom:button-card
                                      entity: light.cagibi
                                      name: null
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                        custom_fields:
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.cagibi
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.cagibi
                                radius: 5px
                                height: 25px
                                width: 100%
                                secondarySliderColor: darkslategrey
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                minSet: 1
                                thumbWidth: 1px
                                thumbColor: var(--text_on)
                          mouv:
                            card:
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: binary_sensor.mouv_garage
                                  template:
                                    - bouton_piece_capteur
                              columns: 1
                              square: false
                          porte:
                            card:
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: group.portes_garage
                                  template:
                                    - bouton_piece_capteur
                              columns: 1
                              square: false
                    columns: 2
                    square: false
                  - type: custom:button-card
                    template:
                      - bouton_titre_piece
                    name: |
                      [[[ return "Etage" ]]]
                    label: |
                      [[[
                        if (states['sensor.compteur_pieces_etage'].state == 0)
                          return "Tout est éteint" ;
                        if (states['sensor.compteur_pieces_etage'].state == 1)
                          return "💡 " +(states['sensor.compteur_pieces_etage'].state ) + " pièce" ;
                        return "💡 " +(states['sensor.compteur_pieces_etage'].state ) + " pièces";
                      ]]]
                  - type: grid
                    cards:
                      - type: custom:button-card
                        entity: light.tom
                        name: Tom
                        icon: mdi:bat
                        template:
                          - base
                          - bouton_piece
                          - bouton_piece_graph
                          - state_lumiere
                          - effet
                        label: |
                          [[[
                            if (entity.state == 'on' )
                              return (states['sensor.temp_tom'].state ) + "°" + " / " + Math.round(entity.attributes.brightness / 2.54) + "%";
                            return (states['sensor.temp_tom'].state )  + "° / "+(states['sensor.hum_tom'].state ) + "%";
                          ]]]
                        styles:
                          label:
                            - color: |
                                [[[
                                  if (states['sensor.temp_tom'].state < 19)
                                    return 'dodgerblue';
                                  if (states['sensor.temp_tom'].state > 25)
                                    return 'red';
                                    return 'var(--text_on)';
                                ]]]
                          custom_fields:
                            notification:
                              - background-color: |
                                  [[[
                                    if (states['sensor.compteur_tom'].state == 0)
                                      return 'rgba(0,191,205,0)';
                                   return 'rgba(0,0,0,0.4)';
                                  ]]]
                              - color: |
                                  [[[
                                    if (states['sensor.compteur_tom'].state == 0)
                                      return 'rgba(0,191,205,0)';
                                   return 'var(--text_on)';
                                  ]]]
                        custom_fields:
                          notification: >
                            [[[ return
                            Math.floor(states['sensor.compteur_tom'].state ) ]]]
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.tom
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.tom
                                radius: 5px
                                height: 25px
                                width: 100%
                                secondarySliderColor: darkslategrey
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                minSet: 1
                                thumbWidth: 1px
                                thumbColor: var(--text_on)
                          mouv:
                            card:
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: binary_sensor.mouv_tom
                                  template:
                                    - bouton_piece_capteur
                              columns: 1
                              square: false
                          graph:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.tom
                                  state: 'off'
                              card:
                                type: custom:mini-graph-card
                                entities:
                                  - color: var(--graph_line)
                                    entity: sensor.temp_tom
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Chambre de Tom
                            card:
                              type: vertical-stack
                              cards:
                                - type: grid
                                  square: false
                                  columns: 6
                                  cards:
                                    - type: custom:button-card
                                      entity: scene.tom_ambiance_normale
                                      name: Jour
                                      template:
                                        - carte_ronde_no_label
                                      tap_action:
                                        action: call-service
                                        service: scene.turn_on
                                        service_data:
                                          entity_id: scene.tom_ambiance_normale
                                    - type: custom:button-card
                                      entity: scene.tom_ambiance_nuit
                                      name: Nuit
                                      template:
                                        - carte_ronde_no_label
                                      tap_action:
                                        action: call-service
                                        service: scene.turn_on
                                        service_data:
                                          entity_id: scene.tom_ambiance_nuit
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: sensor.temp_tom
                                      name: null
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp
                                    - type: custom:button-card
                                      entity: sensor.mouv_tom_luminosite
                                      name: Luminosité
                                      template:
                                        - base
                                        - base_capteur
                                        - state_luminosite
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_tom
                                      name: Mouv
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                  square: false
                                  columns: 3
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: light.lustre_tom
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      name: null
                                      icon: null
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.lustre_tom
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.lustre_tom
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.chevet_tom
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      name: null
                                      icon: null
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.chevet_tom
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.chevet_tom
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.lampe_de_bureau_tom
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      name: null
                                      icon: null
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.lampe_de_bureau_tom
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.lampe_de_bureau_tom
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: switch.moustique_tom
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_appareil
                                        - state_unavailable
                                  square: false
                                  columns: 3
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  square: false
                                  columns: 3
                                  cards:
                                    - type: custom:button-card
                                      entity: sensor.tom_reveil
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                      state:
                                        - value: Grasse mat !
                                          operator: '!='
                                          styles:
                                            card:
                                              - background-color: var(--pastille_appareil)
                                            img_cell:
                                              - background-color: var(--pastille_appareil)
                                            icon:
                                              - color: var(--icon_on)
                                            name:
                                              - color: var(--text_on)'
                                      name: Réveil
                                      icon: mdi:alarm
                                    - type: custom:button-card
                                      entity: automation.reveil_tom
                                      template:
                                        - base
                                        - base_capteur
                                        - state_appareil
                                        - state_unavailable
                                      name: Auto réveil
                                      icon: mdi:progress-clock
                                    - type: custom:button-card
                                      entity: automation.tom_allumage_auto
                                      template:
                                        - base
                                        - base_capteur
                                        - state_appareil
                                        - state_unavailable
                                      name: ON auto
                                      icon: mdi:lightbulb-on-outline
                                - entity: media_player.tom
                                  info: scroll
                                  artwork: material
                                  hide:
                                    volume: false
                                    source: true
                                    power: false
                                    name: false
                                    icon: true
                                    controls: false
                                  type: custom:mini-media-player
                      - type: custom:button-card
                        entity: light.manon_et_leane
                        name: Manon Léane
                        icon: mdi:death-star-variant
                        template:
                          - base
                          - bouton_piece
                          - bouton_piece_graph
                          - state_lumiere
                          - effet
                        label: |
                          [[[
                            if (entity.state == 'on' )
                              return (states['sensor.temp_manon'].state ) + "°" + " / " + Math.round(entity.attributes.brightness / 2.54) + "%";
                            return (states['sensor.temp_manon'].state )  + "° / "+(states['sensor.hum_manon'].state ) + "%";
                          ]]]
                        styles:
                          label:
                            - color: |
                                [[[
                                  if (states['sensor.temp_manon'].state < 19)
                                    return 'dodgerblue';
                                  if (states['sensor.temp_manon'].state > 25)
                                    return 'red';
                                    return 'var(--text_on)';
                                ]]]
                          custom_fields:
                            notification:
                              - background-color: |
                                  [[[
                                    if (states['sensor.compteur_manon'].state == 0)
                                      return 'rgba(0,191,205,0)';
                                   return 'rgba(0,0,0,0.4)';
                                  ]]]
                              - color: |
                                  [[[
                                    if (states['sensor.compteur_manon'].state == 0)
                                      return 'rgba(0,191,205,0)';
                                   return 'var(--text_on)';
                                  ]]]
                        custom_fields:
                          notification: >
                            [[[ return
                            Math.floor(states['sensor.compteur_manon'].state )
                            ]]]
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.manon_et_leane
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.manon_et_leane
                                radius: 5px
                                height: 25px
                                width: 100%
                                secondarySliderColor: darkslategrey
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                minSet: 1
                                thumbWidth: 1px
                                thumbColor: var(--text_on)
                          mouv:
                            card:
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: group.mouvements_grande_chambre
                                  template:
                                    - bouton_piece_capteur
                              columns: 1
                              square: false
                          graph:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.manon_et_leane
                                  state: 'off'
                              card:
                                type: custom:mini-graph-card
                                entities:
                                  - color: var(--graph_line)
                                    entity: sensor.temp_manon
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Chambre Manon et Léane
                            card:
                              type: vertical-stack
                              cards:
                                - type: grid
                                  square: false
                                  columns: 6
                                  cards:
                                    - type: custom:button-card
                                      entity: scene.grande_chambre_ambiance_normale
                                      name: Jour
                                      template:
                                        - carte_ronde_no_label
                                      tap_action:
                                        action: call-service
                                        service: scene.turn_on
                                        service_data:
                                          entity_id: scene.grande_chambre_ambiance_normale
                                    - type: custom:button-card
                                      entity: scene.grande_chambre_ambiance_nuit
                                      name: Nuit
                                      template:
                                        - carte_ronde_no_label
                                      tap_action:
                                        action: call-service
                                        service: scene.turn_on
                                        service_data:
                                          entity_id: scene.grande_chambre_ambiance_nuit
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: sensor.temp_manon
                                      name: Temp
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp
                                    - type: custom:button-card
                                      entity: sensor.mouv_manon_luminosite
                                      name: Luminosité
                                      template:
                                        - base
                                        - base_capteur
                                        - state_luminosite
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_manon
                                      name: Manon
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_leane
                                      name: Léane
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                  square: false
                                  columns: null
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: light.lustre_manon_et_leane
                                      name: Lustre
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      icon: null
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.lustre_manon_et_leane
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.lustre_manon_et_leane
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.chevet_manon
                                      name: Chevet Manon
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.chevet_manon
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.chevet_manon
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: switch.arbre_lumineux
                                      name: Arbre
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: light.lampe_manon_et_leane
                                      name: Lampe
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.lampe_manon_et_leane
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.lampe_manon_et_leane
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.chevet_leane
                                      name: Chevet Lélé
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.chevet_leane
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.chevet_leane
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: switch.moustique_manon
                                      name: Prise
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_appareil
                                        - state_unavailable
                                  square: false
                                  columns: 3
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  template:
                                    - popup_titre
                                  label: |
                                    [[[ return "Manon" ]]]
                                - type: grid
                                  square: false
                                  columns: 3
                                  cards:
                                    - type: custom:button-card
                                      entity: sensor.manon_reveil
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                      state:
                                        - value: Grasse mat !
                                          operator: '!='
                                          styles:
                                            card:
                                              - background-color: var(--pastille_appareil)
                                            img_cell:
                                              - background-color: var(--pastille_appareil)
                                            icon:
                                              - color: var(--icon_on)
                                            name:
                                              - color: var(--text_on)'
                                      name: Réveil
                                      icon: mdi:alarm
                                    - type: custom:button-card
                                      entity: automation.reveil_manon
                                      template:
                                        - base
                                        - base_capteur
                                        - state_appareil
                                        - state_unavailable
                                      name: Auto réveil
                                      icon: mdi:progress-clock
                                    - type: custom:button-card
                                      entity: >-
                                        automation.manon_leane_chambre_allumage_auto
                                      template:
                                        - base
                                        - base_capteur
                                        - state_appareil
                                        - state_unavailable
                                      name: ON auto
                                      icon: mdi:lightbulb-on-outline
                                - type: custom:button-card
                                  template:
                                    - popup_titre
                                  label: |
                                    [[[ return "Léane" ]]]
                                - type: grid
                                  square: false
                                  columns: 3
                                  cards:
                                    - type: custom:button-card
                                      entity: sensor.leane_reveil
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                      state:
                                        - value: Grasse mat !
                                          operator: '!='
                                          styles:
                                            card:
                                              - background-color: var(--pastille_appareil)
                                            img_cell:
                                              - background-color: var(--pastille_appareil)
                                            icon:
                                              - color: var(--icon_on)
                                            name:
                                              - color: var(--text_on)'
                                      name: Réveil
                                      icon: mdi:alarm
                                    - type: custom:button-card
                                      entity: automation.reveil_leane
                                      template:
                                        - base
                                        - base_capteur
                                        - state_appareil
                                        - state_unavailable
                                      name: Auto réveil
                                      icon: mdi:progress-clock
                                - entity: media_player.grande_chambre
                                  info: scroll
                                  artwork: material
                                  hide:
                                    volume: false
                                    source: true
                                    power: false
                                    name: false
                                    icon: true
                                    controls: false
                                  type: custom:mini-media-player
                      - type: custom:button-card
                        entity: light.nina
                        name: Nina
                        icon: mdi:owl
                        template:
                          - base
                          - bouton_piece
                          - bouton_piece_graph
                          - state_lumiere
                          - effet
                        label: |
                          [[[
                            if (entity.state == 'on' )
                              return (states['sensor.temp_nina'].state ) + "°" + " / " + Math.round(entity.attributes.brightness / 2.54) + "%";
                            return (states['sensor.temp_nina'].state )  + "° / "+(states['sensor.hum_nina'].state ) + "%";
                          ]]]
                        styles:
                          label:
                            - color: |
                                [[[
                                  if (states['sensor.temp_nina'].state < 19)
                                    return 'dodgerblue';
                                  if (states['sensor.temp_nina'].state > 25)
                                    return 'red';
                                    return 'var(--text_on)';
                                ]]]
                          custom_fields:
                            notification:
                              - background-color: |
                                  [[[
                                    if (states['sensor.compteur_nina'].state == 0)
                                      return 'rgba(0,191,205,0)';
                                   return 'rgba(0,0,0,0.4)';
                                  ]]]
                              - color: |
                                  [[[
                                    if (states['sensor.compteur_nina'].state == 0)
                                      return 'rgba(0,191,205,0)';
                                   return 'var(--text_on)';
                                  ]]]
                        custom_fields:
                          notification: >
                            [[[ return
                            Math.floor(states['sensor.compteur_nina'].state )
                            ]]]
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.nina
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.nina
                                radius: 5px
                                height: 25px
                                width: 100%
                                secondarySliderColor: darkslategrey
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                minSet: 1
                                thumbWidth: 1px
                                thumbColor: var(--text_on)
                          mouv:
                            card:
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: binary_sensor.mouv_nina
                                  template:
                                    - bouton_piece_capteur
                              columns: 1
                              square: false
                          graph:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.nina
                                  state: 'off'
                              card:
                                type: custom:mini-graph-card
                                entities:
                                  - color: var(--graph_line)
                                    entity: sensor.temp_nina
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Chambre de Nina
                            card:
                              type: vertical-stack
                              cards:
                                - type: grid
                                  square: false
                                  columns: 6
                                  cards:
                                    - type: custom:button-card
                                      entity: scene.nina_ambiance_normale
                                      name: Jour
                                      template:
                                        - carte_ronde_no_label
                                      tap_action:
                                        action: call-service
                                        service: scene.turn_on
                                        service_data:
                                          entity_id: scene.nina_ambiance_normale
                                    - type: custom:button-card
                                      entity: scene.nina_ambiance_nuit
                                      name: Nuit
                                      template:
                                        - carte_ronde_no_label
                                      tap_action:
                                        action: call-service
                                        service: scene.turn_on
                                        service_data:
                                          entity_id: scene.nina_ambiance_nuit
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: sensor.temp_nina
                                      name: null
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp
                                    - type: custom:button-card
                                      entity: sensor.mouv_nina_luminosite
                                      name: Luminosité
                                      template:
                                        - base
                                        - base_capteur
                                        - state_luminosite
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_nina
                                      name: Mouv
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                  square: false
                                  columns: 3
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: light.lampe_de_bureau_nina
                                      name: Bureau
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.lampe_de_bureau_nina
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.lampe_de_bureau_nina
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.lustre_nina
                                      name: Lustre
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.lustre_nina
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.lustre_nina
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.chevet_nina
                                      name: Chevet
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.chevet_nina
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.chevet_nina
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: switch.guirlande_nina
                                      name: Guirlande
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                    - type: custom:button-card
                                      entity: light.lampadaire_nina
                                      name: Lampadaire
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.lampadaire_nina
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.lampadaire_nina
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: switch.moustique_nina
                                      name: Moustique
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_appareil
                                        - state_unavailable
                                  square: false
                                  columns: 3
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  square: false
                                  columns: 3
                                  cards:
                                    - type: custom:button-card
                                      entity: sensor.nina_reveil
                                      template:
                                        - base
                                        - base_capteur
                                        - state_unavailable
                                      state:
                                        - value: Grasse mat !
                                          operator: '!='
                                          styles:
                                            card:
                                              - background-color: var(--pastille_appareil)
                                            img_cell:
                                              - background-color: var(--pastille_appareil)
                                            icon:
                                              - color: var(--icon_on)
                                            name:
                                              - color: var(--text_on)'
                                      name: Réveil
                                      icon: mdi:alarm
                                    - type: custom:button-card
                                      entity: automation.reveil_nina
                                      template:
                                        - base
                                        - base_capteur
                                        - state_appareil
                                        - state_unavailable
                                      name: Auto réveil
                                      icon: mdi:progress-clock
                                    - type: custom:button-card
                                      entity: automation.tom_allumage_auto
                                      template:
                                        - base
                                        - base_capteur
                                        - state_appareil
                                        - state_unavailable
                                      name: ON auto
                                      icon: mdi:lightbulb-on-outline
                                - entity: media_player.nina
                                  info: scroll
                                  artwork: material
                                  hide:
                                    volume: false
                                    source: true
                                    power: false
                                    name: false
                                    icon: true
                                    controls: false
                                  type: custom:mini-media-player
                      - type: custom:button-card
                        entity: switch.radiateur
                        name: SDB
                        icon: phu:rooms-bathroom
                        template:
                          - base
                          - bouton_piece
                          - bouton_piece_graph_fixe
                          - state_lumiere
                          - effet
                        label: >
                          [[[ return (states['sensor.temp_salle_de_bain'].state
                          )  + "° / "+(states['sensor.hum_salle_de_bain'].state
                          ) + "%" ;

                          ]]]
                        styles:
                          label:
                            - color: |
                                [[[
                                  if (states['sensor.temp_salle_de_bain'].state < 19)
                                    return 'dodgerblue';
                                  if (states['sensor.temp_salle_de_bain'].state > 25)
                                    return 'red';
                                    return 'var(--text_on)';
                                ]]]
                        custom_fields:
                          graph_fixe:
                            card:
                              type: custom:mini-graph-card
                              entities:
                                - color: var(--graph_line)
                                  entity: sensor.temp_salle_de_bain
                          circle: >
                            [[[ if (entity.state === 'on' &&
                            entity.attributes.brightness) {
                               const brightness = Math.round(entity.attributes.brightness / 2.54);
                               const radius = 17.5; const circumference = radius * 2 * Math.PI; 
                               return `<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="${radius}" stroke="darkslategrey" stroke-width="1.5" fill="none" style="
                               transform: rotate(-90deg); transform-origin: 50% 50%; stroke-dasharray: ${circumference}; stroke-dashoffset: ${circumference - brightness / 100 * circumference};" />
                               <text x="50%" y="54%" fill="darkslategrey" font-size="15" text-anchor="middle" alignment-baseline="middle">${brightness}<tspan font-size="10">%</tspan></text></svg>`; } ]]]
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Salle de bain
                            card:
                              type: vertical-stack
                              cards:
                                - type: grid
                                  square: false
                                  columns: 3
                                  cards:
                                    - type: custom:button-card
                                      entity: sensor.temp_salle_de_bain
                                      name: Température
                                      template:
                                        - base
                                        - base_capteur
                                        - state_temp
                                    - type: custom:button-card
                                      entity: sensor.hum_salle_de_bain
                                      name: Humidité
                                      template:
                                        - base
                                        - base_capteur
                                        - state_humidite
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: switch.radiateur
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      name: Chauffage
                                      icon: null
                                  square: false
                                  columns: 3
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - entity: media_player.la_salle_de_bain
                                  info: scroll
                                  artwork: material
                                  hide:
                                    volume: false
                                    source: true
                                    power: false
                                    name: false
                                    icon: true
                                    controls: false
                                  type: custom:mini-media-player
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - header:
                                    title: 🚿Salle de bains ️
                                    show: true
                                    show_states: true
                                    colorize_states: true
                                  experimental:
                                    brush: true
                                  graph_span: 72h
                                  brush:
                                    selection_span: 12h
                                  apex_config:
                                    grid:
                                      show: false
                                    legend:
                                      fontSize: 12px
                                      height: 40
                                    dataLabels:
                                      enabled: false
                                    stroke:
                                      width: 3
                                      curve: smooth
                                    fill:
                                      type: gradient
                                      gradient:
                                        type: vertical
                                        shadeIntensity: 0.8
                                        inverseColors: false
                                        opacityFrom: 0.5
                                        opacityTo: 0
                                        stops:
                                          - - 0
                                            - 50
                                            - 100
                                    tooltip:
                                      enabled: true
                                    yaxis:
                                      - show: true
                                        decimalsInFloat: 0
                                        labels:
                                          style:
                                            colors: '#FFB62E'
                                            fontSize: 12px
                                        forceNiceScale: true
                                      - show: true
                                        decimalsInFloat: 0
                                        opposite: true
                                        labels:
                                          style:
                                            colors: '#2eb9ff'
                                            fontSize: 12px
                                        forceNiceScale: true
                                    xaxis:
                                      axisBorder:
                                        show: false
                                      labels:
                                        style:
                                          fontSize: 14px
                                  series:
                                    - entity: sensor.temp_salle_de_bain
                                      name: température
                                      show:
                                        extremas: false
                                      type: area
                                      color: yellow
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.hum_salle_de_bain
                                      name: humidité
                                      show:
                                        extremas: false
                                      type: area
                                      color: dodgerblue
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.temp_salle_de_bain
                                      name: SdB
                                      color: yellow
                                      fill_raw: last
                                      type: area
                                      stroke_width: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                      show:
                                        in_brush: true
                                        in_chart: false
                                  type: custom:apexcharts-card
                      - type: custom:button-card
                        entity: light.escalier
                        name: Escalier
                        icon: mdi:stairs
                        template:
                          - base
                          - bouton_piece
                          - state_lumiere
                          - effet
                        label: |
                          [[[
                            if (entity.state == 'on' )
                              return Math.round(entity.attributes.brightness / 2.54) + "%";
                            return "";
                          ]]]
                        custom_fields:
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.escalier
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.escalier
                                radius: 5px
                                height: 25px
                                width: 100%
                                secondarySliderColor: darkslategrey
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                minSet: 1
                                thumbWidth: 1px
                                thumbColor: var(--text_on)
                          mouv:
                            card:
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: binary_sensor.mouv_escalier
                                  template:
                                    - bouton_piece_capteur
                              columns: 1
                              square: false
                        double_tap_action:
                          action: toggle
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Escaliers et palier
                            card:
                              type: vertical-stack
                              cards:
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_escalier
                                      name: Escalier
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_palier
                                      name: Palier
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: sensor.mouv_palier_lum
                                      name: Luminosité
                                      template:
                                        - base
                                        - base_capteur
                                        - state_luminosite
                                    - type: custom:button-card
                                      entity: automation.palier_allume_sur_mouvement
                                      name: ON auto
                                      icon: mdi:lightbulb-on-outline
                                      template:
                                        - base
                                        - base_capteur
                                        - state_appareil
                                  square: false
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: light.escaliers
                                      name: Tout
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.escaliers
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.escaliers
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.escalier
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.escalier
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.escalier
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.palier
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.palier
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.palier
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                  square: false
                                  columns: 3
                      - type: custom:button-card
                        entity: light.palier
                        name: Palier
                        icon: phu:rooms-attic
                        template:
                          - base
                          - bouton_piece
                          - state_lumiere
                          - effet
                        color: auto
                        label: |
                          [[[
                            if (entity.state == 'on' )
                              return (states['sensor.mouv_palier_lum'].state ) + " lx" + " / " + Math.round(entity.attributes.brightness / 2.54) + "%";
                            return (states['sensor.mouv_palier_lum'].state ) + " lx";
                          ]]]
                        custom_fields:
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.palier
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.palier
                                radius: 5px
                                height: 25px
                                width: 100%
                                secondarySliderColor: darkslategrey
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                minSet: 1
                                thumbWidth: 1px
                                thumbColor: var(--text_on)
                          mouv:
                            card:
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: binary_sensor.mouv_palier
                                  template:
                                    - bouton_piece_capteur
                              columns: 1
                              square: false
                        double_tap_action:
                          action: toggle
                        tap_action:
                          action: fire-dom-event
                          browser_mod:
                            command: popup
                            title: Escaliers et palier
                            card:
                              type: vertical-stack
                              cards:
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_escalier
                                      name: Escalier
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: binary_sensor.mouv_palier
                                      name: Palier
                                      template:
                                        - base
                                        - base_capteur
                                        - state_mouv
                                    - type: custom:button-card
                                      entity: sensor.mouv_palier_lum
                                      name: Luminosité
                                      template:
                                        - base
                                        - base_capteur
                                        - state_luminosite
                                    - type: custom:button-card
                                      entity: automation.palier_allume_sur_mouvement
                                      name: ON auto
                                      icon: mdi:lightbulb-on-outline
                                      template:
                                        - base
                                        - base_capteur
                                        - state_appareil
                                  square: false
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: grid
                                  cards:
                                    - type: custom:button-card
                                      entity: light.escaliers
                                      name: Tout
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.escaliers
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.escaliers
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.escalier
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.escalier
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.escalier
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                    - type: custom:button-card
                                      entity: light.palier
                                      template:
                                        - base
                                        - bouton_lumiere
                                        - state_lumiere
                                        - state_unavailable
                                      custom_fields:
                                        lum:
                                          card:
                                            type: conditional
                                            conditions:
                                              - entity: light.palier
                                                state: 'on'
                                            card:
                                              type: custom:my-slider
                                              entity: light.palier
                                              radius: 5px
                                              height: 15px
                                              mainSliderColor: >-
                                                var(--button-card-light-color-no-temperature)
                                              thumbHorizontalPadding: 0px
                                              thumbVerticalPadding: 0px
                                              thumbWidth: 2px
                                              minSet: 1
                                  square: false
                                  columns: 3
                    columns: 2
                    square: false
                type: vertical-stack
        layout:
          width: 280
      - type: custom:layout-card
        layout_type: masonry
        cards:
          - cards:
              - type: custom:button-card
                template:
                  - bouton_titre_piece
                style:
                  .: |
                    ha-card {
                        --ha-card-background: none !important;
                        box-shadow: none !important;
                        font-family: Avenir
                name: |
                  [[[ return "Multimédia" ]]]
                label: |
                  [[[
                    if (states['sensor.compteur_multimedia'].state == 0)
                      return "Tout est éteint" ;
                    if (states['sensor.compteur_multimedia'].state == 1)
                      return "🔊 " +(states['sensor.compteur_multimedia'].state ) + " en cours" ;
                    return "🔊 " +(states['sensor.compteur_multimedia'].state ) + " en cours";
                  ]]]
              - type: grid
                cards:
                  - type: custom:button-card
                    entity: media_player.tv_salon
                    name: TV Salon
                    icon: |
                      [[[
                        if (states['sensor.tv_salon_source'].state == "Netflix")
                          return "phu:netflix";
                        if (states['sensor.tv_salon_source'].state == "Prime Video")
                          return "phu:amazon-logo";
                        if (states['sensor.tv_salon_source'].state == "DD Externe")
                          return "mdi:movie-open";
                        if (states['sensor.tv_salon_source'].state == "YouTube")
                          return "mdi:youtube";
                        return "mdi:television-play";
                      ]]]
                    template:
                      - base
                      - bouton_tv
                      - state_tv
                      - state_unavailable
                      - effet
                    label: |
                      [[[
                        if (states['media_player.tv_salon'].state == "on")
                          return states['sensor.tv_salon_source'].state;
                        return "";
                      ]]]
                    styles:
                      label:
                        - color: |
                            [[[
                                if (states['sensor.tv_salon_source'].state == "Netflix")
                                  return "red";
                                if (states['sensor.tv_salon_source'].state == "YouTube")
                                  return "red";
                                return "var(--text_on)";
                              ]]]
                    custom_fields:
                      barre_volume:
                        card:
                          type: conditional
                          conditions:
                            - entity: media_player.tv_salon
                              state: 'on'
                          card:
                            type: custom:bar-card
                            name: vol tv salon
                            entities:
                              - entity: sensor.tv_salon_vol
                                color: var(--pastille_off)
                            entity_row: true
                            direction: null
                            unit_of_measurement: '%'
                            positions:
                              value: inside
                              name: 'off'
                              indicator: 'off'
                            height: 17px
                            width: 100%
                            icon: 'off'
                            style: |-
                              bar-card-value {
                                margin-right: -8%;
                                font-size: 13px;
                                font-weight: bold;
                                color: var(--text_on);
                              }
                      volume:
                        card:
                          type: conditional
                          conditions:
                            - entity: media_player.tv_salon
                              state: 'on'
                          card:
                            type: grid
                            square: false
                            columns: 5
                            cards:
                              - type: custom:button-card
                                entity: script.tv_salon_volume_mute
                                template: bouton_tv_volume
                                styles:
                                  card:
                                    - background: |
                                        [[[
                                          if (states['media_player.tv_salon'].attributes.is_volume_muted == true)
                                            return 'firebrick'
                                          return "rgba(0,0,0,0.2)"
                                        ]]]
                              - type: custom:button-card
                                entity: script.tv_salon_volume_bas
                                template: bouton_tv_volume
                              - type: custom:button-card
                                entity: script.tv_salon_volume_haut
                                template: bouton_tv_volume
                              - type: custom:button-card
                                entity: script.tv_salon_chaine_bas
                                template: bouton_tv_volume
                              - type: custom:button-card
                                entity: script.tv_salon_chaine_haut
                                template: bouton_tv_volume
                    double_tap_action:
                      action: call-service
                      service: script.tv_salon_on_off
                      service_data: null
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        command: popup
                        title: TV et programme
                        card:
                          type: vertical-stack
                          cards:
                            - type: custom:mini-media-player
                              entity: media_player.tv_salon
                              name: TV Salon
                              icon: mdi:television
                              source: full
                              sound_mode: icon
                              info: scroll
                              artwork: material
                            - aspect_ratio: 200%
                              type: iframe
                              url: https://www.programme-television.org/
                  - type: custom:button-card
                    entity: switch.tele_des_parents
                    name: TV Parents
                    icon: |
                      [[[
                        if (states['sensor.tv_parents_source'].state == "Netflix")
                          return "phu:netflix";
                        if (states['sensor.tv_parents_source'].state == "YouTube (FireTV)")
                          return "mdi:youtube";
                        if (states['sensor.tv_parents_source'].state == "DD Externe")
                          return "mdi:movie-open";
                        return "mdi:television";
                      ]]]
                    template:
                      - base
                      - bouton_tv
                      - state_tv
                      - state_unavailable
                      - effet
                    label: |
                      [[[
                        if ( entity.state  == 'on')
                          return states['sensor.tv_parents_source'].state;
                        if ( entity.state  == 'off')
                          return '';
                        return '';
                      ]]]
                    styles:
                      label:
                        - color: |
                            [[[
                                if (states['sensor.tv_parents_source'].state == "Netflix")
                                  return "red";
                                return "var(--text_on)";
                              ]]]
                    custom_fields:
                      barre_volume:
                        card:
                          type: conditional
                          conditions:
                            - entity: switch.tele_des_parents
                              state: 'on'
                          card:
                            type: custom:bar-card
                            name: vol tv parents
                            entities:
                              - entity: sensor.tv_parents_vol
                                color: var(--pastille_off)
                            entity_row: true
                            direction: null
                            unit_of_measurement: '%'
                            positions:
                              value: inside
                              name: 'off'
                              indicator: 'off'
                            height: 17px
                            width: 100%
                            icon: 'off'
                            style: |-
                              bar-card-value {
                                margin-right: -8%;
                                font-size: 13px;
                                font-weight: bold;
                                color: var(--text_on);
                              }
                    double_tap_action:
                      action: toggle
                    tap_action:
                      action: more-info
                columns: 2
                square: false
              - type: grid
                cards:
                  - type: custom:button-card
                    entity: sensor.musique_rdc_on
                    name: RDC
                    icon: mdi:speaker
                    template:
                      - base
                      - bouton_multimedia
                      - state_musique
                      - effet
                    styles:
                      custom_fields:
                        notification:
                          - background-color: |
                              [[[
                                if (states['sensor.compteur_musique_rdc'].state == 0)
                                  return 'rgba(0,191,205,0)';
                               return 'rgba(0,0,0,0.4)';
                              ]]]
                          - color: |
                              [[[
                                if (states['sensor.compteur_musique_rdc'].state == 0)
                                  return 'transparent';
                               return 'var(--text_on)';
                              ]]]
                      notification: >
                        [[[ return
                        Math.floor(states['sensor.compteur_musique_rdc'].state )
                        ]]]
                    custom_fields:
                      cartes:
                        card:
                          type: custom:swipe-card
                          parameters:
                            effect: fade
                            fadeEffect:
                              crossFade: true
                            autoplay:
                              delay: 3000
                            speed: 2000
                          cards:
                            - type: conditional
                              conditions:
                                - entity: media_player.partout
                                  state: playing
                              card:
                                info: scroll
                                artwork: full-cover-fit
                                hide:
                                  volume: true
                                  source: true
                                  power: true
                                  name: false
                                  icon: true
                                  controls: true
                                type: custom:mini-media-player
                                entity: media_player.partout
                            - type: conditional
                              conditions:
                                - entity: media_player.sejour
                                  state: playing
                              card:
                                info: scroll
                                artwork: full-cover-fit
                                hide:
                                  volume: true
                                  source: true
                                  power: true
                                  name: false
                                  icon: true
                                  controls: true
                                type: custom:mini-media-player
                                entity: media_player.sejour
                            - type: conditional
                              conditions:
                                - entity: media_player.la_cuisine
                                  state: playing
                              card:
                                info: scroll
                                artwork: full-cover-fit
                                hide:
                                  volume: true
                                  source: true
                                  power: true
                                  name: false
                                  icon: true
                                  controls: true
                                type: custom:mini-media-player
                                entity: media_player.la_cuisine
                            - type: conditional
                              conditions:
                                - entity: media_player.en_bas
                                  state: playing
                              card:
                                info: scroll
                                artwork: full-cover-fit
                                hide:
                                  volume: true
                                  source: true
                                  power: true
                                  name: false
                                  icon: true
                                  controls: true
                                type: custom:mini-media-player
                                entity: media_player.en_bas
                          columns: 2
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        command: popup
                        title: Musique
                        card:
                          type: grid
                          square: false
                          columns: 2
                          cards:
                            - type: custom:button-card
                              entity: media_player.partout
                              name: null
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.sejour
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.la_cuisine
                              name: Cuisine
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.la_salle_de_bain
                              name: S. de bain
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.tom
                              name: null
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.chambre_de_manon_et_leane
                              name: Manon & Lélé
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.nina
                              name: null
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.chambre_parents
                              name: Parents
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.en_bas
                              name: RDC
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.etage
                              name: null
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                  - type: custom:button-card
                    entity: sensor.musique_etage_on
                    name: Etage
                    icon: mdi:speaker
                    template:
                      - base
                      - bouton_multimedia
                      - state_musique
                      - effet
                    styles:
                      custom_fields:
                        notification:
                          - background-color: |
                              [[[
                                if (states['sensor.compteur_musique_etage'].state == 0)
                                  return 'rgba(0,191,205,0)';
                               return 'rgba(0,0,0,0.4)';
                              ]]]
                          - color: |
                              [[[
                                if (states['sensor.compteur_musique_etage'].state == 0)
                                  return 'transparent';
                               return 'var(--text_on)';
                              ]]]
                      notification: >
                        [[[ return
                        Math.floor(states['sensor.compteur_musique_etage'].state
                        ) ]]]
                    custom_fields:
                      cartes:
                        card:
                          type: custom:swipe-card
                          parameters:
                            effect: fade
                            fadeEffect:
                              crossFade: true
                            autoplay:
                              delay: 3000
                            speed: 2000
                          cards:
                            - type: conditional
                              conditions:
                                - entity: media_player.la_salle_de_bain
                                  state: playing
                                - entity: media_player.partout
                                  state_not: playing
                                - entity: media_player.etage
                                  state_not: playing
                              card:
                                info: scroll
                                artwork: full-cover-fit
                                hide:
                                  volume: true
                                  source: true
                                  power: true
                                  name: false
                                  icon: true
                                  controls: true
                                type: custom:mini-media-player
                                entity: media_player.la_salle_de_bain
                            - type: conditional
                              conditions:
                                - entity: media_player.leane
                                  state: playing
                                - entity: media_player.partout
                                  state_not: playing
                                - entity: media_player.etage
                                  state_not: playing
                                - entity: media_player.chambre_de_manon_et_leane
                                  state_not: playing
                              card:
                                info: scroll
                                artwork: full-cover-fit
                                hide:
                                  volume: true
                                  source: true
                                  power: true
                                  name: false
                                  icon: true
                                  controls: true
                                type: custom:mini-media-player
                                entity: media_player.leane
                            - type: conditional
                              conditions:
                                - entity: media_player.tom
                                  state: playing
                                - entity: media_player.partout
                                  state_not: playing
                                - entity: media_player.etage
                                  state_not: playing
                              card:
                                info: scroll
                                artwork: full-cover-fit
                                hide:
                                  volume: true
                                  source: true
                                  power: true
                                  name: false
                                  icon: true
                                  controls: true
                                type: custom:mini-media-player
                                entity: media_player.tom
                            - type: conditional
                              conditions:
                                - entity: media_player.nina
                                  state: playing
                                - entity: media_player.partout
                                  state_not: playing
                                - entity: media_player.etage
                                  state_not: playing
                              card:
                                info: scroll
                                artwork: full-cover-fit
                                hide:
                                  volume: true
                                  source: true
                                  power: true
                                  name: false
                                  icon: true
                                  controls: true
                                type: custom:mini-media-player
                                entity: media_player.nina
                            - type: conditional
                              conditions:
                                - entity: media_player.manon
                                  state: playing
                                - entity: media_player.partout
                                  state_not: playing
                                - entity: media_player.etage
                                  state_not: playing
                                - entity: media_player.chambre_de_manon_et_leane
                                  state_not: playing
                              card:
                                info: scroll
                                artwork: full-cover-fit
                                hide:
                                  volume: true
                                  source: true
                                  power: true
                                  name: false
                                  icon: true
                                  controls: true
                                type: custom:mini-media-player
                                entity: media_player.manon
                            - type: conditional
                              conditions:
                                - entity: media_player.etage
                                  state: playing
                                - entity: media_player.partout
                                  state_not: playing
                              card:
                                info: scroll
                                artwork: full-cover-fit
                                hide:
                                  volume: true
                                  source: true
                                  power: true
                                  name: false
                                  icon: true
                                  controls: true
                                type: custom:mini-media-player
                                entity: media_player.etage
                            - type: conditional
                              conditions:
                                - entity: media_player.chambre_de_manon_et_leane
                                  state: playing
                                - entity: media_player.partout
                                  state_not: playing
                              card:
                                info: scroll
                                artwork: full-cover-fit
                                hide:
                                  volume: true
                                  source: true
                                  power: true
                                  name: false
                                  icon: true
                                  controls: true
                                type: custom:mini-media-player
                                entity: media_player.chambre_de_manon_et_leane
                          columns: 2
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        command: popup
                        title: Musique
                        card:
                          type: grid
                          square: false
                          columns: 2
                          cards:
                            - type: custom:button-card
                              entity: media_player.partout
                              name: null
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.sejour
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.la_cuisine
                              name: Cuisine
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.la_salle_de_bain
                              name: S. de bain
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.tom
                              name: null
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.chambre_de_manon_et_leane
                              name: Manon & Lélé
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.nina
                              name: null
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.chambre_parents
                              name: Parents
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.en_bas
                              name: RDC
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                            - type: custom:button-card
                              entity: media_player.etage
                              name: null
                              template:
                                - petite_carte_media
                                - state_musique
                                - state_unavailable
                columns: 2
                square: false
              - type: custom:button-card
                template:
                  - bouton_titre_piece
                style:
                  .: |
                    ha-card {
                        --ha-card-background: none !important;
                        box-shadow: none !important;
                        font-family: Avenir
                name: |
                  [[[ return "Appareils" ]]]
                label: |
                  [[[
                    if (states['sensor.compteur_appareils'].state == 0)
                      return "Tout est éteint" ;
                    if (states['sensor.compteur_appareils'].state == 1)
                      return "🤖 " +(states['sensor.compteur_appareils'].state ) + " en fonctionnement" ;
                    return "🤖  " +(states['sensor.compteur_appareils'].state ) + " en fonctionnement";
                  ]]]
              - type: grid
                cards:
                  - type: custom:button-card
                    entity: vacuum.wall_e
                    name: Wall-E
                    icon: phu:roborock
                    template:
                      - base
                      - bouton_appareil
                      - state_aspi
                      - state_unavailable
                      - effet
                    label: >
                      [[[ return states['sensor.walle_state'].state + " - "
                      +states['sensor.walle_batterie'].state+"%"  ]]]
                    styles:
                      label:
                        - color: |
                            [[[
                              if (states['sensor.walle_state'].state == "Nettoyage")
                                return 'var(--text_on)';
                              if (states['sensor.walle_state'].state == "Retour")
                                return 'firebrick';
                              if (states['sensor.walle_state'].state == "️ERREUR")
                                return "firebrick";
                              if (states['sensor.walle_state'].state == "En pause")
                                return 'firebrick';
                              if (states['sensor.walle_state'].state == "En charge")
                                return 'grey';
                            ]]]
                    custom_fields:
                      bouton_aspi:
                        card:
                          type: grid
                          cards:
                            - type: custom:button-card
                              entity: script.aspi_walle_demarrage
                              template:
                                - bouton_aspi_commande
                            - type: custom:button-card
                              entity: script.aspi_pause
                              template:
                                - bouton_aspi_commande
                            - type: custom:button-card
                              entity: script.aspi_retour_base
                              template:
                                - bouton_aspi_commande
                            - type: custom:button-card
                              entity: script.sortir_l_aspi
                              template:
                                - bouton_aspi_commande
                          columns: 4
                          square: false
                  - type: custom:button-card
                    entity: vacuum.r2d2
                    name: R2D2
                    icon: phu:roborock
                    template:
                      - base
                      - bouton_appareil
                      - state_aspi
                      - state_unavailable
                      - effet
                    label: >
                      [[[ return states['sensor.r2d2_state'].state+ " - "
                      +states['sensor.r2d2_batterie'].state+"%"  ]]]
                    styles:
                      label:
                        - color: |
                            [[[
                              if (states['sensor.r2d2_state'].state == "Nettoyage")
                                return 'black';
                              if (states['sensor.r2d2_state'].state == "Retour")
                                return 'firebrick';
                              if (states['sensor.r2d2_state'].state == "️ERREUR")
                                return "firebrick";
                              if (states['sensor.r2d2_state'].state == "En pause")
                                return 'firebrick';
                              if (states['sensor.r2d2_state'].state == "Charge")
                                return 'grey';
                            ]]]
                    custom_fields:
                      bouton_aspi:
                        card:
                          type: grid
                          cards:
                            - type: custom:button-card
                              entity: script.aspi_r2d2_demarrage
                              template:
                                - bouton_aspi_commande
                              styles:
                                icon:
                                  - width: 55%
                            - type: custom:button-card
                              entity: script.aspi_pause
                              template:
                                - bouton_aspi_commande
                              styles:
                                icon:
                                  - width: 55%
                            - type: custom:button-card
                              entity: script.aspi_retour_base
                              template:
                                - bouton_aspi_commande
                              styles:
                                icon:
                                  - width: 55%
                          columns: 3
                          square: false
                  - type: custom:button-card
                    entity: switch.lave_vaisselle_power
                    name: Vaisselle
                    icon: mdi:dishwasher
                    template:
                      - base
                      - bouton_appareil
                      - state_machine
                      - state_unavailable
                      - effet
                    label: |
                      [[[
                        if (states['switch.lave_vaisselle_power'].state == "on")
                          return states['sensor.lave_vaisselle2'].state;
                        if (states['switch.lave_vaisselle_power'].state == "off")
                          return "";
                        return "" ;
                      ]]]
                    tap_action:
                      action: more-info
                    double_tap_action:
                      action: toggle
                    custom_fields:
                      batterie_vaisselle:
                        card:
                          type: conditional
                          conditions:
                            - entity: switch.lave_vaisselle_power
                              state: 'on'
                          card:
                            type: custom:bar-card
                            name: Batterie
                            entities:
                              - entity: sensor.lave_vaisselle_program_progress
                            entity_row: true
                            unit_of_measurement: '%'
                            positions:
                              value: inside
                              name: 'off'
                            height: 30px
                            width: 200%
                            icon: 'off'
                            color: var(--pastille_off)
                            style: |-
                              bar-card-value {
                                margin-right: 18%;
                                font-size: 13px;
                                font-weight: bold;
                                color: var(--text_on);
                              }
                  - type: custom:button-card
                    entity: input_boolean.lave_linge
                    name: Linge
                    icon: mdi:tshirt-crew
                    template:
                      - base
                      - bouton_appareil
                      - state_machine
                      - state_unavailable
                      - effet
                    label: |
                      [[[
                        if (states['input_boolean.lave_linge'].state == "off")
                          return "";
                        if (states['input_boolean.lave_linge'].state == "on")
                          return states['sensor.lave_linge2'].state;

                      ]]]
                    styles:
                      - color: |
                          [[[
                            if (states['input_boolean.lave_linge'].state == "on")
                              return "var(--text_on)";
                            if (states['input_boolean.lave_linge'].state == "unavailable")
                              return "red";
                            return "grey" ;
                          ]]]
                    tap_action:
                      action: more-info
                    double_tap_action:
                      action: toggle
                  - type: custom:button-card
                    entity: binary_sensor.boite_aux_lettres
                    name: Lettres
                    icon: null
                    show_last_changed: true
                    template:
                      - base
                      - bouton_appareil
                      - state_appareil
                      - state_unavailable
                      - effet
                    double_tap_action:
                      action: toggle
                    tap_action:
                      action: more-info
                  - type: custom:button-card
                    entity: sensor.canon_mg4100_series_black
                    name: Imprimante
                    icon: mdi:printer
                    template:
                      - base
                      - bouton_appareil
                      - state_imprimante
                      - effet
                    custom_fields:
                      barre_imprimante_noire:
                        card:
                          type: conditional
                          conditions:
                            - entity: sensor.canon_mg4100_series_black
                              state_not: unavailable
                          card:
                            type: custom:bar-card
                            name: Batterie
                            entities:
                              - entity: sensor.canon_mg4100_series_black
                                color: black
                            entity_row: true
                            direction: up
                            unit_of_measurement: '%'
                            positions:
                              value: inside
                              name: 'off'
                              indicator: 'off'
                            height: 55px
                            width: 25%
                            icon: 'off'
                            style: |-
                              bar-card-value {
                                margin-right: -90%;
                                font-size: 13px;
                                font-weight: bold;
                                color: var(--text_on);
                              }
                      barre_imprimante_couleur:
                        card:
                          type: conditional
                          conditions:
                            - entity: sensor.canon_mg4100_series_black
                              state_not: unavailable
                          card:
                            type: custom:bar-card
                            name: Batterie
                            entities:
                              - entity: sensor.canon_mg4100_series_color
                                color: purple
                            entity_row: true
                            direction: up
                            unit_of_measurement: '%'
                            positions:
                              value: inside
                              name: 'off'
                              indicator: 'off'
                            height: 55px
                            width: 25%
                            icon: 'off'
                            style: |-
                              bar-card-value {
                                margin-right: -90%;
                                font-size: 13px;
                                font-weight: bold;
                                color: var(--text_on);
                              }
                    state:
                      - value: 0
                        operator: '>='
                        styles:
                          card:
                            - animation: ball-scale 0.2s
                          img_cell:
                            - background-color: rgba(250,250,250,0.5)
                          icon:
                            - color: var(--icon_on)
                            - transition: 2s ease
                          name:
                            - color: var(--text_on)
                          label:
                            - color: var(--text_on)
                      - value: 'off'
                        color: grey
                        styles:
                          card:
                            - animation: ball-scale 0.2s
                          img_cell:
                            - background-color: var(--pastille_off)
                          icon:
                            - color: var(--icon_off)
                            - transition: 2s ease
                          name:
                            - color: grey
                          label:
                            - color: grey
                      - value: unavailable
                        color: grey
                        styles:
                          card:
                            - animation: ball-scale 0.2s
                          img_cell:
                            - background-color: var(--pastille_off)
                          icon:
                            - color: var(--icon_off)
                            - transition: 2s ease
                          name:
                            - color: grey
                          label:
                            - color: grey
                    tap_action:
                      action: more-info
                    double_tap_action:
                      action: toggle
                columns: 2
                square: false
            type: vertical-stack
        layout:
          width: 280
      - type: custom:layout-card
        layout_type: masonry
        cards:
          - cards:
              - type: custom:button-card
                template:
                  - bouton_titre_piece
                name: |
                  [[[ return "Maison" ]]]
                label: |
                  [[[
                    if (states['sensor.compteur_home'].state == 0)
                      return "👤 Y'a personne" ;
                    if (states['sensor.compteur_home'].state == 1)
                      return "👤 " +(states['sensor.compteur_home'].state ) + " personne" ;
                    return "👤 " +(states['sensor.compteur_home'].state ) + " personnes";
                  ]]]
              - type: grid
                cards:
                  - type: custom:button-card
                    template:
                      - bouton_person_herve
                  - type: custom:button-card
                    template:
                      - bouton_person_alex
                  - type: custom:button-card
                    template:
                      - bouton_person_tom
                  - type: custom:button-card
                    template:
                      - bouton_person_manon
                  - type: custom:button-card
                    template:
                      - bouton_person_leane
                  - type: custom:button-card
                    template:
                      - bouton_person_nina
                square: false
                columns: 2
              - type: custom:button-card
                template:
                  - bouton_titre_piece
                name: |
                  [[[ return "Système" ]]]
                label: |
                  [[[
                      return states['sensor.systeme'].state ;
                  ]]]
              - type: grid
                cards:
                  - type: custom:button-card
                    entity: sensor.cpu_temperature
                    name: RPI 4
                    icon: mdi:raspberry-pi
                    template:
                      - bouton_systeme
                    label: |
                      [[[return states["sensor.cpu_temperature"].state +"°"]]]
                    styles:
                      img_cell:
                        - background-color: |
                            [[[
                              if (entity.state < 50) return 'var(--pastille_off)';
                              if (entity.state >= 50 && entity.state < 60) return 'tomato';
                              else return 'red';
                            ]]]
                      icon:
                        - animation: |
                            [[[
                              if (entity.state > "50" )
                                return "blink 1s ease infinite";
                             return "";
                            ]]]
                        - color: |
                            [[[
                              if (entity.state < 50) return 'var(--icon_off)';
                              if (entity.state >= 50 && entity.state < 60) return 'var(--icon_on)';
                              else return 'var(--icon_on)';
                            ]]]
                      custom_fields:
                        info1:
                          - '--text-color-sensor': >-
                              [[[ if
                              (states["sensor.processor_use_percent"].state >
                              50) return "red";  else return "var(--text_on)";
                              ]]]
                        info2:
                          - '--text-color-sensor': >-
                              [[[ if (states["sensor.memory_use_percent"].state
                              > 60) return  "red";  else return
                              "var(--text_on)"; ]]]
                        info3:
                          - '--text-color-sensor': >-
                              [[[ if
                              (states["sensor.disk_use_percent_home"].state >
                              70) return "red";  else return "var(--text_on)";
                              ]]]
                        info4:
                          - '--text-color-sensor': >-
                              [[[ if (states["sensor.speedtest_download"].state
                              < 200)  return  "red";   if
                              (states["sensor.speedtest_download"].state ==
                              "unavailable")  return  "transparent"; else 
                              return "var(--text_on)"; 

                              ]]]
                    custom_fields:
                      graph:
                        card:
                          type: custom:mini-graph-card
                          entities:
                            - color: rgba(100,100,100,0.4)
                              entity: sensor.cpu_temperature
                          height: 300
                          line_width: 5
                          lower_bound: 18
                          points_per_hour: 1
                          hours_to_show: 24
                          show:
                            fill: fade
                            icon: false
                            name: false
                            state: false
                            legend: false
                            points: false
                            labels: false
                      info1: |
                        [[[
                          return `<ha-icon
                            icon="mdi:server"
                            style="width: 12px; height: 12px; color: grey;">
                            </ha-icon><span> CPU : <span style="color: var(--text-color-sensor);">${states['sensor.processor_use_percent'].state}%</span></span>`
                        ]]]
                      info2: |
                        [[[
                          return `<ha-icon
                            icon="mdi:memory"
                            style="width: 12px; height: 12px; color: grey;">
                            </ha-icon><span> RAM : <span style="color: var(--text-color-sensor);">${states['sensor.memory_use_percent'].state}%</span></span>`
                        ]]]
                      info3: |
                        [[[
                          return `<ha-icon
                            icon="mdi:harddisk"
                            style="width: 12px; height: 12px; color: grey;">
                            </ha-icon><span> SSD : <span style="color: var(--text-color-sensor);">${states['sensor.disk_use_percent_home'].state}%</span></span>`
                        ]]]
                      info4: |
                        [[[
                          return `<ha-icon
                            icon="mdi:speedometer"
                            style="width: 12px; height: 12px; color: grey;">
                            </ha-icon><span> Débit: <span style="color: var(--text-color-sensor);">${states['sensor.speedtest_download'].state} Mb/s</span></span>`
                        ]]]
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        command: popup
                        title: Raspberry
                        card:
                          type: vertical-stack
                          cards:
                            - square: false
                              columns: 4
                              type: grid
                              cards:
                                - type: custom:button-card
                                  entity: sensor.cpu_temperature
                                  template:
                                    - base
                                    - base_capteur
                                  name: RPI
                                - type: custom:button-card
                                  entity: sensor.processor_use_percent
                                  template:
                                    - base
                                    - base_capteur
                                  name: CPU
                                - type: custom:button-card
                                  entity: sensor.memory_use_percent
                                  template:
                                    - base
                                    - base_capteur
                                  name: RAM
                                - type: custom:button-card
                                  entity: sensor.disk_use_percent_home
                                  template:
                                    - base
                                    - base_capteur
                                  name: SSD
                            - header:
                                title: Home Assistant
                                show: true
                                show_states: true
                                colorize_states: true
                              experimental:
                                brush: true
                              graph_span: 72h
                              brush:
                                selection_span: 12h
                              apex_config:
                                grid:
                                  show: false
                                legend:
                                  fontSize: 12px
                                  height: 40
                                dataLabels:
                                  enabled: false
                                stroke:
                                  width: 3
                                  curve: smooth
                                fill:
                                  type: gradient
                                  gradient:
                                    type: vertical
                                    shadeIntensity: 0.8
                                    inverseColors: false
                                    opacityFrom: 0.5
                                    opacityTo: 0
                                    stops:
                                      - - 0
                                        - 50
                                        - 100
                                tooltip:
                                  enabled: true
                                yaxis:
                                  - show: true
                                    decimalsInFloat: 0
                                    labels:
                                      style:
                                        colors: '#FFB62E'
                                        fontSize: 12px
                                    forceNiceScale: true
                                  - show: true
                                    decimalsInFloat: 0
                                    opposite: true
                                    labels:
                                      style:
                                        colors: '#2eb9ff'
                                        fontSize: 12px
                                    forceNiceScale: true
                                xaxis:
                                  axisBorder:
                                    show: false
                                  labels:
                                    style:
                                      fontSize: 14px
                              series:
                                - entity: sensor.cpu_temperature
                                  name: Raspberry
                                  show:
                                    extremas: false
                                  type: area
                                  color: grey
                                  fill_raw: last
                                  float_precision: 1
                                  group_by:
                                    duration: 10min
                                    func: avg
                                - entity: sensor.processor_use_percent
                                  name: CPU
                                  show:
                                    extremas: false
                                  type: area
                                  color: dodgerblue
                                  fill_raw: last
                                  float_precision: 1
                                  group_by:
                                    duration: 10min
                                    func: avg
                                - entity: sensor.memory_use_percent
                                  name: RAM
                                  show:
                                    extremas: false
                                  type: area
                                  color: red
                                  fill_raw: last
                                  float_precision: 1
                                  group_by:
                                    duration: 10min
                                    func: avg
                                - entity: sensor.disk_use_percent_home
                                  name: SSD
                                  show:
                                    extremas: false
                                  type: area
                                  color: salmon
                                  fill_raw: last
                                  float_precision: 1
                                  group_by:
                                    duration: 10min
                                    func: avg
                                - entity: sensor.cpu_temperature
                                  name: Raspberry
                                  color: grey
                                  fill_raw: last
                                  type: area
                                  stroke_width: 1
                                  group_by:
                                    duration: 10min
                                    func: avg
                                  show:
                                    in_brush: true
                                    in_chart: false
                              type: custom:apexcharts-card
                  - type: custom:button-card
                    entity: sensor.myenedis_cost_yesterday_09397539765420
                    name: Enedis
                    icon: mdi:flash
                    template:
                      - bouton_systeme
                      - state_unavailable
                    label: >
                      [[[return
                      states["sensor.myenedis_cost_yesterday_09397539765420"].state
                      +"€"]]]
                    styles:
                      img_cell:
                        - background-color: |
                            [[[
                              if (entity.state < 2) return 'var(--pastille_off)';
                              if (entity.state >= 2 && entity.state < 3) return 'tomato';
                              else return 'red';
                            ]]]
                      icon:
                        - color: |
                            [[[
                              if (entity.state < 2) return 'var(--icon_off)';
                              if (entity.state >= 2 && entity.state < 3) return 'var(--icon_on)';
                              else return 'var(--icon_on)';
                            ]]]
                        - animation: |
                            [[[
                              if (entity.state == "unavailable" )
                                return "blink 1s ease infinite";
                             return "";
                            ]]]
                      custom_fields:
                        info1:
                          - '--text-color-sensor': |
                              [[[
                                if (states['sensor.myenedis_conso_semaine_en_cours_v2'].state == "unavailable")
                                 return 'transparent'
                                return 'lightgrey';
                              ]]]
                        info2:
                          - '--text-color-sensor': |
                              [[[
                                if (states['sensor.myenedis_cout_mois_en_cours_abo'].state == "unavailable")
                                 return 'transparent'
                                return 'lightgrey';
                              ]]]
                        info3:
                          - '--text-color-sensor': |
                              [[[
                                if (states['sensor.myenedis_cout_annee_en_cours_abo'].state == "unavailable")
                                 return 'transparent'
                                return 'lightgrey';
                              ]]]
                    custom_fields:
                      ic:
                        card:
                          type: grid
                          cards:
                            - type: custom:button-card
                              entity: script.rechargement_integration_myenedis
                              icon: mdi:reload-alert
                              show_name: false
                              styles:
                                icon:
                                  - color: firebrick
                                  - width: 80%
                                card:
                                  - background: transparent
                                  - 'border-color:': transparent
                      graph:
                        card:
                          type: custom:mini-graph-card
                          entities:
                            - entity: sensor.myenedis_cout_j7
                              color: rgba(123,104,238,0.3)
                            - entity: sensor.myenedis_cout_j6
                              color: rgba(123,104,238,0.3)
                            - entity: sensor.myenedis_cout_j5
                              color: rgba(123,104,238,0.3)
                            - entity: sensor.myenedis_cout_j4
                              color: rgba(123,104,238,0.3)
                            - entity: sensor.myenedis_cout_j3
                              color: rgba(123,104,238,0.3)
                            - entity: sensor.myenedis_cout_j2
                              color: rgba(123,104,238,0.3)
                            - entity: sensor.myenedis_cout_j1
                              color: rgba(255,255,0,0.6)
                          height: 300
                          line_width: 1
                          lower_bound: 1
                          group_by: date
                          show:
                            graph: bar
                            fill: false
                            icon: false
                            name: false
                            state: false
                            legend: false
                            points: false
                            labels: false
                      info1: |
                        [[[
                          return `
                            </ha-icon><span>Semaine : <span style="color: var(--text-color-sensor);">${states['sensor.myenedis_conso_semaine_en_cours_v2'].state}€</span></span>`
                        ]]]
                      info2: |
                        [[[
                          return `
                            </ha-icon><span>Mois : <span style="color: var(--text-color-sensor);">${states['sensor.myenedis_cout_mois_en_cours_abo'].state}€</span></span>`
                        ]]]
                      info3: |
                        [[[
                          return `
                            </ha-icon><span>Année : <span style="color: var(--text-color-sensor);">${states['sensor.myenedis_cout_annee_en_cours_abo'].state}€</span></span>`
                        ]]]
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        command: popup
                        title: Consommation électrique
                        card:
                          type: vertical-stack
                          cards:
                            - type: custom:content-card-linky
                              entity: sensor.myenedis_09397539765420
                              showInTableUnit: false
                              showPeakOffPeak: false
                              showHistory: true
                              showDayPrice: true
                              showDayPriceHCHP: false
                              showDayHCHP: false
                              showIcon: false
                              kWhPrice: false
                              showtitle: true
                              style: |
                                ha-card {
                                  color: lightgrey ;
                                  font-size: 95%;
                                  font-family: Avenir;
                                }
                              nbJoursAffichage: '7'
                              showDayName: short
                              showTitle: true
                              showPrice: true
                              showCurrentMonthRatio: true
                              showTitreLigne: true
                              showError: true
                              showYesterdayRatio: true
                            - type: markdown
                              content: >-

                                <font color='lightgrey'><b>Coût :
                                </b></font><font
                                color='red'><b>`0.1557€`</b></font><font
                                color='grey'>

                                - Hier : <font color='lightgrey'>**{{
                                (((states('sensor.myenedis_09397539765420') |
                                float) * (0.1557) | float)) | round(2)
                                }}€**<font color='grey'>

                                - Cette semaine :  <font color='lightgrey'>**{{
                                states('sensor.myenedis_conso_semaine_en_cours_v2')
                                }}€**<font color='grey'>

                                - Semaine dernière :  <font
                                color='lightgrey'>**{{
                                (((states('sensor.myenedis_conso_semaine_derniere')
                                | float) * (0.0001557) | float)) | round(2)
                                }}€**


                                <font color='lightgrey'><b>Abo mensuel inclus
                                :</b></font> <font
                                color='red'><b>`10.66€/mois`</b></font><font
                                color='grey'>

                                - Mois en cours : <font color='lightgrey'>**{{
                                states('sensor.myenedis_cout_mois_en_cours_abo')
                                }}€**<font color='grey'>

                                - Mois dernier : <font color='lightgrey'>**{{
                                states('sensor.myenedis_conso_mois_dernier')
                                }}€**<font color='grey'> 

                                - Année en cours :  <font color='lightgrey'>**{{
                                states('sensor.myenedis_cout_annee_en_cours_abo')
                                }}€**
                              style: |
                                ha-card {
                                  font-size: 110%;
                                  font-family: Avenir;
                                }
                            - align_header: center
                              align_icon: center
                              align_state: center
                              animate: true
                              color_thresholds:
                                - color: dodgerblue
                                  value: 0
                                - color: dodgerblue
                                  value: 0.2
                                - color: dodgerblue
                                  value: 0.4
                                - color: dodgerblue
                                  value: 0.6
                                - color: dodgerblue
                                  value: 0.8
                                - color: dodgerblue
                                  value: 1
                                - color: blue
                                  value: 1.2
                                - color: blue
                                  value: 1.4
                                - color: blue
                                  value: 1.6
                                - color: gold
                                  value: 1.8
                                - color: orange
                                  value: 2
                                - color: orange
                                  value: 2.2
                                - color: orange
                                  value: 2.4
                                - color: orange
                                  value: 2.6
                                - color: orange
                                  value: 2.8
                                - color: red
                                  value: 3
                                - color: red
                                  value: 3.5
                                - color: red
                                  value: 4
                                - color: red
                                  value: 4.5
                                - color: red
                                  value: 5
                                - color: red
                                  value: 5.5
                                - color: red
                                  value: 6
                                - color: firebrick
                                  value: 7
                                - color: firebrick
                                  value: 8
                                - color: firebrick
                                  value: 9
                                - color: firebrick
                                  value: 10
                              entities:
                                - entity: sensor.myenedis_cout_j7
                                - entity: sensor.myenedis_cout_j6
                                - entity: sensor.myenedis_cout_j5
                                - entity: sensor.myenedis_cout_j4
                                - entity: sensor.myenedis_cout_j3
                                - entity: sensor.myenedis_cout_j2
                                - entity: sensor.myenedis_cout_j1
                              font_size: 80
                              font_size_header: 13
                              hour24: true
                              hours_to_show: 24
                              icon: mdi:currency-eur
                              line_width: 2
                              name: Coût sur 7 jours
                              point_per_hour: 1
                              group_by: date
                              show:
                                graph: bar
                                name: true
                                state: false
                                extrema: false
                                fill: false
                                icon: true
                                icon_adaptive_color: false
                                labels: true
                                labels_secondary: false
                                legend: false
                                line: false
                                indicator: false
                                name_adaptive_color: false
                              style: |
                                ha-card {
                                  color: dodgerblue;
                                  font-family: Avenir;
                                }
                                :host {
                                  --paper-item-icon-color: dodgerblue;
                                }
                              type: custom:mini-graph-card
                  - type: custom:button-card
                    entity: sensor.temp_moyenne
                    icon: mdi:thermometer
                    name: Température
                    template:
                      - bouton_systeme
                    label: |
                      [[[return states["sensor.weather_temperature"].state ]]]
                    styles:
                      icon:
                        - color: |
                            [[[
                              if (entity.state < 18) return 'var(--icon_off)';
                              if (entity.state >= 19 && entity.state < 26) return 'var(--icon_on)';
                              else return 'var(--icon_on)';
                            ]]]
                      img_cell:
                        - background-color: |
                            [[[
                              if (entity.state < 18) return 'red';
                              if (entity.state >= 19 && entity.state < 26) return 'var(--pastille_off)';
                              else return 'red';
                            ]]]
                      custom_fields:
                        info1:
                          - '--text-color-sensor': |
                              [[[
                                if (states['sensor.temp_moyenne_rdc'].state <= 18)
                                  return 'rgba(0,191,255,0.5)';
                                if (states['sensor.temp_moyenne_rdc'].state > 25)
                                  return 'tomato';
                                return 'lightgrey';
                              ]]]
                        info2:
                          - '--text-color-sensor': |
                              [[[
                                if (states['sensor.temp_moyenne_etage'].state <= 18)
                                  return 'rgba(0,191,255,0.5)';
                                if (states['sensor.temp_moyenne_etage'].state > 25)
                                  return 'tomato';
                                return 'lightgrey';
                              ]]]
                        info3:
                          - '--text-color-sensor': |
                              [[[
                                if (states['sensor.temp_salle_de_bain'].state <= 18)
                                  return 'rgba(0,191,255,0.5)';
                                if (states['sensor.temp_salle_de_bain'].state > 25)
                                  return 'tomato';
                                return 'lightgrey';
                              ]]]
                        info4:
                          - '--text-color-sensor': |
                              [[[
                                if (states['sensor.plante_citro_temp'].state <= 10)
                                  return 'rgba(0,191,255,0.5)';
                                if (states['sensor.plante_citro_temp'].state > 25)
                                  return 'tomato';
                                return 'lightgrey';
                              ]]]
                    custom_fields:
                      info1: |
                        [[[
                          return `
                            </ha-icon><span> RDC : <span style="color: var(--text-color-sensor);">${states['sensor.temp_moyenne_rdc'].state}°</span></span>`
                        ]]]
                      info2: |
                        [[[
                          return `
                            </ha-icon><span> Etage : <span style="color: var(--text-color-sensor);">${states['sensor.temp_moyenne_etage'].state}°</span></span>`
                        ]]]
                      info3: |
                        [[[
                          return `
                            </ha-icon><span> SdB : <span style="color: var(--text-color-sensor);">${states['sensor.temp_salle_de_bain'].state}°</span></span>`
                        ]]]
                      info4: |
                        [[[
                          return `
                            </ha-icon><span> Véranda : <span style="color: var(--text-color-sensor);">${states['sensor.plante_citro_temp'].state}°</span></span>`
                        ]]]
                      ic:
                        card:
                          type: grid
                          cards:
                            - type: custom:button-card
                              entity: script.rechargement_integration_ble_monitor
                              icon: mdi:reload-alert
                              show_name: false
                              styles:
                                icon:
                                  - color: firebrick
                                  - width: 75%
                                card:
                                  - background: transparent
                                  - 'border-color:': transparent
                              tap_action:
                                action: toggle
                      graph:
                        card:
                          type: custom:mini-graph-card
                          entities:
                            - color: rgba(0,191,255,0.3)
                              entity: sensor.temp_moyenne_etage
                            - color: rgba(255,0,0,0.3)
                              entity: sensor.temp_moyenne_rdc
                          height: 300
                          line_width: 5
                          lower_bound: 18
                          points_per_hour: 1
                          hours_to_show: 24
                          show:
                            fill: fade
                            icon: false
                            name: false
                            state: false
                            legend: false
                            points: false
                            labels: false
                    double_tap_action:
                      action: more-info
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        command: popup
                        title: Température / Humidité
                        card:
                          type: vertical-stack
                          cards:
                            - type: custom:button-card
                              template:
                                - popup_titre
                              label: |
                                [[[ return "Extérieur" ]]]
                            - type: grid
                              cards:
                                - type: custom:button-card
                                  entity: sensor.weather_temperature_v2
                                  name: >
                                    [[[ return
                                    states['sensor.weather_conditions_simplifiees'].state]]]
                                  units: °C
                                  icon: |
                                    [[[
                                      if (states['weather.ta_ville'].state == 'sunny' )
                                        return 'mdi:weather-sunny';
                                      if (states['weather.ta_ville'].state == 'rainy' )
                                        return 'mdi:weather-rainy';
                                      if (states['weather.ta_ville'].state == 'partlycloudy' )
                                        return 'mdi:weather-partly-cloudy';
                                      if (states['weather.ta_ville'].state == 'cloudy' )
                                        return 'mdi:weather-cloudy';
                                      if (states['weather.ta_ville'].state == 'clear-night' )
                                        return 'mdi:weather-night';
                                      if (states['weather.ta_ville'].state == 'fog' )
                                        return 'mdi:weather-fog';
                                      if (states['weather.ta_ville'].state == 'hail' )
                                        return 'mdi:weather-hail';
                                      if (states['weather.ta_ville'].state == 'lightning-rainy' )
                                        return 'mdi:weather-lightning-rainy';
                                      if (states['weather.ta_ville'].state == 'lightning' )
                                        return 'mdi:weather-lightning';
                                      if (states['weather.ta_ville'].state == 'pourring' )
                                        return 'mdi:weather-pouring';
                                      if (states['weather.ta_ville'].state == 'snowy-rainy' )
                                        return 'mdi:weather-snowy-rainy';
                                      if (states['weather.ta_ville'].state == 'snowy' )
                                        return 'mdi:weather-snowy';
                                      if (states['weather.ta_ville'].state == 'windy-variant' )
                                        return 'mdi:weather-windy-variant';
                                      if (states['weather.ta_ville'].state == 'windy' )
                                        return 'mdi:weather-windy';
                                      if (states['weather.ta_ville'].state == 'exceptional' )
                                        return 'mdi:weather-cloudy-alert';
                                      return 'mdi:weather-sunny';
                                    ]]]
                                  template:
                                    - base
                                    - base_capteur
                                    - state_temp_exterieur
                                    - state_unavailable
                                - type: custom:button-card
                                  entity: sensor.plante_citro_temp
                                  name: Véranda
                                  template:
                                    - base
                                    - base_capteur
                                    - state_temp_exterieur
                                    - state_unavailable
                              columns: 3
                              square: false
                            - type: custom:button-card
                              template:
                                - popup_titre
                              label: |
                                [[[ return "Maison" ]]]
                            - type: grid
                              cards:
                                - type: custom:button-card
                                  entity: sensor.temp_sejour
                                  name: null
                                  template:
                                    - base
                                    - base_capteur
                                    - state_temp
                                    - state_unavailable
                                - type: custom:button-card
                                  entity: sensor.temp_couloir_rdc
                                  name: Couloir
                                  template:
                                    - base
                                    - base_capteur
                                    - state_temp
                                    - state_unavailable
                                - type: custom:button-card
                                  entity: sensor.temp_cuisine
                                  name: Cuisine
                                  template:
                                    - base
                                    - base_capteur
                                    - state_temp
                                    - state_unavailable
                                - type: custom:button-card
                                  entity: sensor.temp_parents
                                  name: null
                                  template:
                                    - base
                                    - base_capteur
                                    - state_temp
                                    - state_unavailable
                                - type: custom:button-card
                                  entity: sensor.temp_tom
                                  name: null
                                  template:
                                    - base
                                    - base_capteur
                                    - state_temp
                                    - state_unavailable
                                - type: custom:button-card
                                  entity: sensor.temp_manon
                                  name: Manon Lélé
                                  template:
                                    - base
                                    - base_capteur
                                    - state_temp
                                    - state_unavailable
                                - type: custom:button-card
                                  entity: sensor.temp_nina
                                  name: null
                                  template:
                                    - base
                                    - base_capteur
                                    - state_temp
                                    - state_unavailable
                                - type: custom:button-card
                                  entity: sensor.temp_salle_de_bain
                                  name: SdB
                                  template:
                                    - base
                                    - base_capteur
                                    - state_temp
                                    - state_unavailable
                              columns: 3
                              square: false
                            - type: vertical-stack
                              cards:
                                - header:
                                    title: 🛋 RDC température
                                    show: true
                                    show_states: true
                                    colorize_states: true
                                  experimental:
                                    brush: true
                                  graph_span: 72h
                                  brush:
                                    selection_span: 12h
                                  apex_config:
                                    grid:
                                      show: false
                                    legend:
                                      fontSize: 12px
                                      height: 40
                                    dataLabels:
                                      enabled: false
                                    stroke:
                                      width: 3
                                      curve: smooth
                                    fill:
                                      type: gradient
                                      gradient:
                                        type: vertical
                                        shadeIntensity: 0.8
                                        inverseColors: false
                                        opacityFrom: 0.5
                                        opacityTo: 0
                                        stops:
                                          - - 0
                                            - 50
                                            - 100
                                    tooltip:
                                      enabled: true
                                    xaxis:
                                      axisBorder:
                                        show: false
                                      labels:
                                        style:
                                          fontSize: 14px
                                  series:
                                    - entity: sensor.temp_sejour
                                      name: Séjour
                                      show:
                                        extremas: false
                                      type: area
                                      color: grey
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.temp_couloir_rdc
                                      name: Couloir
                                      show:
                                        extremas: false
                                      type: area
                                      color: violet
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.temp_cuisine
                                      name: Cuisine
                                      show:
                                        extremas: false
                                      type: area
                                      color: red
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.temp_moyenne_rdc
                                      name: Moyenne
                                      color: dodgerblue
                                      fill_raw: last
                                      type: area
                                      stroke_width: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                      show:
                                        in_brush: true
                                        in_chart: false
                                  card_mod:
                                    style: |
                                      ha-card {
                                      background-color: black;
                                      }
                                  type: custom:apexcharts-card
                                - header:
                                    title: 🛋 RDC humidité
                                    show: true
                                    show_states: true
                                    colorize_states: true
                                  experimental:
                                    brush: true
                                  graph_span: 72h
                                  brush:
                                    selection_span: 12h
                                  apex_config:
                                    grid:
                                      show: false
                                    legend:
                                      fontSize: 12px
                                      height: 40
                                    dataLabels:
                                      enabled: false
                                    stroke:
                                      width: 3
                                      curve: smooth
                                    fill:
                                      type: gradient
                                      gradient:
                                        type: vertical
                                        shadeIntensity: 0.8
                                        inverseColors: false
                                        opacityFrom: 0.5
                                        opacityTo: 0
                                        stops:
                                          - - 0
                                            - 50
                                            - 100
                                    tooltip:
                                      enabled: true
                                    xaxis:
                                      axisBorder:
                                        show: false
                                      labels:
                                        style:
                                          fontSize: 14px
                                  series:
                                    - entity: sensor.hum_sejour
                                      name: Séjour
                                      show:
                                        extremas: false
                                      type: area
                                      color: grey
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.hum_couloir_rdc
                                      name: Couloir
                                      show:
                                        extremas: false
                                      type: area
                                      color: violet
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.hum_cuisine
                                      name: Cuisine
                                      show:
                                        extremas: false
                                      type: area
                                      color: red
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                  card_mod:
                                    style: |
                                      ha-card {
                                      background-color: black;
                                      }
                                  type: custom:apexcharts-card
                            - type: vertical-stack
                              cards:
                                - header:
                                    title: 🛏Chambres température
                                    show: true
                                    show_states: true
                                    colorize_states: true
                                  experimental:
                                    brush: true
                                  graph_span: 72h
                                  brush:
                                    selection_span: 12h
                                  apex_config:
                                    grid:
                                      show: false
                                    legend:
                                      fontSize: 12px
                                      height: 40
                                    dataLabels:
                                      enabled: false
                                    stroke:
                                      width: 3
                                      curve: smooth
                                    fill:
                                      type: gradient
                                      gradient:
                                        type: vertical
                                        shadeIntensity: 0.8
                                        inverseColors: false
                                        opacityFrom: 0.5
                                        opacityTo: 0
                                        stops:
                                          - - 0
                                            - 50
                                            - 100
                                    tooltip:
                                      enabled: true
                                    xaxis:
                                      axisBorder:
                                        show: false
                                      labels:
                                        style:
                                          fontSize: 14px
                                  series:
                                    - entity: sensor.temp_parents
                                      name: Parents
                                      show:
                                        extremas: false
                                      type: area
                                      color: grey
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.temp_tom
                                      name: Tom
                                      show:
                                        extremas: false
                                      type: area
                                      color: dodgerblue
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.temp_manon
                                      name: Manon
                                      show:
                                        extremas: false
                                      type: area
                                      color: red
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.temp_nina
                                      name: Nina
                                      show:
                                        extremas: false
                                      type: area
                                      color: salmon
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.temp_parents
                                      name: Parents
                                      color: grey
                                      fill_raw: last
                                      type: area
                                      stroke_width: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                      show:
                                        in_brush: true
                                        in_chart: false
                                  card_mod:
                                    style: |
                                      ha-card {
                                      background-color: black;
                                      }
                                  type: custom:apexcharts-card
                                - header:
                                    title: 🛏Chambres humidité
                                    show: true
                                    show_states: true
                                    colorize_states: true
                                  experimental:
                                    brush: true
                                  graph_span: 72h
                                  brush:
                                    selection_span: 12h
                                  apex_config:
                                    grid:
                                      show: false
                                    legend:
                                      fontSize: 12px
                                      height: 40
                                    dataLabels:
                                      enabled: false
                                    stroke:
                                      width: 3
                                      curve: smooth
                                    fill:
                                      type: gradient
                                      gradient:
                                        type: vertical
                                        shadeIntensity: 0.8
                                        inverseColors: false
                                        opacityFrom: 0.5
                                        opacityTo: 0
                                        stops:
                                          - - 0
                                            - 50
                                            - 100
                                    tooltip:
                                      enabled: true
                                    xaxis:
                                      axisBorder:
                                        show: false
                                      labels:
                                        style:
                                          fontSize: 14px
                                  series:
                                    - entity: sensor.hum_parents
                                      name: Parents
                                      show:
                                        extremas: false
                                      type: area
                                      color: grey
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.hum_tom
                                      name: Tom
                                      show:
                                        extremas: false
                                      type: area
                                      color: dodgerblue
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.hum_manon
                                      name: Manon
                                      show:
                                        extremas: false
                                      type: area
                                      color: red
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.hum_nina
                                      name: Nina
                                      show:
                                        extremas: false
                                      type: area
                                      color: salmon
                                      fill_raw: last
                                      float_precision: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                    - entity: sensor.temp_parents
                                      name: Parents
                                      color: grey
                                      fill_raw: last
                                      type: area
                                      stroke_width: 1
                                      group_by:
                                        duration: 10min
                                        func: avg
                                      show:
                                        in_brush: true
                                        in_chart: false
                                  card_mod:
                                    style: |
                                      ha-card {
                                      background-color: black;
                                      }
                                  type: custom:apexcharts-card
                  - type: custom:button-card
                    entity: sensor.plante_citro_temp
                    name: Plantes
                    icon: mdi:flower-tulip
                    template:
                      - bouton_systeme
                    styles:
                      img_cell:
                        - background-color: |
                            [[[
                              if (entity.state < 1) return 'red';
                              if (entity.state >= 1 && entity.state < 26) return 'var(--pastille_off)';
                              else return 'red';
                            ]]]
                      icon:
                        - color: |
                            [[[
                              if (entity.state < 1) return 'var(--icon_on)';
                              if (entity.state >= 1 && entity.state < 26) return 'var(--icon_off)';
                              else return 'var(--icon_off)';
                            ]]]
                      custom_fields:
                        info1:
                          - '--text-color-sensor': |
                              [[[
                                if (states['sensor.plante_hum_dracaena'].state == "unavailable")
                                 return 'transparent'
                                return 'lightgrey';
                              ]]]
                        info2:
                          - '--text-color-sensor': |
                              [[[
                                if (states['sensor.plante_hum_pied_elephant'].state == "unavailable")
                                 return 'transparent'
                                return 'lightgrey';
                              ]]]
                        info3:
                          - '--text-color-sensor': |
                              [[[
                                if (states['sensor.plante_citro_humidite'].state == "unavailable" )
                                 return 'transparent'
                                if (states['sensor.bt_off'].state == "off dongle" )
                                 return 'red'
                                return 'lightgrey';
                              ]]]
                    custom_fields:
                      info1: |
                        [[[
                          return `<ha-icon
                            icon="mdi:water"
                            style="width: 12px; height: 12px; color: grey;">
                            </ha-icon><span> Dracena : <span style="color: var(--text-color-sensor);">${states['sensor.plante_hum_dracaena'].state}%</span></span>`
                        ]]]
                      info2: |
                        [[[
                          return `<ha-icon
                            icon="mdi:water"
                            style="width: 12px; height: 12px; color: grey;">
                            </ha-icon><span> Pied Eléphant : <span style="color: var(--text-color-sensor);">${states['sensor.plante_hum_pied_elephant'].state}%</span></span>`
                        ]]]
                      info3: |
                        [[[
                          return `<ha-icon
                            icon="mdi:water"
                            style="width: 12px; height: 12px; color: grey;">
                            </ha-icon><span> Citronnier : <span style="color: var(--text-color-sensor);">${states['sensor.plante_citro_humidite'].state}%</span></span>`
                        ]]]
                      graph:
                        card:
                          type: custom:mini-graph-card
                          entities:
                            - color: rgba(0,255,0,0.3)
                              entity: sensor.plante_hum_dracaena
                            - color: rgba(192,192,192,0.3)
                              entity: sensor.plante_hum_pied_elephant
                            - color: rgba(255,215,0,0.3)
                              entity: sensor.plante_citro_humidite
                          height: 300
                          line_width: 5
                          lower_bound: 18
                          points_per_hour: 1
                          hours_to_show: 24
                          show:
                            fill: fade
                            icon: false
                            name: false
                            state: false
                            legend: false
                            points: false
                            labels: false
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        command: popup
                        title: Plantes
                        card:
                          type: vertical-stack
                          cards:
                            - type: vertical-stack
                              cards:
                                - cards:
                                    - type: picture
                                      image: /local/header/header_dracaena2.png
                                      style: |
                                        ha-card {
                                          
                                          border-radius: 20px 20px 0px 0px; 
                                          background: #101010 ;
                                        }
                                    - entities:
                                        - entity: sensor.plante_hum_dracaena
                                          style: |
                                            :host {
                                              border-right: 1px solid violet;
                                              --paper-item-icon-color: violet;
                                            }
                                        - entity: sensor.plante_temp_dracaena
                                          style: |
                                            :host {
                                              border-right: 1px solid violet;
                                              --paper-item-icon-color: violet;
                                            }
                                        - entity: sensor.plante_lum_dracaena
                                          style: |
                                            :host {
                                              border-right: 1px solid violet;
                                              --paper-item-icon-color: violet;
                                            }
                                        - entity: sensor.plante_fertilite_dracaena
                                          style: |
                                            :host {
                                              --paper-item-icon-color: violet;
                                            }
                                      show_name: false
                                      style: |
                                        ha-card {

                                          border-radius: 20px;
                                          background: #101010;
                                          color: violet;
                                          font-size: 105%;
                                        .card-header {
                                          color: violet;  
                                        }
                                      type: glance
                                    - align_header: center
                                      align_icon: center
                                      align_state: center
                                      animate: true
                                      color_thresholds:
                                        - color: black
                                          value: 0
                                        - color: grey
                                          value: 1
                                        - color: grey
                                          value: 2
                                        - color: grey
                                          value: 3
                                        - color: grey
                                          value: 5
                                        - color: lightblue
                                          value: 6
                                        - color: lightblue
                                          value: 7
                                        - color: lightblue
                                          value: 8
                                        - color: lightblue
                                          value: 9
                                        - color: dodgerblue
                                          value: 10
                                        - color: dodgerblue
                                          value: 15
                                        - color: yellow
                                          value: 20
                                        - color: yellow
                                          value: 25
                                        - color: orange
                                          value: 30
                                        - color: orange
                                          value: 35
                                        - color: red
                                          value: 40
                                        - color: red
                                          value: 45
                                        - color: firebrick
                                          value: 50
                                        - color: firebrick
                                          value: 55
                                        - color: firebrick
                                          value: 60
                                      entities:
                                        - entity: sensor.plante_hum_dracaena
                                          name: null
                                      font_size_header: 20
                                      hour24: true
                                      hours_to_show: 168
                                      line_width: 2
                                      name: Humidité
                                      point_per_hour: 1
                                      show:
                                        extrema: true
                                        fill: true
                                        icon: true
                                        icon_adaptive_color: false
                                        labels: true
                                        labels_secondary: true
                                        legend: true
                                        line: true
                                        name_adaptive_color: false
                                      style: |
                                        ha-card {
                                          
                                          border-radius: 20px ;
                                          color: violet;    
                                          background: #101010 ; 
                                        }
                                        :host {
                                          --paper-item-icon-color: violet;
                                        }
                                      tap_action: none
                                      type: custom:mini-graph-card
                                    - type: custom:button-card
                                      color_type: blank-card
                                    - type: custom:button-card
                                      color_type: blank-card
                                    - type: custom:button-card
                                      color_type: blank-card
                                  type: custom:vertical-stack-in-card
                                  style: |
                                    ha-card {        
                                      border-radius: 20px ;
                                      background: #101010 ; 
                                    }
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                            - cards:
                                - type: picture
                                  image: /local/header/header_pied2.png
                                  style: |
                                    ha-card {
                                      border-radius: 20px 20px 0px 0px; 
                                      background: #101010 ;
                                    }
                                - entities:
                                    - entity: sensor.plante_hum_pied_elephant
                                      style: |
                                        :host {
                                          border-right: 1px solid lightgreen;
                                          --paper-item-icon-color: lightgreen;
                                        }
                                    - entity: sensor.plante_temp_pied_elephant
                                      style: |
                                        :host {
                                          border-right: 1px solid lightgreen;
                                          --paper-item-icon-color: lightgreen;
                                        }
                                    - entity: sensor.plante_lum_pied_elephant
                                      style: |
                                        :host {
                                          border-right: 1px solid lightgreen;
                                          --paper-item-icon-color: lightgreen;
                                        }
                                    - entity: sensor.plante_fertilite_pied_elephant
                                      style: |
                                        :host {
                                          --paper-item-icon-color: lightgreen;
                                        }
                                  show_name: false
                                  style: |
                                    ha-card {

                                      border-radius: 20px;
                                      background: #101010 ;
                                      color: lightgreen;
                                      font-size: 105%;
                                    .card-header {
                                      color: lightgreen;  
                                    }
                                  type: glance
                                - align_header: center
                                  align_icon: center
                                  align_state: center
                                  animate: true
                                  color_thresholds:
                                    - color: black
                                      value: 0
                                    - color: grey
                                      value: 1
                                    - color: grey
                                      value: 2
                                    - color: grey
                                      value: 3
                                    - color: grey
                                      value: 5
                                    - color: lightblue
                                      value: 6
                                    - color: lightblue
                                      value: 7
                                    - color: lightblue
                                      value: 8
                                    - color: lightblue
                                      value: 9
                                    - color: dodgerblue
                                      value: 10
                                    - color: dodgerblue
                                      value: 15
                                    - color: yellow
                                      value: 20
                                    - color: yellow
                                      value: 25
                                    - color: orange
                                      value: 30
                                    - color: orange
                                      value: 35
                                    - color: red
                                      value: 40
                                    - color: red
                                      value: 45
                                    - color: firebrick
                                      value: 50
                                    - color: firebrick
                                      value: 55
                                    - color: firebrick
                                      value: 60
                                  entities:
                                    - entity: sensor.plante_hum_pied_elephant
                                      name: null
                                  font_size_header: 20
                                  hour24: true
                                  hours_to_show: 168
                                  line_width: 2
                                  name: Humidité
                                  point_per_hour: 1
                                  show:
                                    extrema: true
                                    fill: true
                                    icon: true
                                    icon_adaptive_color: false
                                    labels: true
                                    labels_secondary: true
                                    legend: true
                                    line: true
                                    name_adaptive_color: false
                                  style: |
                                    ha-card {

                                      border-radius: 20px ;
                                      color: lightgreen;    
                                      background: #101010 ; 
                                    }
                                    :host {
                                      --paper-item-icon-color: lightgreen;
                                    }
                                  tap_action: none
                                  type: custom:mini-graph-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                              type: custom:vertical-stack-in-card
                              style: |
                                ha-card {        
                                  border-radius: 20px ;
                                  background: #101010 ; 
                                }
                            - cards:
                                - type: picture
                                  image: /local/header/header_citronnier2.png
                                  style: |
                                    ha-card {
                                      border-radius: 20px 20px 0px 0px; 
                                      background: #101010 ;
                                    }
                                - entities:
                                    - entity: sensor.plante_citro_humidite
                                      style: |
                                        :host {
                                          border-right: 1px solid yellow;
                                          --paper-item-icon-color: yellow;
                                        }
                                    - entity: sensor.plante_citro_temp
                                      style: |
                                        :host {
                                          border-right: 1px solid yellow;
                                          --paper-item-icon-color: yellow;
                                        }
                                    - entity: sensor.plante_citro_lum
                                      style: |
                                        :host {
                                          border-right: 1px solid yellow;
                                          --paper-item-icon-color: yellow;
                                        }
                                    - entity: sensor.plante_citro_fertilite
                                      style: |
                                        :host {
                                          --paper-item-icon-color: yellow;
                                        }
                                  show_name: false
                                  style: |
                                    ha-card {

                                      border-radius: 20px;
                                      background: #101010 ;
                                      font-size: 105%;
                                      color: yellow;
                                    .card-header {
                                      color: yellow;  
                                    }
                                  type: glance
                                - align_header: center
                                  align_icon: center
                                  align_state: center
                                  animate: true
                                  color_thresholds:
                                    - color: lightblue
                                      value: 0
                                    - color: lightblue
                                      value: 1
                                    - color: lightblue
                                      value: 2
                                    - color: lightblue
                                      value: 3
                                    - color: lightblue
                                      value: 5
                                    - color: lightblue
                                      value: 6
                                    - color: lightblue
                                      value: 7
                                    - color: lightblue
                                      value: 8
                                    - color: lightblue
                                      value: 9
                                    - color: dodgerblue
                                      value: 10
                                    - color: dodgerblue
                                      value: 15
                                    - color: yellow
                                      value: 20
                                    - color: yellow
                                      value: 25
                                    - color: orange
                                      value: 30
                                    - color: orange
                                      value: 35
                                    - color: red
                                      value: 40
                                    - color: red
                                      value: 45
                                    - color: firebrick
                                      value: 50
                                    - color: firebrick
                                      value: 55
                                    - color: firebrick
                                      value: 60
                                    - color: firebrick
                                      value: 65
                                    - color: firebrick
                                      value: 70
                                  entities:
                                    - entity: sensor.plante_citro_humidite
                                      name: null
                                  font_size_header: 20
                                  hour24: true
                                  hours_to_show: 168
                                  line_color: gold
                                  line_width: 2
                                  name: Humidité
                                  point_per_hour: 1
                                  show:
                                    extrema: true
                                    fill: true
                                    icon: true
                                    icon_adaptive_color: false
                                    labels: true
                                    labels_secondary: true
                                    legend: true
                                    line: true
                                    name_adaptive_color: false
                                  style: |
                                    ha-card {

                                      border-radius: 20px ;
                                      color: yellow;    
                                      background: #101010 ; 
                                    }
                                    :host {
                                      --paper-item-icon-color: yellow;
                                    }
                                  tap_action: none
                                  type: custom:mini-graph-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                                - type: custom:button-card
                                  color_type: blank-card
                              type: custom:vertical-stack-in-card
                              style: |
                                ha-card {        
                                  border-radius: 20px ;
                                  background: #101010 ; 
                                }
                columns: 2
                square: false
            type: vertical-stack
        layout:
          width: 280
  - theme: Backend-selected
    icon: mdi:broom
    path: ''
    title: Aspis
    visible:
      - user: 2f0040afe95a4514ade3c049a0b5d479
      - user: 76afcf1927a948b19530bcbf1074ac59
      - user: d8316597eafd4333b737464a5b4c62d0
    type: custom:horizontal-layout
    layout:
      width: 350
      max_cols: 4
    badges: []
    cards:
      - type: custom:layout-card
        layout_type: masonry
        layout:
          width: 350
        cards:
          - type: vertical-stack
            cards:
              - type: vertical-stack
                cards:
                  - type: custom:xiaomi-vacuum-card
                    style: |
                      ha-card {
                        border-radius: 15px;
                      }
                    entity: vacuum.wall_e
                    image: /local/aspis/walle.jpeg
                    name: Wall-E
                    attributes:
                      main_brush:
                        label: 'Brosse '
                        unit: ' h'
                      side_brush:
                        label: 'Brosette '
                        unit: ' h'
                      filter:
                        label: 'Filtre '
                      sensor:
                        label: 'Capteurs '
                    shortcuts:
                      spot:
                        show: true
                        label: Nettoyage localisé
                      new_button:
                        icon: mdi:flag-variant
                        label: Custom button!
                        service: script.turn_on
                        service_data:
                          entity_id: script.sortir_l_aspi
                  - square: false
                    columns: 8
                    type: grid
                    cards:
                      - type: custom:button-card
                        entity: script.aspi_walle_cuisine
                        name: Cuisine
                        template:
                          - carte_ronde_no_label
                        tap_action:
                          action: toggle
                      - type: custom:button-card
                        entity: script.aspi_walle_entree
                        name: Entrée
                        template:
                          - carte_ronde_no_label
                        tap_action:
                          action: toggle
                      - type: custom:button-card
                        entity: script.aspi_walle_tapis
                        name: Tapis
                        template:
                          - carte_ronde_no_label
                        tap_action:
                          action: toggle
                      - type: custom:button-card
                        entity: script.aspi_walle_couloir
                        name: Couloir
                        template:
                          - carte_ronde_no_label
                        tap_action:
                          action: toggle
                      - type: custom:button-card
                        entity: script.aspi_walle_sejour
                        name: Séjour
                        template:
                          - carte_ronde_no_label
                        tap_action:
                          action: toggle
                      - type: custom:button-card
                        entity: script.aspi_salle_a_manger
                        name: SàM
                        template:
                          - carte_ronde_no_label
                        tap_action:
                          action: toggle
                      - type: custom:button-card
                        entity: script.aspi_walle_salon
                        name: Salon
                        template:
                          - carte_ronde_no_label
                        tap_action:
                          action: toggle
                      - type: custom:button-card
                        entity: script.aspi_walle_chambre_parents
                        name: Parents
                        template:
                          - carte_ronde_no_label
                        tap_action:
                          action: toggle
                  - type: custom:xiaomi-vacuum-map-card
                    entity: vacuum.wall_e
                    map_source:
                      camera: camera.roborock_s6
                    calibration_source:
                      camera: true
                    language: fr
                    debug: false
                    map_modes:
                      - template: vacuum_clean_zone
                      - template: vacuum_goto
                      - template: vacuum_clean_zone_predefined
                        predefined_selections:
                          - zones:
                              - - 25027
                                - 24933
                                - 28549
                                - 28632
                          - zones:
                              - - 28625
                                - 25085
                                - 31969
                                - 28683
                          - zones:
                              - - 31944
                                - 24883
                                - 33895
                                - 28683
                          - zones:
                              - - 23761
                                - 28734
                                - 27308
                                - 31571
                          - zones:
                              - - 28777
                                - 28759
                                - 32603
                                - 30507
                          - zones:
                              - - 32628
                                - 28835
                                - 33768
                                - 30532
                          - zones:
                              - - 27308
                                - 28759
                                - 28802
                                - 33522
                          - zones:
                              - - 28828
                                - 30608
                                - 29740
                                - 33547
                          - zones:
                              - - 23659
                                - 31672
                                - 27282
                                - 35118
                          - zones:
                              - - 30150
                                - 30550
                                - 33050
                                - 34300
                    map_locked: true
                    two_finger_pan: false
                  - square: false
                    columns: 4
                    type: grid
                    cards:
                      - type: custom:button-card
                        entity: script.aspi_walle_reset_brosse_principale
                        name: Brosse principale
                        icon: mdi:robot-vacuum-variant
                        template:
                          - base_verticale_centree
                        confirmation:
                          text: >-
                            [[[ return `Wall-E Reset de la brosse principale ?`
                            ]]]
                        tap_action:
                          action: call-service
                          service: script.turn_on
                          service_data:
                            entity_id: script.aspi_walle_reset_brosse_principale
                      - type: custom:button-card
                        entity: script.aspi_walle_reset_brosse_laterale
                        name: Brosse latérale
                        icon: mdi:broom
                        template:
                          - base_verticale_centree
                        confirmation:
                          text: >-
                            [[[ return `Wall-E Reset de la brosse latérale ?`
                            ]]]
                        tap_action:
                          action: call-service
                          service: script.turn_on
                          service_data:
                            entity_id: script.aspi_walle_reset_brosse_laterale
                      - type: custom:button-card
                        entity: script.aspi_walle_reset_capteurs
                        icon: mdi:state-machine
                        template:
                          - base_verticale_centree
                        name: Capteurs
                        confirmation:
                          text: '[[[ return `Wall-E Reset des capteurs ?` ]]]'
                        tap_action:
                          action: call-service
                          service: script.turn_on
                          service_data:
                            entity_id: script.aspi_walle_reset_capteurs
                      - type: custom:button-card
                        entity: script.aspi_walle_reset_filtre
                        name: Filtre
                        icon: mdi:air-filter
                        template:
                          - base_verticale_centree
                        confirmation:
                          text: '[[[ return `Wall-E Reset du filtre ?` ]]]'
                        tap_action:
                          action: call-service
                          service: script.turn_on
                          service_data:
                            entity_id: script.aspi_walle_reset_filtre
      - type: custom:layout-card
        layout_type: masonry
        layout:
          width: 350
        cards:
          - type: vertical-stack
            cards:
              - type: custom:xiaomi-vacuum-card
                entity: vacuum.r2d2
                image: /local/aspis/r2d2.jpg
                name: R2D2
                vendor: xiaomi
                attributes:
                  main_brush:
                    label: 'Brosse '
                    unit: ' h'
                  side_brush:
                    label: 'Brossette '
                    unit: ' h'
                  filter:
                    label: 'Filtre: '
                  sensor:
                    label: 'Capteurs: '
                buttons:
                  spot:
                    show: true
                    label: Nettoyage localisé
              - square: false
                columns: 6
                type: grid
                cards:
                  - type: custom:button-card
                    entity: script.aspi_r2d2_chambre_tom
                    name: Tom
                    template:
                      - carte_ronde_no_label
                    tap_action:
                      action: toggle
                  - type: custom:button-card
                    entity: script.aspi_r2d2_chambre_manon_leane
                    name: Manon
                    template:
                      - carte_ronde_no_label
                    tap_action:
                      action: toggle
                  - type: custom:button-card
                    entity: script.aspi_r2d2_chambre_nina
                    name: Nina
                    template:
                      - carte_ronde_no_label
                    tap_action:
                      action: toggle
                  - type: custom:button-card
                    entity: script.aspi_r2d2_salle_de_bain
                    name: SdB
                    template:
                      - carte_ronde_no_label
                    tap_action:
                      action: toggle
                  - type: custom:button-card
                    entity: script.aspi_r2d2_palier
                    name: Palier
                    template:
                      - carte_ronde_no_label
                    tap_action:
                      action: toggle
              - type: custom:xiaomi-vacuum-map-card
                entity: vacuum.r2d2
                map_source:
                  camera: camera.roborock_s50
                calibration_source:
                  camera: true
                language: fr
                debug: false
                map_modes:
                  - template: vacuum_clean_zone
                  - template: vacuum_goto
                  - template: vacuum_clean_zone_predefined
                    predefined_selections:
                      - zones:
                          - - 27589
                            - 24459
                            - 30627
                            - 27454
                      - zones:
                          - - 22780
                            - 21316
                            - 26598
                            - 24332
                      - zones:
                          - - 27589
                            - 21505
                            - 31217
                            - 24374
                      - zones:
                          - - 22864
                            - 17730
                            - 31112
                            - 21231
                      - zones:
                          - - 25227
                            - 24501
                            - 27526
                            - 25809
                      - zones:
                          - - 26661
                            - 21442
                            - 27547
                            - 24501
                map_locked: true
                two_finger_pan: false
              - square: false
                columns: 4
                type: grid
                cards:
                  - type: custom:button-card
                    entity: script.aspi_r2d2_reset_brosse_principale
                    name: Brosse principale
                    icon: mdi:robot-vacuum-variant
                    template:
                      - base_verticale_centree
                    confirmation:
                      text: '[[[ return `R2D2 Reset de la brosse principale ?` ]]]'
                    tap_action:
                      action: call-service
                      service: script.turn_on
                      service_data:
                        entity_id: script.aspi_r2d2_reset_brosse_principale
                  - type: custom:button-card
                    entity: script.aspi_r2d2_reset_brosse_laterale
                    name: Brosse latérale
                    icon: mdi:broom
                    template:
                      - base_verticale_centree
                    confirmation:
                      text: '[[[ return `R2D2 Reset de la brosse latérale ?` ]]]'
                    tap_action:
                      action: call-service
                      service: script.turn_on
                      service_data:
                        entity_id: script.aspi_r2d2_reset_brosse_laterale
                  - type: custom:button-card
                    entity: script.aspi_r2d2_reset_capteurs
                    icon: mdi:state-machine
                    name: Capteurs
                    template:
                      - base_verticale_centree
                    confirmation:
                      text: '[[[ return `R2D2 Reset des capteurs ?` ]]]'
                    tap_action:
                      action: call-service
                      service: script.turn_on
                      service_data:
                        entity_id: script.aspi_r2d2_reset_capteurs
                  - type: custom:button-card
                    entity: script.aspi_r2d2_reset_filtre
                    name: Filtre
                    icon: mdi:air-filter
                    template:
                      - base_verticale_centree
                    confirmation:
                      text: '[[[ return `R2D2 Reset du filtre ?` ]]]'
                    tap_action:
                      action: call-service
                      service: script.turn_on
                      service_data:
                        entity_id: script.aspi_r2d2_reset_filtre
  - title: Lumières
    path: light
    icon: mdi:lightbulb-group
    visible:
      - user: d8316597eafd4333b737464a5b4c62d0
      - user: 76afcf1927a948b19530bcbf1074ac59
      - user: 2f0040afe95a4514ade3c049a0b5d479
    type: custom:horizontal-layout
    layout:
      width: 350
      max_cols: 4
    badges:
      - entity: sensor.plante_lum_dracaena
        name: Dracaena
        style: |
          :host {
            --label-badge-red: 
              {% if states('sensor.plante_lum_dracaena') | float < 90 %}
                rgba(0,191,205,0.5)
              {% else %} 
                rgba(240,52,52,0.5)
              {% endif %}      
      - entity: sensor.plante_lum_pied_elephant
        name: Pied d'Elephant
        style: |
          :host {
            --label-badge-red: 
              {% if states('sensor.plante_lum_pied_elephant') | float < 90 %}
                rgba(0,191,205,0.5)
              {% else %} 
                rgba(240,52,52,0.5)
              {% endif %}    
      - entity: sensor.salle_a_manger_luminosite
        name: SaM
        style: |
          :host {
            --label-badge-red: 
              {% if states('sensor.salle_a_manger_luminosite') | float < 90 %}
                rgba(0,191,205,0.5)
              {% else %} 
                rgba(240,52,52,0.5)
              {% endif %}         
      - entity: sensor.mouv_tom_luminosite
        name: Tom
        style: |
          :host {
            --label-badge-red: 
              {% if states('sensor.mouv_tom_luminosite') | float < 50 %}
                rgba(0,191,205,0.5)
              {% else %} 
                rgba(240,52,52,0.5)
              {% endif %} 
      - entity: sensor.mouv_manon_luminosite
        name: Manon
        style: |
          :host {
            --label-badge-red: 
              {% if states('sensor.mouv_nina_luminosite') | float < 50 %}
                rgba(0,191,205,0.5)
              {% else %} 
                rgba(240,52,52,0.5)
              {% endif %}   
      - entity: sensor.mouv_leane_luminosite
        name: Léane
        style: |
          :host {
            --label-badge-red: 
              {% if states('sensor.mouv_nina_luminosite') | float < 50 %}
                rgba(0,191,205,0.5)
              {% else %} 
                rgba(240,52,52,0.5)
              {% endif %}               
      - entity: sensor.mouv_nina_luminosite
        name: Nina
        style: |
          :host {
            --label-badge-red: 
              {% if states('sensor.mouv_nina_luminosite') | float < 50 %}
                rgba(0,191,205,0.5)
              {% else %} 
                rgba(240,52,52,0.5)
              {% endif %} 
      - entity: sensor.mouv_palier_lum
        name: Palier
        style: |
          :host {
            --label-badge-red: 
              {% if states('sensor.mouv_palier_lum') | float < 50 %}
                rgba(0,191,205,0.5)
              {% else %} 
                rgba(240,52,52,0.5)
              {% endif %} 
    cards:
      - type: custom:layout-card
        layout_type: masonry
        layout:
          width: 280
        cards:
          - type: vertical-stack
            cards:
              - cards:
                  - type: custom:button-card
                    template:
                      - bouton_titre_piece
                    style:
                      .: |
                        ha-card {
                            --ha-card-background: none !important;
                            box-shadow: none !important;
                            font-family: Avenir
                    entity: light.sejour2
                    name: |
                      [[[ return "Séjour" ]]]
                    label: |
                      [[[
                        if (states['sensor.compteur_sejour2'].state < 2)
                          return (states['sensor.compteur_sejour2'].state ) + " lumière" ;
                        return (states['sensor.compteur_sejour2'].state ) + " lumières";
                      ]]]
                  - square: false
                    columns: 2
                    type: grid
                    cards:
                      - type: custom:button-card
                        entity: light.lampe_de_bureau
                        name: Bureau
                        template:
                          - base
                          - bouton_lumiere
                          - state_lumiere
                          - state_unavailable
                        custom_fields:
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.lampe_de_bureau
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.lampe_de_bureau
                                radius: 3px
                                height: 15px
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                thumbWidth: 2px
                                minSet: 1
                      - type: custom:button-card
                        entity: light.lampe_tele_salon
                        name: Lampe TV
                        show_label: false
                        template:
                          - base
                          - bouton_lumiere
                          - state_lumiere
                          - state_unavailable
                      - type: custom:button-card
                        entity: light.bandeau_led
                        name: Bandeau TV
                        template:
                          - base
                          - bouton_lumiere
                          - state_lumiere
                          - state_unavailable
                        custom_fields:
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.bandeau_led
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.bandeau_led
                                radius: 3px
                                height: 15px
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                thumbWidth: 2px
                                minSet: 1
                      - type: custom:button-card
                        entity: light.trilampe
                        name: Trilampes
                        template:
                          - base
                          - bouton_lumiere
                          - state_lumiere
                          - state_unavailable
                        custom_fields:
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.trilampe
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.trilampe
                                radius: 3px
                                height: 15px
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                thumbWidth: 2px
                                minSet: 1
                      - type: custom:button-card
                        entity: light.lustre_salon
                        name: Lustre salon
                        template:
                          - base
                          - bouton_lumiere
                          - state_lumiere
                          - state_unavailable
                        custom_fields:
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.lustre_salon
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.lustre_salon
                                radius: 3px
                                height: 15px
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                thumbWidth: 2px
                                minSet: 1
                      - type: custom:button-card
                        entity: light.lustre_salle_a_manger
                        name: Lustre SaM
                        template:
                          - base
                          - bouton_lumiere
                          - state_lumiere
                          - state_unavailable
                        custom_fields:
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.lustre_salle_a_manger
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.lustre_salle_a_manger
                                radius: 3px
                                height: 15px
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                thumbWidth: 2px
                                minSet: 1
                      - type: custom:button-card
                        entity: light.buffet
                        name: Buffet
                        template:
                          - base
                          - bouton_lumiere
                          - state_lumiere
                          - state_unavailable
                        custom_fields:
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.buffet
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.buffet
                                radius: 3px
                                height: 15px
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                thumbWidth: 2px
                                minSet: 1
                      - type: custom:button-card
                        entity: light.lampadaire
                        name: Lampadaire
                        template:
                          - base
                          - bouton_lumiere
                          - state_lumiere
                          - state_unavailable
                        custom_fields:
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.lampadaire
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.lampadaire
                                radius: 3px
                                height: 15px
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                thumbWidth: 2px
                                minSet: 1
                  - type: custom:button-card
                    template:
                      - bouton_titre_piece
                    style:
                      .: |
                        ha-card {
                            --ha-card-background: none !important;
                            box-shadow: none !important;
                            font-family: Avenir
                    entity: light.entree_2
                    name: |
                      [[[ return "Entrée" ]]]
                    label: |
                      [[[
                        if (states['sensor.compteur_entree2'].state < 2)
                          return (states['sensor.compteur_entree2'].state ) + " lumière" ;
                        return (states['sensor.compteur_entree2'].state ) + " lumières";
                      ]]]
                  - type: grid
                    cards:
                      - type: custom:button-card
                        entity: light.couloir
                        template:
                          - base
                          - bouton_lumiere
                          - state_lumiere
                          - state_unavailable
                        custom_fields:
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.couloir
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.couloir
                                radius: 3px
                                height: 15px
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                thumbWidth: 2px
                                minSet: 1
                      - type: custom:button-card
                        entity: light.entree
                        template:
                          - base
                          - bouton_lumiere
                          - state_lumiere
                          - state_unavailable
                        custom_fields:
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.entree
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.entree
                                radius: 3px
                                height: 15px
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                thumbWidth: 2px
                                minSet: 1
                      - type: custom:button-card
                        entity: light.aqara_hub_54e1
                        template:
                          - base
                          - bouton_lumiere
                          - state_lumiere
                          - state_unavailable
                        custom_fields:
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.aqara_hub_54e1
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.aqara_hub_54e1
                                radius: 3px
                                height: 15px
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                thumbWidth: 2px
                                minSet: 1
                    square: false
                    columns: 2
                  - type: custom:button-card
                    template:
                      - bouton_titre_piece
                    style:
                      .: |
                        ha-card {
                            --ha-card-background: none !important;
                            box-shadow: none !important;
                            font-family: Avenir
                    name: |
                      [[[ return "Garage" ]]]
                    label: |
                      [[[
                        if (states['light.cagibi'].state == "on")
                          return " 1 lumière" ;
                        return "0 lumière";
                      ]]]
                  - type: grid
                    cards:
                      - type: custom:button-card
                        entity: light.cagibi
                        template:
                          - base
                          - bouton_lumiere
                          - state_lumiere
                          - state_unavailable
                        custom_fields:
                          lum:
                            card:
                              type: conditional
                              conditions:
                                - entity: light.cagibi
                                  state: 'on'
                              card:
                                type: custom:my-slider
                                entity: light.cagibi
                                radius: 3px
                                height: 15px
                                mainSliderColor: var(--button-card-light-color-no-temperature)
                                thumbHorizontalPadding: 0px
                                thumbVerticalPadding: 0px
                                thumbWidth: 2px
                                minSet: 1
                    square: false
                    columns: 2
                type: vertical-stack
      - type: custom:layout-card
        layout_type: masonry
        layout:
          width: 280
        cards:
          - cards:
              - type: custom:button-card
                template:
                  - bouton_titre_piece
                style:
                  .: |
                    ha-card {
                        --ha-card-background: none !important;
                        box-shadow: none !important;
                        font-family: Avenir
                entity: light.parents
                name: |
                  [[[ return "Chambre parents" ]]]
                label: |
                  [[[
                    if (states['sensor.compteur_parents'].state < 2)
                      return (states['sensor.compteur_parents'].state ) + " lumière" ;
                    return (states['sensor.compteur_parents'].state ) + " lumières";
                  ]]]
              - type: grid
                cards:
                  - type: custom:button-card
                    entity: switch.tele_des_parents
                    icon: mdi:youtube-tv
                    name: Prise TV
                    template:
                      - base
                      - bouton_lumiere
                      - state_tv
                      - state_unavailable
                    show_label: false
                  - type: custom:button-card
                    entity: light.lustre_parents
                    name: Lustre
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.lustre_parents
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.lustre_parents
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                  - type: custom:button-card
                    entity: light.chevet
                    name: Chevet
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.chevet
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.chevet
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                square: false
                columns: 2
              - type: custom:button-card
                template:
                  - bouton_titre_piece
                style:
                  .: |
                    ha-card {
                        --ha-card-background: none !important;
                        box-shadow: none !important;
                        font-family: Avenir
                entity: light.tom
                name: |
                  [[[ return "Chambre Tom" ]]]
                label: |
                  [[[
                    if (states['sensor.compteur_tom'].state < 2)
                      return (states['sensor.compteur_tom'].state ) + " lumière" ;
                    return (states['sensor.compteur_tom'].state ) + " lumières";
                  ]]]
              - type: grid
                cards:
                  - type: custom:button-card
                    entity: light.lustre_tom
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.lustre_tom
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.lustre_tom
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                  - type: custom:button-card
                    entity: light.chevet_tom
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.chevet_tom
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.chevet_tom
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                  - type: custom:button-card
                    entity: light.lampe_de_bureau_tom
                    name: Bureau
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.lampe_de_bureau_tom
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.lampe_de_bureau_tom
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                  - type: custom:button-card
                    entity: switch.moustique_tom
                    name: Prise moustique
                    template:
                      - base
                      - bouton_lumiere
                      - state_appareil
                      - state_unavailable
                    show_label: false
                square: false
                columns: 2
            type: vertical-stack
      - type: custom:layout-card
        layout_type: masonry
        layout:
          width: 280
        cards:
          - cards:
              - type: custom:button-card
                template:
                  - bouton_titre_piece
                style:
                  .: |
                    ha-card {
                        --ha-card-background: none !important;
                        box-shadow: none !important;
                        font-family: Avenir
                entity: light.manon_et_leane
                name: |
                  [[[ return "Chambre Manon et Léane" ]]]
                label: |
                  [[[
                    if (states['sensor.compteur_manon'].state < 2)
                      return (states['sensor.compteur_manon'].state ) + " lumière" ;
                    return (states['sensor.compteur_manon'].state ) + " lumières";
                  ]]]
              - type: grid
                cards:
                  - type: custom:button-card
                    entity: light.lustre_manon_et_leane
                    name: Lustre
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.lustre_manon_et_leane
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.lustre_manon_et_leane
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                  - type: custom:button-card
                    entity: light.chevet_manon
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.chevet_manon
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.chevet_manon
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                  - type: custom:button-card
                    entity: switch.arbre_lumineux
                    name: Arbre
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    show_label: false
                  - type: custom:button-card
                    entity: light.lampe_manon_et_leane
                    name: Lampadaire
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.lampe_manon_et_leane
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.lampe_manon_et_leane
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                  - type: custom:button-card
                    entity: light.chevet_leane
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.chevet_leane
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.chevet_leane
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                  - type: custom:button-card
                    entity: switch.moustique_manon
                    name: Prise moustique
                    template:
                      - base
                      - bouton_lumiere
                      - state_appareil
                      - state_unavailable
                    show_label: false
                square: false
                columns: 2
              - type: custom:button-card
                template:
                  - bouton_titre_piece
                style:
                  .: |
                    ha-card {
                        --ha-card-background: none !important;
                        box-shadow: none !important;
                        font-family: Avenir
                entity: light.nina
                name: |
                  [[[ return "Chambre Nina" ]]]
                label: |
                  [[[
                    if (states['sensor.compteur_nina'].state < 2)
                      return (states['sensor.compteur_nina'].state ) + " lumière" ;
                    return (states['sensor.compteur_nina'].state ) + " lumières";
                  ]]]
              - type: grid
                cards:
                  - type: custom:button-card
                    entity: light.lampe_de_bureau_nina
                    name: Bureau
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.lampe_de_bureau_nina
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.lampe_de_bureau_nina
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                  - type: custom:button-card
                    entity: light.lustre_nina
                    name: Lustre
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.lustre_nina
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.lustre_nina
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                  - type: custom:button-card
                    entity: light.chevet_nina
                    name: Chevet
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.chevet_nina
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.chevet_nina
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                  - type: custom:button-card
                    entity: switch.guirlande_nina
                    name: Guirlande
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    show_label: false
                  - type: custom:button-card
                    entity: light.lampadaire_nina
                    name: Lampadaire
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.lampadaire_nina
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.lampadaire_nina
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                  - type: custom:button-card
                    entity: switch.moustique_nina
                    name: Prise moustique
                    template:
                      - base
                      - bouton_lumiere
                      - state_appareil
                      - state_unavailable
                    show_label: false
                square: false
                columns: 2
            type: vertical-stack
      - type: custom:layout-card
        layout_type: masonry
        layout:
          width: 280
        cards:
          - cards:
              - type: custom:button-card
                template:
                  - bouton_titre_piece
                style:
                  .: |
                    ha-card {
                        --ha-card-background: none !important;
                        box-shadow: none !important;
                        font-family: Avenir
                entity: light.escaliers
                name: |
                  [[[ return "Escalier et palier" ]]]
                label: |
                  [[[
                    if (states['sensor.compteur_escaliers'].state < 2)
                      return (states['sensor.compteur_escaliers'].state ) + " lumière" ;
                    return (states['sensor.compteur_escaliers'].state ) + " lumières";
                  ]]]
              - type: grid
                cards:
                  - type: custom:button-card
                    entity: light.escalier
                    icon: mdi:stairs
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.escalier
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.escalier
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                  - type: custom:button-card
                    entity: light.palier
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.palier
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.palier
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                square: false
                columns: 2
              - type: custom:button-card
                template:
                  - bouton_titre_piece
                style:
                  .: |
                    ha-card {
                        --ha-card-background: none !important;
                        box-shadow: none !important;
                        font-family: Avenir
                entity: light.wc
                name: |
                  [[[ return "Lavabo WC" ]]]
                label: |
                  [[[
                    if (states['sensor.compteur_wc'].state < 2)
                      return (states['sensor.compteur_wc'].state ) + " lumière" ;
                    return (states['sensor.compteur_wc'].state ) + " lumières";
                  ]]]
              - type: grid
                cards:
                  - type: custom:button-card
                    entity: light.wc_gauche
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.wc_gauche
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.wc_gauche
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                  - type: custom:button-card
                    entity: light.wc_droit
                    template:
                      - base
                      - bouton_lumiere
                      - state_lumiere
                      - state_unavailable
                    custom_fields:
                      lum:
                        card:
                          type: conditional
                          conditions:
                            - entity: light.wc_droit
                              state: 'on'
                          card:
                            type: custom:my-slider
                            entity: light.wc_droit
                            radius: 3px
                            height: 15px
                            mainSliderColor: var(--button-card-light-color-no-temperature)
                            thumbHorizontalPadding: 0px
                            thumbVerticalPadding: 0px
                            thumbWidth: 2px
                            minSet: 1
                square: false
                columns: 2
              - type: custom:button-card
                template:
                  - bouton_titre_piece
                style:
                  .: |
                    ha-card {
                        --ha-card-background: none !important;
                        box-shadow: none !important;
                        font-family: Avenir
                entity: switch.radiateur
                name: |
                  [[[ return "Chauffage SDB" ]]]
                label: |
                  [[[
                    return (states['sensor.temp_salle_de_bain'].state ) + "°" ;
                  ]]]
              - type: grid
                cards:
                  - type: custom:button-card
                    entity: switch.radiateur
                    template:
                      - base
                      - bouton_lumiere
                      - state_appareil
                      - state_unavailable
                    show_label: false
                square: false
                columns: 2
              - type: custom:button-card
                template:
                  - bouton_titre_piece
                style:
                  .: |
                    ha-card {
                        --ha-card-background: none !important;
                        box-shadow: none !important;
                        font-family: Avenir
                entity: group.noel
                name: |
                  [[[ return "Lumières de Noël " ]]]
                label: |
                  [[[
                    if (states['sensor.compteur_noel'].state < 2)
                      return (states['sensor.compteur_noel'].state ) + " lumière" ;
                    return (states['sensor.compteur_noel'].state ) + " lumières";
                  ]]]
              - type: grid
                cards:
                  - type: custom:button-card
                    entity: switch.sapin
                    template:
                      - base
                      - bouton_lumiere
                      - state_appareil
                      - state_unavailable
                    show_label: false
                  - type: custom:button-card
                    entity: switch.guirlande_etoiles
                    template:
                      - base
                      - bouton_lumiere
                      - state_appareil
                      - state_unavailable
                    show_label: false
                square: false
                columns: 2
            type: vertical-stack







       
